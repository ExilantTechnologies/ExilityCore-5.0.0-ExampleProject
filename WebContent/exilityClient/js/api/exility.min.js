var getExilityVersion=function(){return"3.3.0 19-Apr-2014"},BackgroundJobs=function(){debug("BackgroundJobs Object Created...");this.allBackgroundJobs=[];this.setAllBackgroundJobStatuses=function(b){var c=b.dc;if(null!==c&&typeof c!==ClientConstants.TYPE_IS_UNDEFINED)if(b.serviceId==ClientConstants.BACKGROUND_JOB_STATUS_SERVICE_ID&&c.hasValue(ClientConstants.BACKGROUND_JOB_STATUS_FIELD))b=c.getValue(ClientConstants.BACKGROUND_JOB_ID_FIELD),b=this.addJob(b,c.getValue(ClientConstants.BACKGROUND_JOB_STATUS_FIELD)),
c.getValue(ClientConstants.BACKGROUND_JOB_STATUS_FIELD)==ClientConstants.BACKGROUND_JOB_IS_DONE&&(this.allBackgroundJobs[b].dc=c);else if(c.hasValue(ClientConstants.BACKGROUND_JOBS_FIELD))for(c=c.getValue(ClientConstants.BACKGROUND_JOBS_FIELD).split(ClientConstants.KEY_VALUE_LIST_SEPARATOR),b=0;b<c.length;b++){var d=c[b].split(ClientConstants.KEY_VALUE_SEPARATOR);this.addJob(d[0],d[1])}};this.removeJob=function(b){for(var c=-1,d=0;d<this.allBackgroundJobs.length;d++)if(this.allBackgroundJobs[d].jobId==
b){c=d;break}0<=c&&this.allBackgroundJobs.splice(c,1)};this.addJob=function(b,c){this.hasJob(b)&&this.removeJob(b);this.allBackgroundJobs[this.allBackgroundJobs.length]=new BackgroundJob(b,c);return this.allBackgroundJobs.length-1};this.getCountOfBackgroundJobs=function(){return this.allBackgroundJobs.length};this.hasJob=function(b){for(var c=0;c<this.allBackgroundJobs.length;c++)if(this.allBackgroundJobs[c].jobId==b)return!0;return!1};this.getBackgroundJobStatus=function(b){for(var c=null,d=0;d<
this.allBackgroundJobs.length;d++)if(c=this.allBackgroundJobs[d],c.jobId==b)return c.status;return null};this.isJobRunning=function(b){for(var c=0;c<this.allBackgroundJobs.length;c++)if(bgJob=this.allBackgroundJobs[c],bgJob.jobId==b)return bgJob.status===ClientConstants.BACKGROUND_JOB_IS_RUNNING;return ClientConstants.BACKGROUND_JOB_IS_DONE};this.hasPendingJobs=function(){return 0<this.getCountOfPendingJobs()};this.getCountOfPendingJobs=function(){for(var b=0,c=0;c<this.allBackgroundJobs.length;c++)bgJob=
this.allBackgroundJobs[c],bgJob.status===ClientConstants.BACKGROUND_JOB_IS_RUNNING&&b++;return b};this.getNextPendingJobId=function(){for(var b=0;b<this.allBackgroundJobs.length;b++)if(bgJob=this.allBackgroundJobs[b],bgJob.status===ClientConstants.BACKGROUND_JOB_IS_RUNNING)return bgJob.jobId;return null};this.clear=function(){this.allBackgroundJobs=[]}},BackgroundJob=function(b,c){this.jobId=b;this.status=c;this.dc=null},exilParms={loginPage:"htm/common/login.htm",baseIMGFolderName:"../../images/",
baseHTMLFolderName:"htm/",htmlToImageFolder:"../../images",fileToHtmlBase:"../../",calendarImageSrc:"../../images/calendar.gif",codePickerImageSrc:"../../images/codePicker.gif",calendarHtmlSrc:"../../htm/common/calendar.htm",codePickerHtmlSrc:"../../htm/codePicker.htm",errorMessageHtmlSrc:"../../htm/errorMessage.htm",commonServiceName:"Serve",serviceName:"Serve",minDate:new Date("January 01, 2003"),maxDate:new Date("January 01, 2023"),validateDatesForBetween:!0,comboMaxRows:20,validateQueryFields:!0,
checkedValue:"1",uncheckedValue:"0",searchResultTableName:"searchResult",doNotAddRowsOnTabOut:!0,displayInitialRows:!0,immediateValidation:!0,stopAtFirstError:!0,invalidBackgroundColor:"lightgrey",listHoverColor:"lightgrey",listSelectedColor:"B4D4FE",gridDeletedColor:"DarkSalmon",originalFieldColor:"white",blockCodePicker:!1,homePage:"ide/home.htm",forbiddenChars:/[\^\\~]/,lowercasevariables:!1,inDebugMode:!0,dateSeparator:"-",dateAt:0,monthAt:1,yearAt:2,useMonthName:!0,useShortYear:!0,cutOffForShortYear:45,
trackFieldChanges:!1,diffToFrom:!0,alignCalendar:!1,appHotKeyFunctionName:"appHotKeyFunc",donotSetFirstDescValue:!0,serverActivityCallBackFunctionName:"resetInactiveTimer",animateHideAndShow:!1,fieldErrorCss:"inerror",decimalChar:".",monthNames:"jan feb mar apr may jun jul aug sep oct nov dec".split(" "),monthIndex:{jan:0,feb:1,mar:2,apr:3,may:4,jun:5,jul:6,aug:7,sep:8,oct:9,nov:10,dec:11},positionCalWithinPage:!0,calWidth:195,calCorrection:50,donotAddColonToErrorMessage:!0,showSeparateErrorIfRegexFails:!0,
errorDisplayedLocally:!0,popupCoverColor:"#999999",popupCoverOpacity:0.5,scrollBarWidth:-1<navigator.userAgent.toUpperCase().indexOf("MAC OS")?15:17,datePlaceHolder:null,chartPanelOptions:{colors:"#0000ff #00ff00 #ff0000 #9999ff #993366 #ffffcc #ccffff #660066 #ff8080".split(" "),childColors:"#334455 #551122 #ff2266 #9900ff #0099ff #ff00cc #cc00ff #66ff66 #008080".split(" "),shadowSize:4,rawDataDisplay:"value",labelColor:"white",hideLegend:!1,legendNbrColumns:1,legendLabelFormatter:null,legendLabelBoxBorderColor:"#ccc",
legendPosition:"ne",legendMargin:5,legendBackgroundColor:"gray",legendBackgroundOpacity:0.85,marginLeft:35,marginBottom:35,barLabelLeftMargin:3,barLabelBottomMargin:3,yLabelMaxWidth:35,lineWidth:2,barWidth:0.7,gridColor:"#545454",tickColor:"#dddddd",showFilledPoints:!1,pointsRadius:3,pointsFillColor:"#ffffff",labelLeftMargin:5,labelBottomMargin:5}},resetInactiveTimer=function(){},setLocalDateFormat=function(b,c){c=b.substr(0,1);b=b.substr(1,b.length-1);debug("Local date format will be set to "+b+
" with "+c+" as the separator");if("ddmmyy"==b)exilParms.dateAt=0,exilParms.monthAt=1,exilParms.yearAt=2,exilParms.useMonthName=!1,exilParms.useShortYear=!0,exilParms.cutOffForShortYear=15;else if("ddmmmyy"==b)exilParms.dateAt=0,exilParms.monthAt=1,exilParms.yearAt=2,exilParms.useMonthName=!0,exilParms.useShortYear=!0,exilParms.cutOffForShortYear=15;else if("ddmmyyyy"==b)exilParms.dateAt=0,exilParms.monthAt=1,exilParms.yearAt=2,exilParms.useMonthName=!1,exilParms.useShortYear=!1;else if("mmddyy"==
b)exilParms.dateAt=1,exilParms.monthAt=0,exilParms.yearAt=2,exilParms.useMonthName=!1,exilParms.useShortYear=!0;else return!1;exilParms.dateSeparator=c;return!0},ClientConstants={TYPE_IS_UNDEFINED:"undefined",KEY_VALUE_SEPARATOR:"\x3d",KEY_VALUE_LIST_SEPARATOR:";",BACKGROUND_JOB_IS_DONE:"done",BACKGROUND_JOB_IS_RUNNING:"running",BACKGROUND_JOB_STATUS_SERVICE_ID:"getBackgroundJobResult",BACKGROUND_JOB_STATUS_FIELD:"_backgroundJobStatus",BACKGROUND_JOBS_FIELD:"_backgroundJobs",BACKGROUND_JOB_ID_FIELD:"_backgroundJobId",
MESSAGE_TYPE_ERROR:"error",MESSAGE_TYPE_WARN:"warning",MESSAGE_TYPE_INFO:"info",TEST_CASE_CAPTURE:"_testCaseToBeCaptured",AUTH_STATUS:"authenticationStatus",TRACE_NAME:"exilityServerTraceText",PERF_TRACE_NAME:"exilityServerPerformanceText",GLOBAL_FIELDS:"globalFields",CSRF_HEADER:"X-CSRF-Token",REMOVE_CSRF:"remove",NUMBER_OF_EXISTING_LOGINS:"_nbr_existing_logins"},PM=window;window.name="exilWin";
var StackEntry=function(b,c,d,f){this.win=b;this.url=c;this.toReset=d;this.isPopup=f;c=window.document.body;f=d=0;c.scrollTop?(d=c.scrollTop,f=c.scrollLeft):b.pageYOffset?(d=b.pageYOffset,f=b.pageXOffset):c.parentElement&&c.parentElement.scrollTop&&(d=c.parentElement.scrollTop,f=c.parentElement.scrollLeft);this.scrollTop=d;this.scrollLeft=f},ExilityPageStack=function(b){this.stack=[];this.activeWindows={}};ExilityPageStack.prototype.push=function(b){this.stack.push(b)};
ExilityPageStack.prototype.pop=function(){return this.stack.pop()};ExilityPageStack.prototype.top=function(){var b=this.stack.length;return 0<b?this.stack[b-1]:null};ExilityPageStack.prototype.getEntry=function(b){var c=this.stack.length;return 0<c&&c>b?this.stack[b]:null};
ExilityPageStack.prototype.goBack=function(b,c){b||(b=currentActiveWindow);var d=this.pop();if(!d){if(!exilParms.homePage){b.location.replace("about:blank");return}b.location.replace(htmlRootPath+exilParms.homePage);window.scrollTo(0,0);return b}currentActiveWindow=d.win;debug("currentActiveWindow set to "+currentActiveWindow.location.href);if(d.url)c||(window.scrollTo(0,0),b.location.replace(d.url));else{window.scrollTo(0,0);closeWindow(b);if(d.isPopup){if(uncoverPage(coverMainStyle),!c)if(d.se)d.win.serverAgent.callService(se);
else{var f=d.win.P2;f&&f.reloadActionName&&f.actions[f.reloadActionName].act()}}else showWindow(d.win),d.win.P2&&!c&&d.win.P2.reload(d.scrollLeft,d.scrollTop);d.win.P2&&d.win.P2.setPageTitle()}return d.win};
ExilityPageStack.prototype.goTo=function(b,c,d,f,g){b||(b=currentActiveWindow);if(!b)return alert("Oooops where do you want me to go? There is NO window to go !!!"),null;currentActiveWindow=b;d=htmlRootPath+d;c==NavigationAction.REPLACE?(g&&(this.activeWindows[g]=b),b.location.replace(d)):c==NavigationAction.POPUP?(c=new StackEntry(b,null,!1,!0),this.push(c),f&&(c.se=f),uncoverPage(coverPickerStyle),coverPage(coverMainStyle,imgMainStyle),currentActiveWindow=createWindow(d,!0),debug("currentActiveWindow set to "+
currentActiveWindow.location.href),g&&(this.activeWindows[g]=currentActiveWindow)):c==NavigationAction.RETAIN_STATE?(this.push(new StackEntry(b,null,!1)),hideWindow(b),currentActiveWindow=createWindow(d,!1),debug("currentActiveWindow set to "+currentActiveWindow.location.href),g&&(this.activeWindows[g]=currentActiveWindow),uncoverPage(coverMainStyle)):c==NavigationAction.RESET?(this.push(new StackEntry(b,b.location.href,!0)),g&&(this.activeWindows[g]=b),b.location.replace(d)):c==NavigationAction.MENU_RESET?
(0==this.stack.length&&this.push(new StackEntry(b,b.location.href,!0)),g&&(this.activeWindows[g]=b),b.location.replace(d)):message("Design Error :Invallid window displosal mode recd by navigator : "+c,"Error","Ok",null,null,null);return b};
ExilityPageStack.prototype.resetStack=function(b){if(b&&(b=currentActiveWindow&&currentActiveWindow.P2)&&b.lastModifiedNode&&b.trackFieldChanges&&!window.confirm("You have modified some information on this page. Click OK to abandon editing, or CANCEL to go back")){try{b.lastModifiedNode.focus(),b.makePanelVisible(b.lastModifiedNode)}catch(c){}return!1}for(;0<this.stack.length;)b=this.stack.pop(),b.url||(closeWindow(currentActiveWindow),b.isPopup||showWindow(b.win),currentActiveWindow=b.win);return!0};
ExilityPageStack.prototype.showStack=function(){var b="Page History";if(this.stack&&0!=this.stack.length)for(var c=this.stack,d=0;d<c.length;d++)b+="\n"+(d+1)+". "+c[d];else b+=" is empty ";message(b,"","Ok",null,null,null)};
var getMessageText=function(b){return b.getMessageText()},confirmReset=function(){message("server reset","","Ok",null,null,null)},HeaderMenu=function(){this.options="directories\x3dno, location\x3dno, resizable\x3dyes, menubar\x3dno, status\x3dno, titlebar\x3dno, scrollbars\x3dyes, toolbar\x3dno";this.showVersion=function(){message("Version 1.21 released on date 20-Jan-09","","Ok",null,null,null)};this.resetServer=function(){var b=new ServiceEntry("internal.resetProject",new DataCollection,!0,confirmReset,
null,null,!1,!0);exilityMainWindow.serverStub.callService(b)};this.startTrace=function(){if(!window.exilityTraceWindow||window.exilityTraceWindow.closed)window.exilityTraceWindow=window.open(exilParms.baseHTMLFolderName+"common/trace.htm","trace",this.options+", left\x3d0, top\x3d0, height\x3d500, width\x3d600",!0);window.exilityTraceWindow?window.exilityTraceWindow.focus():alert("Unable to open trace window because of pop-up blocker. You will not see trace information.")};this.traceClosed=function(){exilityTraceWindow=
null};this.startDataTrace=function(){exilityDataTraceWindow||(exilityDataTraceWindow=window.open(exilParms.baseHTMLFolderName+"common/datatrace.htm","datatrace",this.options+", left\x3d0, top\x3d0, height\x3d500, width\x3d600",!0));exilityDataTraceWindow.focus()};this.datatraceClosed=function(){exilityDataTraceWindow=null};this.startTestHarness=function(){window.testCaseToBeCaptured=!0};this.endTestHarness=function(){window.testCaseToBeCaptured=!1};this.showHtml=function(){var b=window.open("","_blank").document;
b.write(currentActiveWindow.document.body.innerHTML);b.close()};this.showData=function(){if(window.dataStore){var b=window.open("","_blank"),c=b.document;c.write(dataStore.toHtml());c.close();b.focus()}else{var d=currentActiveWindow.P2;if(d){b=window.open("","_blank");c=b.document;c.write('\x3ch2\x3evalues\x3c/h2\x3e\x3ctable cellpadding\x3d"3" cellspacing\x3d"1" style\x3d"background-color:blue;"\x3e\x3ctr style\x3d"background-color:gray"\x3e\x3cth\x3eName\x3c/th\x3e\x3cth\x3eValue\x3c/th\x3e\x3c/tr\x3e');
for(var f in d.fields){var g=d.fields[f];g&&!g.table&&((g=g.value)||(g="\x26nbsp;"),c.write('\x3ctr style\x3d"background-color:silver"\x3e\x3ctd\x3e'+f+"\x3c/td\x3e\x3ctd\x3e"+g+"\x3c/td\x3e\x3c/tr\x3e"))}c.write("\x3c/table\x3e");for(var h in d.tables){c.write("\x3cbr /\x3e\x3ch2\x3e"+h+'\x3c/h2\x3e\x3ctable cellpadding\x3d"3" cellspacing\x3d"1" style\x3d"background-color:blue;"\x3e\x3ctr style\x3d"background-color:gray"\x3e');f=d.tables[h];for(var g=f.columnNames,k=g.length,l=0;l<k;l++)c.write("\x3cth\x3e"+
g[l]+"\x3c/th\x3e");c.write("\x3c/tr\x3e");for(var m=f.grid.length,l=1;l<m;l++){var n=f.grid[l];if(n&&!n.isDeleted){c.write('\x3ctr style\x3d"background-color:silver"\x3e');for(var r=0;r<k;r++)(g=n[r])||(g="\x26nbsp;"),c.write("\x3ctd\x3e"+g+"\x3c/td\x3e");c.write("\x3c/tr\x3e")}}c.write("\x3c/table\x3e")}c.close();b.focus()}else message("Sorry, the current window is not an Exility window. Data can not be dumped","","Ok",null,null,null)}};this.navigate=function(b){exilityMainWindow.location.replace(exilParms.baseHTMLFolderName+
urltext)};this.showTester=function(){exilityPageStack.goTo(null,"retainState","common/tester.htm",null,null)};this.startCrossWire=function(){if(!this.crossWired){if(!this.crossWireEle){var b=document.createElement("div");b.style.position="fixed";b.style.top="1px";b.style.left="1px";b.style.zIndex=10;b.style.cursor="resize";b.addEventListener?b.addEventListener("mousemove",showCoordinates,!1):b.attachEvent("onmousemove",showCoordinates);b.innerHTML=htmlForCrossWire;document.body.appendChild(b);window.crossX=
document.getElementById("crossX");window.crossY=document.getElementById("crossY");window.crossLineX=document.getElementById("crossLineX");window.crossLineY=document.getElementById("crossLineY");this.crossWireEle=b}this.crossWired=!0;this.crossWireEle.style.display="";crossLineX.style.width=this.crossWireEle.style.width=crossX.innerHTML=document.body.clientWidth+"px";crossLineY.style.height=this.crossWireEle.style.height=crossY.innerHTML=document.body.clientHeight+"px"}};this.stopCrossWire=function(){this.crossWired&&
(this.crossWired=!1,this.crossWireEle.style.display="none")};this.startIde=function(){var b="exilityClient/ez.htm",c=window[ClientConstants.CSRF_HEADER];c&&(b+="?"+c);(b=window.open(b))?(window.IDE_WINDOW=b,setTimeout("try{window.IDE_WINDOW.PROJECT_WINDOW \x3d window;}catch(e){}",1E3)):alert("Unable to start IDE. window.open() failed, probably because of pop-up blocker issue.")}},htmlForCrossWire='\x3cimg id\x3d"crossLineY" src\x3d"images/blackDot.gif" style\x3d"width:1px;height:100px;position:absolute;top:1px;left:50px;valign:top;" /\x3e\x3cimg id\x3d"crossLineX" src\x3d"images/blackDot.gif" style\x3d"width:100px;height:1px;position:absolute;top:50px;left:1px;" /\x3e\x3cspan style\x3d"border:solid 1px blue; border-radius:4px; background-color:#EEEEEE; font-size:1.5em; margin-left:200px;"\x3e\x3cimg src\x3d"images/deleteIcon.png" alt\x3d"delete" style\x3d"cursor:pointer" onclick\x3d"headerMenu.stopCrossWire();" /\x3e\x26nbsp;\x26nbsp;X:\x3cspan id\x3d"crossX"\x3e\x3c/span\x3e   Y:\x3cspan id\x3d"crossY"\x3e\x3c/span\x3e\x26nbsp;\x26nbsp;\x3c/span\x3e',
showCoordinates=function(b){b||(b=event);var c=b.pageY||b.clientY+document.body.scrollTop;crossX.innerHTML=b.pageX||b.clientX+document.body.scrollLeft;crossY.innerHTML=c;crossLineX.style.top=b.clientY+"px";crossLineY.style.left=b.clientX+"px"};
function debug(b,c){if(exilityTraceWindow&&exilityTraceWindow.appendText)if(c)exilityTraceWindow.appendText(b);else{b=new String(b);for(var d=b.split("\n"),f=0;f<d.length;f++)b=d[f],b=0<=b.indexOf("error")||0<=b.indexOf("Error")||0<=b.indexOf("ERROR")?'\x3cfont style\x3d"color:red;"\x3e'+b+"\x3c/font\x3e":0<=b.indexOf("warning")||0<=b.indexOf("Warning")||0<=b.indexOf("WARNING")?'\x3cfont style\x3d"color:blue;"\x3e'+b+"\x3c/font\x3e":b.replace(/\t/g,"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"),exilityTraceWindow.appendText(b)}}
var datadebug=function(b){null!=exilityDataTraceWindow&&exilityDataTraceWindow.appendText("\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3cbr /\x3e\x3cpre\x3e"+b+"\x3c/pre\x3e\x3cbr /\x3e\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3cbr /\x3e")},
headerMenu=new HeaderMenu,exilityTraceWindow=null,exilityMainWindow=null,exilityPageStack=new PM.ExilityPageStack,exilityDataTraceWindow=null,inboxes={},urlField,urlArea,calWin,calElement,pickerWin,pickerEleStyle,mainBody,mainTop,coverMainStyle,coverPickerStyle,coverCalendarStyle,coverCalendarEle,imgMainStyle,imgPickerStyle,imgCalendarStyle,imgMainPrgIndStyle,htmlRootPath,topPath,lastWindowNumberUsed=0,exilityMainWindow=null,globalFieldValues={},currentActiveWindow=null,exilCombo,exilComboWin,toolTipEle,
toolTipStyle,localServices=[],pageValidation=!1,filesBeingUploaded=0,mainLoaded=function(){IdentifyBrowser.init();if(exilityMainWindow=window.frames.mainZero)exilityMainWindow.name="mainZero",currentActiveWindow=exilityMainWindow;mainTop=document.getElementById("top");mainBody=document.documentElement;urlField=document.getElementById("url");urlArea=document.getElementById("urlSpan");calElement=document.getElementById("calendarElement");calWin=window.frames.calendarWindow;pickerWin=window.frames.pickerWindow;
for(var b=null,b=[["pickerElement","pickerEleStyle"],["coverMain","coverMainStyle"],["imgMain","imgMainStyle"],["imgMainPrgInd","imgMainPrgIndStyle"],["coverPicker","coverPickerStyle"],["imgPicker","imgPickerStyle"],["coverCalendar","coverCalendarStyle"],["toolTip","toolTipStyle"]],c=0;c<b.length;c++){var d=document.getElementById(b[c][0]);d&&(window[b[c][1]]=d.style)}topPath=window.location.href;topPath=topPath.substring(0,topPath.lastIndexOf("/")+1);htmlRootPath=topPath+exilParms.baseHTMLFolderName;
exilCombo=document.getElementById("exilComboFrame");(exilComboWin=window.frames.exilComboFrame)&&exilParms.comboMaxRows&&(exilComboWin.comboMaxRows=exilParms.comboMaxRows);if(c=exilParms.localResourceFolder)if(c+="localServiceList.xml",b=getLocalResource(c,!0))for(b=b.getElementsByTagName("serviceEntries")[0].getElementsByTagName("serviceEntry"),c=0;c<b.length;c++)localServices[b[c].getAttribute("name")]=b[c];else alert("Could not load "+c+" for a list of local services.");else debug("If you intend to use local service, You MUST set exilParms.localResourceFolder to the root of the resource folder.")},
getLocalResource=function(b,c){var d;b=topPath+b;try{if("undefined"!=typeof ActiveXObject){if(c){d=new ActiveXObject("Msxml2.XMLHTTP.6.0");d.open("GET",b,!1);d.send();var f=d.responseText;d=new ActiveXObject("Microsoft.XMLDOM");d.async=!1;d.loadXML(f);if(!d.documentElement){alert(b+" loaded into an empty document. Check for errors.\n"+d.parseError);return}return d.documentElement}d=new ActiveXObject("Msxml2.XMLHTTP.6.0");d.open("GET",urlextT,!1);d.send();return d.responseText}d=new XMLHttpRequest;
d.open("GET",b,!1);d.send(null);return d=c?d.responseXML.documentElement:d.responseText}catch(g){return alert("Error while accessing "+b+"\n"+g),null}},htmlClicked=function(){urlArea.style.display="";urlField.focus()},goClicked=function(){headerMenu.navigate(urlField.value);urlArea.style.display="none"},showWindow=function(b){if(b=document.getElementById(b.name+"Div"))b.style.display=""},hideWindow=function(b){if(b=document.getElementById(b.name+"Div"))b.style.display="none"},closeWindow=function(b){if(b){removeInbox(b.name);
var c=document.getElementById(b.name+"Div");b.location.href="about:blank";try{c.parentNode.removeChild(c)}catch(d){}}},createWindow=function(b,c){lastWindowNumberUsed++;var d="main"+lastWindowNumberUsed,f=document.createElement("DIV");f.id=d+"Div";var g='style\x3d"width: 1028px; height: 570px;"';c&&(f.style.display="none",g=' style\x3d"border:solid 0px #E8E8E8;position:absolute; z-index:2; background-color: #FFF;  -webkit-box-shadow: 0px 8px 32px rgba(0,0,0,0.5);-webkit-border-radius: 5px;-moz-box-shadow: 0px 8px 32px rgba(0,0,0,0.5);-moz-border-radius: 5px;" ',
addToInbox(d,"isAPopup",!0));f.innerHTML='\x3ciframe id\x3d"'+d+'" name\x3d"'+d+'" src\x3d"'+b+'" frameborder\x3d"0" marginheight\x3d"0" marginwidth\x3d"0" '+g+"\x3e\x3c/iframe\x3e";mainTop.appendChild(f);debug("New window created with name\x3d"+d);return window.frames[d]},getInbox=function(b){var c=inboxes[b.name];if(c)for(var d in c)b[d]=c[d]},addToInbox=function(b,c,d){var f=inboxes[b];f||(f={},inboxes[b]=f);f[c]=d};function removeInbox(b){inboxes[b]=null}
function resetWindowSize(b,c,d,f,g,h){h||(window.scrollTo(0,0),b.scrollTo(0,0));if(c||d)(h=document.getElementById(b.name))?(h=h.style,c&&(h.width=exilParms.showPageWidthInPercentage&&"pickerWindow"!=b.name?"100%":c+"px"),d&&(h.height=d+"px"),f&&(h.top=f+"px"),g&&(h.left=g+"px")):"main"!=b.parent.name.match("^main")&&debug("DESIGN ERROR:"+b.name+" is not a valid window element ","Error","Ok",null,null,null)}
var IdentifyBrowser={init:function(){this.browser=this.searchString(this.browserIds)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version"},searchString:function(b){for(var c=0;c<b.length;c++){var d=b[c].string,f=b[c].prop;this.versionSearchString=b[c].versionSearch||b[c].identity;if(d){if(-1!=d.indexOf(b[c].subString))return b[c].identity}else if(f)return b[c].identity}},searchVersion:function(b){var c=b.indexOf(this.versionSearchString);
if(-1!=c)return parseFloat(b.substring(c+this.versionSearchString.length+1))},browserIds:[{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"}]},codePickerLeft=-1,codePickerTop=-1,fileUploadData=null;
function TabbedWindows(b,c,d){this.labelsEle=b;this.windowsEle=c;this.windows={};this.names=[];this.nbrWindows=0;b.addEventListener?b.addEventListener("click",tabbedWindowLabelClicked,!1):b.attachEvent("onclick",tabbedWindowLabelClicked);d&&this.addWindow(d,this.HOME_NAME,"Home")}var a=TabbedWindows.prototype;a.ACTIVE_ATTR="exil-active";a.NAME_ATTR="exil-name";a.TAB_CLASS="winTab";a.TAB_LABEL_CLASS="winTabLabel";a.TAB_DELETE_CLASS="winTabDelete";a.HOME_NAME="_";a.NAME_PREFIX="window_";
a.addWindow=function(b,c,d){var f=this.windows[c];if(f){if(f.url==b)return debug(c+" is already open. shifting focus to that window"),this.showWindow(c),f;debug(c+" is already used for "+f.url+". Can not create a new window with this name for "+b);return null}f=document.createElement("div");f.style.display="none";var g=this.NAME_PREFIX+c;f.innerHTML='\x3ciframe class\x3d"tabbedWindow" id\x3d"'+g+'" name\x3d"'+g+'" src\x3d"'+b+'" frameborder\x3d"0" marginheight\x3d"0" marginwidth\x3d"0"\x3e\x3c/iframe\x3e';
f.id=g+"Div";this.windowsEle.appendChild(f);b=window.frames[g];g=document.createElement("div");g.className=this.TAB_CLASS;d='\x3cdiv class\x3d"'+this.TAB_LABEL_CLASS+'"\x3e'+d+"\x3c/div\x3e";"_"!=c&&(d+='\x3cdiv class\x3d"'+this.TAB_DELETE_CLASS+'"/\x3e');g.innerHTML=d;g.setAttribute(this.NAME_ATTR,c);this.labelsEle.appendChild(g);d=this.names.length;this.windows[c]={win:b,labelEle:g,name:c,winEle:f,idx:d};this.names[d]=c;this.nbrWindows++;this.showWindow(c)};
a.showWindow=function(b){var c=this.windows[b];if(c){if(this.currentWin){if(c===this.currentWin)return;this.currentWin.labelEle.removeAttribute(this.ACTIVE_ATTR);this.currentWin.winEle.style.display="none"}this.currentWin=c;c.labelEle.setAttribute(this.ACTIVE_ATTR,this.ACTIVE_ATTR);c.winEle.style.display="";c.win.focus()}else alert("Design error: Trying to show a window that does ot exists -"+b)};
a.getFirstWindow=function(){if(!this.nbrWindows)return null;for(var b=0;b<this.names.length;b++)if(this.names[b])return this.windows[this.names[b]];alert("design error: tabbedWindows in not keeping track of its windows");return null};
a.removeWindow=function(b,c){var d=this.windows[b];if(!d)return debug(b+" is not a tabbed window to be removed."),null;if(d.isModified&&!c)message("Do you want Abandon changes?",null,"Abandon Changes",abandonChanges,"No. Take me back to window",undoClick,d,d);else{var f=this.getFirstWindow();f&&this.showWindow(f.name);d.win.location.replace("about:blank");this.labelsEle.removeChild(d.labelEle);this.windowsEle.removeChild(d.winEle);delete this.windows[b];delete this.names[d.idx];this.nbrWindows--}};
a.labelClicked=function(b){var c=b.getAttribute(this.NAME_ATTR)||b.parentNode.getAttribute(this.NAME_ATTR);c?b.className==this.TAB_DELETE_CLASS?this.removeWindow(c):this.showWindow(c):alert("Design Error: window tabs click handler is unabel to get window name")};
a.setModifiedStatus=function(b,c){var d=b.substr(this.NAME_PREFIX.length),f=this.windows[d];f?f.isModified?c||(f.labelEle.removeAttribute(this.MODIFIED_ATTR),f.isModified=!1):c&&(f.labelEle.setAttribute(this.MODIFIED_ATTR,this.MODIFIED_ATTR),f.isModified=!0):alert("tabbedWindows.setModifiedStatus called with invalid window name "+d)};function tabbedWindowLabelClicked(b){b=b.target||b.srcElement;b.ownerDocument.defaultView.tabbedWindows.labelClicked(b)}
function abandonChanges(b){tabbedWindows.removeWindow(b.name,!0)}function undoTabClick(b){debug(b.name+" was modified. User was about to close it, and then changed her mind")}PM.backgroundJobs=new BackgroundJobs;
var setLanguage=function(b){if(!1!=exilityPageStack.resetStack(!0)){var c=exilParms.baseHTMLFolderName;b&&(c=c.substring(0,c.length-1),c+="-"+b+"/");htmlRootPath=topPath+c}},trim=function(b){return b?b.trim?b.trim():b.replace?b.replace(/^\s+|\s+$/g,""):""+b:""},clone=function(b){if("object"!=typeof b||null==b)return b;var c={},d;for(d in b)c[d]="win"==d?b[d]:clone(b[d]);return c},getRowInTable=function(b){if(!b||!b.nodeName)return null;var c=b.nodeName.toUpperCase();if("FONT"==c)for(;"TABLE"!=c;)b=
b.parentNode,c=b.nodeName.toUpperCase();for(;"BODY"!=c;){if(("TR"==c||"DIV"==c)&&b.rowIdx)return b;b=b.parentNode;if(!b)return null;c=b.nodeName.toUpperCase()}debug("no tr found for obj "+b.tagName+" with id "+b.id);return null},pageOf=function(b,c){if(!c)return"";var d=String(c),f=d.indexOf("?");0<f&&(d=d.substring(0,f));f=d.lastIndexOf("/");0<f&&(d=d.substring(f+1,999));return d},dcToText=function(b){var c="",d;for(d in b.messages){var c=c+("\x3cbr/\x3e"+d+"\x3cbr/\x3e"),f="\x3c/font\x3e";"ERROR"==
d.toUpperCase()?c+='\x3cfont color\x3d"red"\x3e':"WARNING"==d.toUpperCase()?c+='\x3cfont color\x3d"blue"\x3e':f="";for(var g=b.messages[d],h=0;h<g.length;h++)c+=g[h]+"\x3cbr/\x3e";c+=f}c||(c="\x3cbr/\x3eThere are no messages\x3cbr/\x3e");var c=c+'\x3cbr/\x3eValues are :\x3cbr/\x3e\x3ctable border\x3d"1"\x3e\x3ctr\x3e\x3cth\x3eVariable\x3c/th\x3e\x3cth\x3eValue\x3c/th\x3e\x3c/tr\x3e',k;for(k in b.values)"exilityServerTraceText"!=k&&"exilityServerPerformanceText"!=k&&(c+="\x3ctr\x3e\x3ctd\x3e"+k+"\x3c/td\x3e\x3ctd\x3e"+
b.values[k]+"\x3c/td\x3e\x3c/tr\x3e");var c=c+"\x3c/table\x3e",c=c+"\x3cbr/\x3eGrids are:\x3cbr/\x3e",l;for(l in b.grids)if(b.grids[l]){d=b.grids[l];c+="\x3cbr/\x3e"+l+" has "+d.length+" rows and ";d[0]&&(c+=d[0].length||" no ");c+=' columns\x3cbr/\x3e\x3ctable border\x3d"1"\x3e';c+="\x3ctr\x3e";if(0<d.length)for(f=0;f<d[0].length;f++)c+="\x3cth\x3e"+d[0][f]+"\x3c/th\x3e";c+="\x3c/tr\x3e";for(h=1;h<d.length;h++){c+="\x3ctr\x3e";for(f=0;f<d[h].length;f++)c+="\x3ctd\x3e",c=""==d[h][f]?c+"\x26nbsp;":
c+d[h][f],c+="\x3c/td\x3e";c+="\x3c/tr\x3e"}c+="\x3c/table\x3e"}var c=c+'\x3cbr/\x3eLists are:\x3cbr/\x3e\x3ctable border\x3d"1" cellpadding\x3d"0" cellspacing\x3d"2"\x3e\x3ctr\x3e\x3cth\x3eList Name\x3c/th\x3e\x3cth\x3eValues\x3c/th\x3e\x3c/tr\x3e',m;for(m in b.lists)b.lists[m]&&(c+="\x3ctr\x3e\x3ctd\x3e"+m+"\x3c/td\x3e\x3ctd\x3e"+b.lists[m]+"\x3c/td\x3e\x3c/tr\x3e");return c+="\x3c/table\x3e"},scrollIntoView=function(b){if(b&&b.parentNode){for(var c=b.parentNode;c&&"body"!=c.nodeName.toLowerCase();){if(c.scrollHeight!=
c.clientHeight&&c.scrollHeight!=c.offsetHeight){b.offsetTop<c.scrollTop?c.scrollTop=b.offsetTop:b.offsetTop>c.scrollTop+c.clientHeight?c.scrollTop=b.offsetTop-c.clientHeight+b.clientHeight:debug(" No need to scroll ");return}c=c.parentNode}debug("No scrolled parent found for "+b.id)}else debug(b+" is not a dom element. scrollIntoView() will not work")},findXY=function(b){var c=0,d=0;IdentifyBrowser.init();if("Explorer"==IdentifyBrowser.browser){if(b.offsetParent)for(;;){d+=b.offsetLeft;c+=b.offsetTop;
if(!b.offsetParent)break;b=b.offsetParent}}else if("Firefox"==IdentifyBrowser.browser&&!0==exilParms.alignCalendar){if(b.offsetParent)for(;;){d+=b.offsetLeft;c+=b.offsetTop;if(!b.offsetParent)break;b=b.offsetParent}}else if("Firefox"==IdentifyBrowser.browser&&b.parentNode)for(;;){d+=parseInt(b.offsetLeft);c+=parseInt(b.offsetTop);if(!b.parentNode||"DIV"==b.tagName&&"top"==b.id)break;b=b.parentNode}return{x:d,y:c}},messageBtnAction1=null,messageBtnAction2=null,messageBtnActionParam1=null,messageBtnActionParam2=
null,messageEles=null,message=function(b,c,d,f,g,h,k,l,m){window.messageEles||cacheMessageElements();d||(d="OK");var n=messageEles.msgDiv;if(n){coverMainStyle.zIndex=6;coverPage(coverMainStyle,imgMainStyle);messageBtnAction2=messageBtnAction1=null;if(null!=messageEles.msgLabel)c&&(messageEles.msgLabel.innerHTML=c),messageEles.msgText.innerHTML=b.replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;");else{var r=b.indexOf("\n");0>r?(c=b,b=""):(c=b.substr(0,r),b=b.substr(r+1));messageEles.msgHeader.innerHTML=
c;b=b.split("\n").join("\x3cbr /\x3e\x3cbr /\x3e");messageEles.msgDetail.innerHTML=b}messageEles.msgBtnText1.innerHTML=d&&0<d.length?"Ok"==d||"ok"==d?"OK":d:"OK";f&&(messageBtnAction1=f,k&&(messageBtnActionParam1=k));g?(messageEles.msgBtnText2.innerHTML=g,messageEles.btnDiv2.style.display="",h&&(messageBtnAction2=h,l&&(messageBtnActionParam2=l))):messageEles.btnDiv2.style.display="none";n.style.display="block";d=n.style.height;d=d.replace(/[p,P][x,X]/g,"");f=n.style.width;f=f.replace(/[p,P][x,X]/g,
"");""==d&&(d=n.offsetHeight);""==f&&(f=n.offsetWidth);g=document.body.scrollLeft;h=window.innerWidth;n.style.top=document.body.scrollTop+window.innerHeight/2-d/2-25+"px";n.style.left=g+h/2-f/2-225+"px";messageEles.morePanel&&(d=n="",m&&m.additionalMessageName?(n=dataTypeMessages[m.additionalMessageName]||"Sorry. We can not show additional help for this field, as we encountered an internal error while retrieving message for "+m.additionalMessageName,n=n.replace(/&/g,"\x26amp;"),mag=n.replace(/</g,
"\x26lt;")):d="none",messageEles.morePanel.innerHTML=n,messageEles.morePanel.style.display="none",messageEles.moreBtnDiv.style.display=d)}else if(g?window.confirm(b)?f&&executeFunction(f,k):executeFunction(h,l):(n=document.getElementById("warningMsg"))?(alignMsgBox(),showMessageInPanel(c,b,n)):(alert(b),f&&executeFunction(f,k)),k)try{showPanelForSure(k.parentNode),k.focus&&k.focus(),k.select&&k.select()}catch(q){}},executeFunction=function(b,c){if("function"==typeof b)b(c);else{var d=currentActiveWindow[b];
"function"==typeof d?d(c):currentActiveWindow.P2.act(null,null,b)}},showMessageInPanel=function(b,c,d){d.style.display="block";d.style.height.replace(/[p,P][x,X]/g,"");d.style.width.replace(/[p,P][x,X]/g,"");var f=c.substring(0,5);d.style.display="";d.className=b?"error":"error"==f?"error":"success";document.getElementById("warningMsg").innerHTML=c},cacheMessageElements=function(){window.messageEles={msgDiv:document.getElementById("messageBox"),msgLabel:document.getElementById("messageLabel"),msgText:document.getElementById("messageText"),
msgHeader:document.getElementById("messageHeader"),msgDetail:document.getElementById("messageDetail"),msgBtnText1:document.getElementById("messageButton1"),msgBtnText2:document.getElementById("messageButton2"),btnDiv2:document.getElementById("messageButtonDiv2"),morePanel:document.getElementById("messageAdditionalPanel"),moreBtnDiv:document.getElementById("messageButtonDiv3")}},showPanelForSure=function(b){var c=b&&b.ownerDocument;if(c)for(;"BODY"!=b.tagName.toUpperCase();b=b.parentNode){var d=b.id,
f=c.getElementById(d+"TabsDiv");if(f)"none"==f.style.display&&(b=f,f=c.getElementById(d+"Tab"),f.onclick(f,b.id));else if(b.style&&"none"==b.display)if(f=c.getElementById(d+"Twister"))f.onclick(f,d);else b.style.display=""}else debug("wrong object "+b+" sent to showPanelForSure")},messageButtonClicked=function(b){document.getElementById("messageBox").style.display="none";coverMainStyle.zIndex=2;currentActiveWindow.isAPopup||uncoverPage(coverMainStyle,imgMainStyle);"messageButton1"==b&&null!=messageBtnAction1?
executeFunction(messageBtnAction1,messageBtnActionParam1):"messageButton2"==b&&null!=messageBtnAction2&&executeFunction(messageBtnAction2,messageBtnActionParam2)},dragObj={zIndex:0},isIE=window.document.all,dragStart=function(b,c){var d,f;c?dragObj.elNode=document.getElementById(c):(dragObj.elNode=window.event.srcElement,dragObj.elNode||(dragObj.elNode=b.target));isIE?(d=window.event.clientX+document.documentElement.scrollLeft+document.body.scrollLeft,f=window.event.clientY+document.documentElement.scrollTop+
document.body.scrollTop):(d=b.clientX+window.scrollX,f=b.clientY+window.scrollY);dragObj.cursorStartX=d;dragObj.cursorStartY=f;dragObj.elStartLeft=parseInt(dragObj.elNode.style.left,10);dragObj.elStartTop=parseInt(dragObj.elNode.style.top,10);isNaN(dragObj.elStartLeft)&&(dragObj.elStartLeft=0);isNaN(dragObj.elStartTop)&&(dragObj.elStartTop=0);dragObj.elNode.style.zIndex=++dragObj.zIndex;isIE?(document.attachEvent("onmousemove",dragGo),document.attachEvent("onmouseup",dragStop),window.event.cancelBubble=
!0,window.event.returnValue=!1):(document.addEventListener("mousemove",dragGo,!0),document.addEventListener("mouseup",dragStop,!0),b.preventDefault())},dragGo=function(b){var c,d;isIE?(c=window.event.clientX+document.documentElement.scrollLeft+document.body.scrollLeft,d=window.event.clientY+document.documentElement.scrollTop+document.body.scrollTop):(c=b.clientX+window.scrollX,d=b.clientY+window.scrollY);dragObj.elNode.style.left=dragObj.elStartLeft+c-dragObj.cursorStartX+"px";dragObj.elNode.style.top=
dragObj.elStartTop+d-dragObj.cursorStartY+"px";isIE?(window.event.cancelBubble=!0,window.event.returnValue=!1):b.preventDefault()},dragStop=function(b){isIE?(document.detachEvent("onmousemove",dragGo),document.detachEvent("onmouseup",dragStop)):(document.removeEventListener("mousemove",dragGo,!0),document.removeEventListener("mouseup",dragStop,!0))},showToolTip=function(b){b=b.id.replace("docNodeName","docXpath");PM.toolTipEle.innerHTML='\x3cspan class\x3d"field" style:"background-color: yellow;"\x3e'+
document.getElementById(b).value+"\x3c/span\x3e";PM.toolTipStyle.top=event.clientY+130;PM.toolTipStyle.left=event.clientX+130;PM.toolTipStyle.display="inline"},hideToolTip=function(b){PM.toolTipEle.innerHTML="";PM.toolTipStyle.display="none"},getSpecificXy=function(b,c,d,f){for(var g;b;){d?(c.x+=b.offsetLeft,c.y+=b.offsetTop,g=b.offsetParent):(b.scrollLeft&&(c.x-=b.scrollLeft),b.scrollTop&&(c.y-=b.scrollTop),g=b.parentNode);if(!f&&"BODY"==b.nodeName.toUpperCase())break;if(!g){g=b.ownerDocument;g||
(g=b.getElementsByTagName("body")[0].ownerDocument);b=g.defaultView||g.parentWindow;if(b.parent==b)break;g=b.frameElement;debug("Restarted with parent window element "+g)}b=g}},getPageXy=function(b){var c={y:0,x:0};getSpecificXy(b,c,!0,!0);getSpecificXy(b,c,!1,!0);return c},getDocumentXy=function(b){var c={y:0,x:0};getSpecificXy(b,c,!0,!1);getSpecificXy(b,c,!1,!1);return c},TIMER_ID_PREFIX="timer_",nextTimerIdToUse=0,TimeBomb=function(b,c,d,f,g){g||(g=window);this.obj=b;this.functionName=c;this.parm=
d;this.id=nextTimerIdToUse;nextTimerIdToUse++;this.win=g;g[TIMER_ID_PREFIX+this.id]=this;this.timer=g.setTimeout(TIMER_ID_PREFIX+this.id+".go();",f)};TimeBomb.prototype.go=function(){delete this.win[TIMER_ID_PREFIX+this.id];this.timer=null;try{this.obj[this.functionName](this.parm)}catch(b){debug(this.obj+"with id "+this.obj.id+"."+this.functionName+"("+this.parm+") failed with error "+b)}};TimeBomb.prototype.stop=function(){this.timer&&(this.win.clearTimeout(this.timer),this.timer=null)};
var htmlEscape=function(b){return b&&b.replace?b.replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;"):b},parseAttributes=function(b){var c={};if(!b)return c;for(var d=b.split("\t"),f=0;f<d.length;f++){var g=d[f].split("\x3d");2!=g.length?debug(b+' has invalid name/values pairs. "'+d[f]+'" will be ignored'):c[g[0]]=g[1]}return c},attachListener=function(b,c,d){b.addEventListener?b.addEventListener(c,d,!0):b.attachEvent("on"+c,d)},NODE_TYEPE={TEXT:"#text",COMMENT:"#comment"},getFirstNonTextNode=function(b){for(var c=
null,d=0;d<b.childNodes.length;d++)if(c=b.childNodes[d],c.nodeName!==NODE_TYEPE.TEXT&&c.nodeName!==NODE_TYEPE.COMMENT)return c},findRowIndex=function(b,c,d,f){f=b&&b.length?b.length:1;if(2>f||!c)return-1;d=0<=d&&d<=f-1?d:1;var g=b[0].length,h,k;for(c=c.toString().toUpperCase().trim();d<f;d++)if(h=b[d])for(var l=0;l<g;l++)if(k=h[l])if(k=k.toString().toUpperCase().trim(),c===k)return d;return-1},valueListToGrid=function(b){if(!b)return null;var c=[[]],d=[];b=b.split(";");for(var f=0;f<b.length;f++)d=
b[f].split(","),c[f]=d;return 0<c.length?c:null},evaluateDateShortCuts=function(b){if(!b)return null;b=(new String(b)).toLowerCase();if("."==b||"today"==b)return getToday();if("+"==b||"tomorrow"==b)return getToday(1);if("-"==b||"yesterday"==b)return getToday(-1);var c=RegExp(/^([-|+])(\d+)$/).exec(b);if(null!=c)return getToday(1*c[0]);if(3!=b.length||"o"!=b.substr(1,1))return null;c=b.substr(0,1);if("b"==c)c=!0;else if("e"==c)c=!1;else return null;var d=b.substr(2,1);b=getToday();switch(d){case "w":d=
b.getDate()-b.getDay();c||(d+=6);b.setDate(d);break;case "m":c?b.setDate(1):(b.setMonth(b.getMonth+1),b.setDate(-1));break;case "q":d=b.getMonth();d-=d%3;c?(b.setMonth(d),b.setDate(1)):(b.setMonth(d+3),b.setDate(-1));break;case "y":c?(b.setMonth(0),b.setDate(1)):(b.setMonth(11),b.setDate(31))}return b},parseDateTime=function(b){var c=b.split(" ");b=parseDate(c[0]);if(!b)return null;if(1>=c.length)return b;var c=c[1].split(":"),d=c[0]?parseInt(c[0],10):0,f=c[1]?parseInt(c[1],10):0,c=c[2]?parseInt(c[2]):
0;if(isNaN(d)||23<d||0>d||isNaN(f)||0>f||59<f||isNaN(c)||0>c||59<c)return null;b.setHours(d,f,c);return b},parseDate=function(b){var c=evaluateDateShortCuts(b);c||(c=parseStandardDate(b));c||(c=parseNonStandardDate(b));return c},parseStandardDate=function(b){var c=b.split(exilParms.dateSeparator);if(3>c.length)return null;b=parseInt(c[exilParms.dateAt],10);if(isNaN(b)||31<b||0>=b)return null;var d=null,d=new String(c[exilParms.monthAt]);exilParms.useMonthName?d=exilParms.monthIndex[d.toLowerCase()]:
(d=parseFloat(d,10),d--);if(null==d||isNaN(d)||0>d||11<d)return null;c=parseInt(c[exilParms.yearAt],10);if(isNaN(c)||0>c||9999<c)return null;100>c&&(c=c<exilParms.cutOffForShortYear?2E3+c:1900+c);b=new Date(c,d,b);return b.getMonth()!=d?null:b},POSSIBLE_SEPARATORS=[" ",".","-","/"],parseNonStandardDate=function(b){for(var c=[],d=POSSIBLE_SEPARATORS.length-1;0<=d;d--){var f=POSSIBLE_SEPARATORS[d];if(0<=b.indexOf(f)){c=b.split(f);break}}if(3<c.length)return null;d=new Date;b=d.getMonth();f=d.getFullYear();
d=null;if(1===c.length){if(d=parseInt(c[0],10))if(c=new Date(f,b,d),c.getDate()===d)return c;return null}return 2===c.length?parseDateAndMonth(c[0],c[1],f):parseThreePartDate(c[0],c[1],c[2])},parseDateAndMonth=function(b,c,d){var f=parseInt(b,10),g=parseInt(c,10),h=exilParms.monthIndex[b.toLowerCase()],k=exilParms.monthIndex[c.toLowerCase()],l=null,m=null;if(3===b.length)if(0<=h&&12>h&&g)l=g,m=h+1;else return null;else if(3===c.length)if(0<=k&&12>k&&f)l=f,m=k+1;else return null;else{if(!f||!g||12<
f&&12<g)return null;12<f?(l=f,m=g):12<g?(l=g,m=f):0===exilParms.dateAt?(l=f,m=g):(l=g,m=f)}b=new Date(d,m-1,l);return l===b.getDate()?b:null},parseThreePartDate=function(b,c,d){var f,g=parseInt(b,10),h=parseInt(c,10);d=parseInt(d,10);if(!d)return null;if(3===c.length){c=exilParms.monthIndex[c.toLowerCase()];if(12>c)c++;else return null;b=g;f=d}else if(3===b.length){c=exilParms.monthIndex[b.toLowerCase()];if(12>c)c++;else return null;b=h;f=d}else{if(!h||!g)return null;1E3<g?(f=g,c=h,b=d):(f=d,12<g?
(b=g,c=h):12<h?(b=h,c=g):0===exilParms.dateAt?(b=g,c=h):(b=h,c=g))}g=new Date(f,c-1,b);return g.getDate()!=b?null:g},getToday=function(b){var c=new Date,c=new Date(c.getFullYear(),c.getMonth(),c.getDate());b&&c.setDate(c.getDate()+b);return c},formatDateTime=function(b){if(!b)return"";var c=formatDate(b),d=b.getHours();10>d&&(d="0"+d);var f=b.getMinutes();10>f&&(f="0"+f);b=b.getSeconds();10>b&&(b="0"+b);return c+" "+d+":"+f+":"+b},formatDate=function(b){if(!b)return"";var c=[],d=b.getDate();10>d&&
(d="0"+d);c[exilParms.dateAt]=d;exilParms.useMonthName?d=exilParms.monthNames[b.getMonth()]:(d=b.getMonth()+1,10>d&&(d="0"+d));c[exilParms.monthAt]=d;b=b.getFullYear();c[exilParms.yearAt]=exilParms.useShortYear?(new String(b)).substr(2,2):b;return c[0]+exilParms.dateSeparator+c[1]+exilParms.dateSeparator+c[2]},getDateTimeParts=function(b,c){var d="",f="00",g="00",h="00",k=0;if(b){var l=b.split(" ");l[0]&&(d=l[0]);l[1]&&(l=l[1].split(":"),l[0]&&(f=l[0],c&&(f=parseInt(l[0],10),12<f&&(f-=12,k=1),10>
f&&(f="0"+f))),l[1]&&(g=l[1]),l[2]&&(h=l[2]))}return{dt:d,hr:f,mn:g,sc:h,am:k}},DataCollection=function(){this.values={};this.lists={};this.grids={};this.success=!0;this.messages={}},a=DataCollection.prototype;a.TABLE_SEPARATOR=String.fromCharCode(28);a.BODY_SEPARATOR=String.fromCharCode(29);a.ROW_SEPARATOR=String.fromCharCode(30);a.FIELD_SEPARATOR=String.fromCharCode(31);a.VALUES_TABLE_NAME="values";a.SUCCESS_FIELD_NAME="_success";a.MESSAGES_TABLE_NAME="_messages";a.MESSAGE_TYPE_ERROR="error";
a.MESSAGE_TYPE_WARN="warning";a.AUTHENTICATION_STATUS="authenticationStatus";a.TRACE_FIELD_NAME="exilityServerTraceText";a.PERFORMANCE_FIELD_NAME="exilityServerPerformanceText";a.fromDc=function(b){this.success=b.success;this.values=b.values;this.messages=b.messages;this.grids=b.grids;this.lists=b.lists};a.addMessage=function(b,c){b=b.toLowerCase();var d=this.messages[b];d&&"undefined"!==typeof d||(d=[],this.messages[b]=d);d.push(c);b==this.MESSAGE_TYPE_ERROR&&(this.success=!1)};
a.hasValues=function(){for(var b in this.values)return!0;return!1};a.getValue=function(b){return this.values[b]};a.hasValue=function(b){return"undefined"!==typeof this.values[b]};a.addValue=function(b,c){this.values[b]=c};a.removeValue=function(b){var c=this.values[b];delete this.values[b];return c};a.getGrid=function(b){return this.grids[b]};a.addGrid=function(b,c){this.grids[b]&&debug("grid "+b+" is already in the dc. It will be replaced with the new grid");this.grids[b]=c};
a.removeGrid=function(b){var c=this.grids[b];delete this.grids[b];return c};a.addList=function(b,c){this.lists[b]=c};a.getList=function(b){return this.lists[b]};a.removeList=function(b){var c=this.lists[b];delete this.lists[b];return c};a.hasError=function(){return!this.success};a.getMessageText=function(){var b="",c;for(c in this.messages)for(var b=c==ClientConstants.MESSATE_TYPE_ERROR?b+"Error\n":b+(c+"\n"),d=this.messages[c],f=0;f<d.length;f++)b+=d[f]+"\n";return b};
a.serialize=function(){var b="",c=[this.VALUES_TABLE_NAME,this.BODY_SEPARATOR],d=!0;for(name in this.values)(b=this.values[name])||0==b||(b=""),d?d=!1:c.push(this.ROW_SEPARATOR),c.push(name),c.push(this.FIELD_SEPARATOR),c.push(b);for(var f in this.grids)if(this.grids[f]){var g=this.grids[f];c.push(this.TABLE_SEPARATOR);c.push(f);c.push(this.BODY_SEPARATOR);for(d=0;d<g.length;d++){0!=d&&c.push(this.ROW_SEPARATOR);for(var h=g[d],k=0;k<g[d].length;k++)(b=h[k])||0==b||(b=""),0!=k&&c.push(this.FIELD_SEPARATOR),
c.push(b)}}for(var l in this.lists)if(b=this.lists[l])for(c.push(this.TABLE_SEPARATOR),c.push(l),c.push(this.BODY_SEPARATOR),d=0;d<b.length;d++)0!=d&&c.push(this.ROW_SEPARATOR),c.push(b[d]);return c.join("")};
a.deserialize=function(b){b=b.split(this.TABLE_SEPARATOR);for(var c=0;c<b.length;c++){var d=b[c].split(this.BODY_SEPARATOR);if(2==d.length){for(var f=d[0],g=d[1].split(this.ROW_SEPARATOR),d=[],h=0;h<g.length;h++)d.push(g[h].split(this.FIELD_SEPARATOR));if(f==this.VALUES_TABLE_NAME){for(h=1;h<d.length;h++)f=d[h],this.addValue(f[0],f[1]);this.success=(f=this.getValue(this.SUCCESS_FIELD_NAME))&&"1"==f}else if(f==this.MESSAGES_TABLE_NAME)for(h=1;h<d.length;h++)f=d[h],this.addMessage(f[0],f[1]);else this.addGrid(f,
d)}}};
a.fromElement=function(b){for(var c=b.getElementsByTagName("input"),d=c.length,f,g,h=null,k=0;k<d;k++)if(h=c[k],f=h.name||h.id){g=h.type?h.type.toLowerCase():"text";if("text"!=g){if("button"===g||"reset"==g||"submit"===g||"image"==g||"file"===g)continue;if(("radio"==g||"checkbox"==g)&&!h.checked)continue}g=h.value;this.hasValue(f)&&(g=this.getValue(f)+","+g);this.addValue(f,g)}c=b.getElementsByTagName("select");d=c.length;for(k=0;k<d;k++)if(h=c[k],f=h.id||h.name){b=h.childNodes;g=null;if(h.multiple)for(h=0;h<
b.length;h++){var l=b[h];b.selected&&(g=g?g+(","+l.value):l.value)}else if(h.selectedIndex||0==h.selectedIndex)g=b[h.selectedIndex].value;null!=g&&this.addValue(f,g)}};a.toHtml=function(){var b=[];this.messagesToHtml(b);this.valuesToHtml(b);this.gridsToHtml(b);this.listsToHtml(b);return b.join("")};
a.messagesToHtml=function(b){var c=!1,d;for(d in this.messages){c=!0;b.push("\x3cbr/\x3e");b.push(d);b.push("\x3cbr/\x3e");var f="\x3c/font\x3e";d===this.MESSAGE_TYPE_ERROR?b.push('\x3cfont color\x3d"red"\x3e'):d===this.MESSAGE_TYPE_WARN?b.push('\x3cfont color\x3d"blue"\x3e'):f="";for(var g=this.messages[d],h=0;h<g.length;h++)b.push(g[h]+"\x3cbr/\x3e");b.push(f)}c||b.push("\x3cbr/\x3eThere are no messages\x3cbr/\x3e")};
a.valuesToHtml=function(b){b.push("\x3cbr/\x3eValues are :\x3cbr/\x3e");b.push('\x3ctable border\x3d"1"\x3e\x3ctr\x3e\x3cth\x3eVariable\x3c/th\x3e\x3cth\x3eValue\x3c/th\x3e\x3c/tr\x3e');for(var c in this.values)c!=this.TRACE_FIELD_NAME&&c!=this.PERFORMANCE_FIELD_NAME&&(b.push("\x3ctr\x3e\x3ctd\x3e"),b.push(c),b.push("\x3c/td\x3e\x3ctd\x3e"),b.push(this.values[c]),b.push("\x3c/td\x3e\x3c/tr\x3e"));b.push("\x3c/table\x3e")};
a.gridsToHtml=function(b){var c=!1,d;for(d in this.grids){var f=this.grids[d];if(f){c||(b.push("\x3cbr/\x3eGrids are:"),c=!0);b.push("\x3cbr/\x3e");var g=f.length,h=g&&f[0].length;b.push(d);b.push(" has ");if(h){b.push(g-1);b.push(" data rows and ");b.push(h);b.push(' columns\x3cbr/\x3e\x3ctable border\x3d"1"\x3e\x3ctr\x3e');for(var k=f[0],l=0;l<h;l++)b.push("\x3cth\x3e"),b.push(k[l]),b.push("\x3c/th\x3e");b.push("\x3c/tr\x3e");for(k=1;k<g;k++){b.push("\x3ctr\x3e");for(var m=f[k],l=0;l<h;l++)b.push("\x3ctd\x3e"),
b.push(m[l]||"\x26nbsp;"),b.push("\x3c/td\x3e");b.push("\x3c/tr\x3e")}b.push("\x3c/table\x3e")}else b.push(" no data.")}}};
a.listsToHtml=function(b){var c=!1,d;for(d in this.lists){var f=this.lists[d];f&&(c||(b.push('\x3cbr/\x3eLists are:\x3cbr/\x3e\x3ctable border\x3d"1" cellpadding\x3d"0" cellspacing\x3d"2"\x3e\x3ctr\x3e\x3cth\x3eList Name\x3c/th\x3e\x3cth\x3eValues\x3c/th\x3e\x3c/tr\x3e'),c=!0),b.push("\x3ctr\x3e\x3ctd\x3e"),b.push(d),b.push("\x3c/td\x3e\x3ctd\x3e"),b.push(f),b.push("\x3c/td\x3e\x3c/tr\x3e"))}c&&b.push("\x3c/table\x3e")};window.fieldFormatters||(window.fieldFormatters={});
fieldFormatters.lcase||(fieldFormatters.lcase=function(b){b&&(b=b.toLowercase());return b});fieldFormatters.formatWholeNumber=function(b,c,d){b+="";var f=b.length-3;if(0>=f)return b;for(newVal=b.substr(f,3);;){if(f<=c)return b.substr(0,f)+d+newVal;f-=c;newVal=b.substr(f,c)+d+newVal}};
fieldFormatters.formatFraction=function(b,c,d){b=Math.round(100*parseFloat(b));var f="";0>b&&(f="-",b=-b);var g=Math.floor(b/100);b-=100*g;10>b&&(b="0"+b);b=","==d?"."+b:","+b;return f+fieldFormatters.formatWholeNumber(g,c,d)+b};fieldFormatters.inr||(fieldFormatters.inr=function(b){b=Math.round(parseFloat(b));return 0<=b?fieldFormatters.formatWholeNumber(b,2,","):"-"+fieldFormatters.formatWholeNumber(-b,2,",")});
fieldFormatters.inr2||(fieldFormatters.inr2=function(b){return fieldFormatters.formatFraction(b,2,",")});fieldFormatters.eur||(fieldFormatters.eur=function(b){b=Math.round(parseFloat(b));return 0<=b?fieldFormatters.formatWholeNumber(b,3,"."):"-"+fieldFormatters.formatWholeNumber(-b,3,".")});fieldFormatters.eur2||(fieldFormatters.eur2=function(b){return fieldFormatters.formatFraction(b,3,".")});
fieldFormatters.usd||(fieldFormatters.usd=function(b){b=Math.round(parseFloat(b));return 0<=b?fieldFormatters.formatWholeNumber(b,3,","):"-"+fieldFormatters.formatWholeNumber(-b,3,",")});fieldFormatters.usd2||(fieldFormatters.usd2=function(b){return fieldFormatters.formatFraction(b,3,",")});fieldFormatters.amt||(fieldFormatters.amt=function(b){return fieldFormatters.inr(b)});fieldFormatters.amt2||(fieldFormatters.amt2=function(b){return fieldFormatters.inr2(b)});
var messagesObject=function(){messages={exilGetValueError:"exilGetValueError",exilSetValueError:"exilSetValueError",exilSetValueErrorOutputField:"exilSetValueErrorOutputField",exilSetValueErrorTextInputField:"exilSetValueErrorTextInputField",exilFillListError1:"exilFillListError1",exilSetValueErrorSelectionField:"exilSetValueErrorSelectionField",exilMustEnterError:"This Field is Mandatory",exilPageParameterMissing:"exilPageParameterMissing",exilFillListNoGrids:"exilFillListNoGrids",exilValidateDependecyFailed:"exilValidateDependecyFailed",
exilNoIdField:"exilNoIdField",exilValidateUniqueColumnsFailed:"exilValidateUniqueColumnsFailed",exilIdMismatchError:"exilIdMismatchError",exilGetValueError:"exilGetValueError",exilSetValueErrorCheckBoxField:"exilSetValueErrorCheckBoxField",exilNumberValidateFromToFailed1:"exilNumberValidateFromToFailed1",exilNumberValidateFromToFailed2:"exilNumberValidateFromToFailed2",exilTextValidateFromToFailed1:"exilTextValidateFromToFailed1",exilTextValidateFromToFailed2:"exilTextValidateFromToFailed2",exilDateValidateFromToFailed1:"exilDateValidateFromToFailed1",
exilDateValidateFromToFailed2:"exilDateValidateFromToFailed2",exilParseDateFailedNullValue:"exilParseDateFailedNullValue",exilParseDateFailedImproperFormat:"exilParseDateFailedImproperFormat",exilParseDateFailedDDisNaN:"exilParseDateFailedDDisNaN",exilParseDateFailedYYYYisNaN:"exilParseDateFailedYYYYisNaN",exilParseDateFailedDateChanged:"exilParseDateFailedDateChanged"};this.getMessage=function(b,c){return messages[c]}},systemMessages=new messagesObject,pendingServerCalls=null,ExilityServerStub=function(b){this.win=
b;this.TIMEOUT=12E4;this.SQ={};this.SQ.nextIdx=1;this.refreshPageUnderProgress=!1;this.pendingServices=[]},ServiceEntry=function(b,c,d,f,g,h,k,l,m,n,r,q){this.serviceId=b;this.dc=c||new DataCollection;this.waitForResponse=d;this.callBackAction=f;this.callBackObject=g;this.fieldName=h;this.toRefreshPage=k?k:ServerAction.BEFORE;this.timerHandle=this.httpObject=null;this.dc.addValue("serviceId",b);window.testCaseToBeCaptured&&this.dc.addValue(ClientConstants.TEST_CASE_CAPTURE,testCaseToBeCaptured);this.url=
"";this.disableForm=l;this.showPage=m;this.fieldToFocusAfterExecution=n;this.listServiceOnLoad=r;this.callBackEvenOnError=q};
ExilityServerStub.prototype.callService=function(b){var c=b.serviceId;if(!c)throw"Design Error: Service is called with no service ID";var d=b.dc;b.win=this.win;debug("Received a request for service\x3d"+c+" and waitForResponse\x3d"+(b.waitForResponse?"true":"false")+" with following data.");debug(dcToText(d),!0);if(PM.localServices&&PM.localServices[c])this.callLocalService(localService);else{var c=exilParms.serviceName?topPath+exilParms.serviceName:exilParms.commonServiceName,f="";debug("Going to make a request for url "+
c);null!=exilityTraceWindow&&d.addValue("exilityServerTrace","1");f=this.serializeDc(d);null!=exilityDataTraceWindow&&datadebug("Request : \x3cbr\x3e"+f);var g=null,g="undefined"!=typeof ActiveXObject?new this.win.ActiveXObject("Microsoft.XMLHTTP"):new this.win.XMLHttpRequest;b.url=c;b.httpObject=g;var h=!b.waitForResponse;if(h){var k=this.SQ.nextIdx;this.SQ.nextIdx++;this.SQ[k]=b;b.timerHandle=this.win.setTimeout("PM.timeoutCallback(serverStub, "+k+")",this.TIMEOUT);g.onreadystatechange=this.win.getCallbackFunction(k);
this.win.serverStub||(this.win.serverStub=this)}try{g.open("POST",c,h);g.setRequestHeader("Content-Type","text/html; charset\x3dutf-8");var l=getCsrfToken();l&&g.setRequestHeader(ClientConstants.CSRF_HEADER,l);g.send(f)}catch(m){"paginationService"==b.serviceId&&"0"==d.values.pageNo?debug("Ignoring the network error, as it is supposed to remove session data only"):message("Application is unable to process your request because network connection is not available. Please establish Network connection and try again.",
"","Ok",null,null,null);b.disableForm&&uncoverPage(coverPickerStyle,imgMainPrgIndStyle);return}b.waitForResponse&&this.processServiceEntry(b)}};ExilityServerStub.prototype.callLocalService=function(b){};ExilityServerStub.prototype.httpCallBack=function(b){var c=this.SQ[b];!c||4>c.httpObject.readyState||(delete this.SQ[b],c.timerHandle&&this.win.clearTimeout(c.timerHandle),this.processServiceEntry(c))};
ExilityServerStub.prototype.processServiceEntry=function(b,c){var d=b.httpObject.status;debug("Asynch call has returned  for serviceId \x3d "+b.serviceId+" with document status \x3d "+d);if(200!=d&&0!=d){var f=systemMessages.getMessage(null,d);f?debug(f):(alert("Error while communicating with server. Status code returned \x3d "+d+"\nSee trace for additional information."),debug("server returned the following error message.\n"+b.httpObject.responseText));b.disableForm&&uncoverPage(coverPickerStyle,
imgMainPrgIndStyle)}else{try{if(!b.win||b.win.closed){debug("Window is already closed for service "+b.serviceId);return}temp=b.win.location.href}catch(g){debug("Window is already closed for service "+b.serviceId);return}if(c)this.windup(b,!0);else{f=b.httpObject.responseText;d=null;try{0==f.length?d=new DataCollection:0<=f.substr(0,15).indexOf("var dc \x3d ")?eval(f):d=this.deserializeDc(f)}catch(h){try{debug("error While Evaluating data returned by server. "+h.toString()),debug(f)}catch(k){}f=systemMessages.getMessage(null,
"invalidDataFromServer")||"Unable to get response from server.\n"+h;alert(f);this.windup();return}if(f=b.httpObject.getResponseHeader(ClientConstants.CSRF_HEADER))f===ClientConstants.REMOVE_CSRF&&(f=null),this.setCsrfToken(f);this.handleReturnedDc(d,b);if(b.fieldToFocusAfterExecution&&(d=b.win.P2.doc.getElementById(b.fieldToFocusAfterExecution)))try{d.focus()}catch(l){}}}};
ExilityServerStub.prototype.windup=function(b,c){c&&b.field&&b.field.descServiceId&&(b.field.isValid=!1);b.disableForm&&uncoverPage(coverPickerStyle,imgMainPrgIndStyle);b.showPage&&b.win.P2&&b.win.P2.showPage()};ExilityServerStub.prototype.handleReturnedDc=function(b,c){this.processReturnedDc(b,c)};
ExilityServerStub.prototype.processServiceQ=function(){if(this.refreshPageUnderProgress)debug(" another srvice is Still busy, Once again going to set a timeout"),this.win.setTimeout("P2.processServiceQ();",100);else{var b=this.pendingServices.pop();b?(this.refreshPageUnderProgress=!0,this.processReturnedDc(b.dc,b.se),this.refreshPageUnderProgress=!1):debug("design error: pendingServices is empty when I tried to wake up and process it")}};
ExilityServerStub.prototype.processReturnedDc=function(b,c){var d;if(b.values){if(d=b.values[ClientConstants.TRACE_NAME])debug("*********** SERVER TRACE START *********"),debug(d),debug("*********** SERVER TRACE END *********"),delete b.values[ClientConstants.TRACE_NAME];if(d=b.values[ClientConstants.PERF_TRACE_NAME])debug("*********** SERVER PERFORMANCE START *********"),debug(d),debug("*********** SERVER PERFORMANCE END *********"),delete b.values[ClientConstants.PERF_TRACE_NAME];debug(" data recd from server is");
debug(dcToText(b),!0);d=b.values[ClientConstants.AUTH_STATUS];if(0<d){if(1==d){if(pendingServerCalls){pendingServerCalls.push(c);debug(c.serviceId+" added to the pending sessioned out q.");return}debug("pendingServiceCalls initiated, and added "+c.serviceId+" to it.");pendingServerCalls=[c]}d=window.relogin;if(!d)try{d=parent.relogin||top.relogin}catch(f){}d&&"function"==typeof d?d(b,c):alert("Authentication failed. Please login to the system again.");return}}if(d=getMessageText(b))if(PM.message(d,
"","Ok",null,null,null),d=document.getElementById("warningMsg"))d.style.display="";c.dc=b;this.win.dc=b;if(b.success){var g=b.grids[ClientConstants.GLOBAL_FIELDS];if(g){d=g.length;if(2==d&&2<g[0].length){d=g[0].length;for(var h=g[0],g=g[1],k=0;k<d;k++){var l=h[k];"localDateFormat"==l?setLocalDateFormat(g[k]):globalFieldValues[l]=g[k]}}else for(k=1;k<d;k++)h=g[k],l=h[0],"localDateFormat"==l?setLocalDateFormat(h[1]):globalFieldValues[l]=h[1];debug(d-1+" global fields set")}PM.backgroundJobs||(PM.backgroundJobs=
new BackgroundJobs);PM.backgroundJobs.setAllBackgroundJobStatuses(c);(d=c&&c.win&&c.win.P2)?(c.toRefreshPage==ServerAction.BEFORE&&d.refreshPage(b,c.listServiceOnLoad),this.doCallBack(c),c.toRefreshPage==ServerAction.AFTER&&d.refreshPage(b,c.listServiceOnLoad)):this.doCallBack(c);this.windup(c,!1)}else debug("server error status is ERROR: No data refresh is going to happen"),c.callBackEvenOnError&&this.doCallBack(c),this.windup(c,!0)};
ExilityServerStub.prototype.doCallBack=function(b){var c=b.callBackAction;if(c){if("function"==typeof c)return c(b.callBackObject,b.fieldName,b,b.listServiceOnLoad);var d=b.win[c]&&b.win[c].serviceReturned;return d?d(b.dc):b.win.P2.act(b.callBackObject,b.fieldName,c,b,b.listServiceOnLoad)}if(b.callBackObject&&b.callBackObject.serviceReturned)return b.callBackObject.serviceReturned(b.dc)};
var timeoutCallback=function(b,c){var d=b.SQ[c];d?(debug("SERVERTIMEOUT : No response received from server"),message("SERVERTIMEOUT : No response received from server","","Ok",null,null,null),delete b.SQ[c],confirm("HTTP Status 408 - Network/Server access is lost. Do you want to re-submit the data?")?(b.callService(d),debug("Resubmitting the request")):b.processServiceEntry(d,!0)):message("timeoutCallback(), unknown response: index\x3d"+c,"","Ok",null,null,null)};
ExilityServerStub.prototype.serializeDc=function(b){return b.serialize()};ExilityServerStub.prototype.deserializeDc=function(b){var c=new DataCollection;c.deserialize(b);return c};ExilityServerStub.prototype.getResponse=function(b,c){var d=new ServiceEntry(b,c,!0,null,null,null,ServerAction.NONE,!1,!1);this.callService(d);return d.dc};
ExilityServerStub.prototype.resendServices=function(){if(pendingServerCalls&&pendingServerCalls.length)for(var b=0;b<pendingServerCalls.length;b++)this.callService(pendingServerCalls[b]);pendingServerCalls=null};ExilityServerStub.prototype.getCsrfToken=function(){return window[ClientConstants.CSRF_HEADER]};var getCsrfToken=function(){return window[ClientConstants.CSRF_HEADER]};ExilityServerStub.prototype.setCsrfToken=function(b){window[ClientConstants.CSRF_HEADER]=b};
var AbstractField=function(){this.value="";this.columnIdx=-1;this.defaultValue="";this.isEditable=!0};AbstractField.inrPrefixes="   ,  ,  ,  ,  ,  ,  ,  ,   ".split(" ");AbstractField.usdPrefixes="   ,   ,   ,   ,   ,   ,    , ".split(" ");a=AbstractField.prototype;
a.format=function(b){if(!this.formatter||"none"==this.formatter)return b;var c=window.fieldFormatters&&window.fieldFormatters[this.formatter];if(c)return c(b);debug("Design error: either formatter.js is not included in index page. or "+this.formatter+" is not a valid formatter.");return b};a.deformat=function(b){return(formatter=this.formatter)&&"none"!=formatter?-1!=formatter.indexOf("eur")?b.replace(/\./g,""):b.replace(/,/g,""):b};
a.setValue=function(b,c,d,f,g,h,k){if(b&&g&&this.dataType){var l=dataTypes[this.dataType];l&&(b=l.formatIn(b))}l=b;this.table?(f&&this.table.rowChanged(c,this.unqualifiedName,d),c||d||(d=this.table.currentRow),d||(d=this.table.getRowNumber(c)),c||(c=this.P2.doc.getElementById(this.table.getObjectId(this.name,d))),l=this.table.saveValue(b,this.columnIdx,d),this.table.hasAggregates&&this.table.aggregateAField(this,c,d)):(l=this.value,this.value=b,c||(c=this.P2.doc.getElementById(this.name)));if(l!=
b||h)c?(b&&g?(g=b,this.formatter&&(g=this.format(b)),this.setValueToObject(c,g)):l!=b&&this.setValueToObject(c,b),this.triggerFieldChangedEvents&&this.triggerFieldChangedEvents(b,c,d,f,!0,k)):debug("Dom element for "+this.name+" not found")};
a.saveValue=function(b,c,d,f){var g=this.table;g?(c&&!d&&(d=g.getRowNumber(c)),c&&"radio"==c.type&&""==b&&(b=c.value),g.repeatedField&&g.repeatedField===this?g.saveRepeatedColumnValue(b,c?c.getAttribute("key"):null,d):g.saveValue(b,this.columnIdx,d,f)):this.value=b};a.getValue=function(b,c,d){(b=this.table?this.table.getValue(this.columnIdx,b,d):this.value)&&c&&(c=dataTypes[this.dataType])&&(b=c.formatOut(b));return b};a.hasValue=function(){return null!=this.value&&0<this.value.length?!0:!1};
a.validate=function(b){return this.getValue()};a.validateValue=function(b,c,d){return b};a.fillDc=function(b){var c=this.getValue(0,!0);b.addValue(this.unqualifiedName||this.name,c);this.fillDcWithRelatives(b)};
a.fillDcWithRelatives=function(b){this.aliasName&&(b.addValue(this.aliasName,d),b.addValue(this.aliasName+"DataType",this.dataType));if(this.isFilterField){var c=this.name+"Operator",d=this.P2.fields[c],d=d.getValue(0,!0);b.addValue(c,d);this.aliasName&&b.addValue(this.aliasName+"Operator",d);c=this.name+"To";if(d=this.P2.fields[c])d=d.getValue(0,!0),b.addValue(c,d),this.aliasName&&b.addValue(this.aliasName+"To",d)}};a.isChanged=function(b){return this.getValue()!=b.value};
var OutputField=function(){AbstractField.call(this);this.maxCharacters=0;this.isEditable=!1},a=OutputField.prototype=new AbstractField;
a.setValueToObject=function(b,c){if(b){if(this.valueList){if(!this.valueListCollection){this.valueListCollection={};for(var d=this.valueList.split(";"),f=0;f<d.length;f++){var g=d[f].split(",");this.valueListCollection[g[0]]=g[1]}}(d=this.valueListCollection[c])&&(c=d)}else d=0==this.maxCharacters?9999:this.maxCharacters,0>d&&(d=-d),(c=new String(c))&&c.length>d?(d-=3,b.title=c,c=0>this.maxCharacters?"..."+c.substring(c.length-d):c.substring(0,d)+"..."):b.removeAttribute("title"),""==c?c="\x26nbsp;":
(this.allowHtmlFormattedText||(c=c.replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;")),c=c.replace(/\n/g,"\x3cbr /\x3e"));b.innerHTML=c}else debug("ERROR: null object passed to set value to field "+this.name+" and val \x3d "+c)};var BooleanOutputField=function(){AbstractField.call(this);this.trueValue="Yes";this.falseValue="No";this.isEditable=!1},a=BooleanOutputField.prototype=new AbstractField;a.setValueToObject=function(b,c){b.innerHTML="1"==c||1===c?this.trueValue:this.falseValue};
var AbstractInputField=function(){AbstractField.call(this);this.toBeSentToServer=!0},a=AbstractInputField.prototype=new AbstractField;a.validate=function(b){if(this.doNotValidate)return this.value;var c=this.P2.doc,d=this.value,f=d;try{f=this.validateValue(d,null,b)}catch(g){if(b=c.getElementById(this.name))b.isValid=!1;g.ele=b;g.field=this;throw g;}f!=d&&(this.value=d,(b=c.getElementById(this.name))&&this.setValueToObject(b,f));return d};
a.validateValue=function(b,c,d,f){if(this.multipleSelection&&"text"!=this.selectionValueType)return this.specialValidateValue(b);var g,h;!c&&this.dataType&&(c=dataTypes[this.dataType]);exilParms.validateDatesForBetween&&PM.pageValidation&&c&&"DATE"==c.basicType&&(this.isFilterField||this.fromField)&&this.filterToFieldExists();if(!this.requiresValidation||this.doNotValidate)return b;b=trim(b);if(!b)return this.validateOnEmpty(f),b;if(!c)return debug(this.name+" is not validated because it does not have a valid data type"),
b;b=c.validate(b,this.messageName);if(this.validationFunction&&(g=this.P2.win[this.validationFunction](b)))throw new ExilityError(g,b);if(d&&this.descServiceId){d=this.name;this.table&&(d=this.table.getObjectId(this.name));g=this.P2.doc.getElementById(d);if(!g)return message("Design Error: Object for "+d+" is not available during final validation","Error","Ok",null,null,null),b;if(g.pendingServiceRequest)throw new ExilityError("A call to server is still pending. Please submit again.");if(!1===g.isValid)throw new ExilityError("Invalid value");
}if(d=this.fromField)f&&(d=d.replace(this.table.name,f.name)),(h=(g=this.P2.getField(d))&&g.getValue())&&c.validateFromTo(h,b,g.label,this.label);if(d=this.toField)f&&(d=d.replace(this.table.name,f.name)),(h=(g=this.P2.getField(d))&&g.getValue())&&c.validateFromTo(b,h,this.label,d.label);if(d=this.otherField)if(f&&(d=d.replace(this.table.name,f.name)),(h=(g=this.P2.getField(d))&&g.getValue())&&b==val1)throw new ExilityError(this.label+" and "+g.label+" should have different values.");return b};
a.filterToFieldExists=function(){var b=null,c=null;if(this.isFilterField)b=this.P2.getField(this.name+"To"),c=this.P2.getField(this.name+"Operator");else if(this.fromField){b=this.P2.getField(this.fromField);if(!b.isFilterField)return;c=this.P2.getField(this.fromField+"Operator")}else return;if(!b||!c)debug("Other field for special filter validation could not be found in dom. Validation dropped");else if(6==c.getValue()&&(this.vale&&!b.value||!this.value&&b.value))throw new ExilityError("exilBetweenError");
};a.validateOnEmpty=function(b){if(this.isRequired)throw new ExilityError("exilValueRequired");var c=this.basedOnField;if(c&&(b&&(c=this.basedOnField.replace(this.table.name,b.name)),(b=this.P2.getFieldValue(c))&&(!this.basedOnFieldValue||b==this.basedOnFieldValue)))throw new ExilityError("exilValueRequired");};
a.interFieldValidate=function(b,c,d){var f;if(f=this.fromField)d&&(f=f(this.table.name,d.name)),(f=this.P2.getFieldValue(f))&&c.validateFromTo(f,b,this.fromField.label,this.label);if(f=this.toField)d&&(f=f(this.table.name,d.name)),(f=this.P2.getFieldValue(f))&&c.validateFromTo(b,f,this.label,this.toField.label);if(f=this.otherField)if(d&&(f=f.replace(this.table.name,d.name)),(f=this.P2.getFieldValue(f))&&b==f)throw new ExilityError(this.label+" and "+this.P2.fields[this.otherField].label+" should have different values.");
};
a.callDescService=function(b,c){this.P2.pendingDescTimer?(b=this.descObj,b.internalChange=!1,this.descObj=null,c=this.descIdx,this.descIdx=0,this.P2.pendingDescTimer=null):b.internalChange=!0;var d=new DataCollection;this.P2.fillDcFromQueryFields(d,this.descQueryFields,this.descQueryFieldSources,c,this.validateQueryFields)&&(d=new ServiceEntry(this.descServiceId,d,!1,descReturned,b,this.name,ServerAction.NONE,null,null,this.fieldToFocusAfterExecution),this.P2.win.serverStub.callService(d),b.pendingServiceRequest=!0)};
a.triggerFieldChangedEvents=function(b,c,d,f,g,h){if(!f&&this.descServiceId)if(""==b)this.setDescFields(c,null,!0,g,h);else if(!this.isUniqueField||"modify"!=this.P2.pageMode){c.pendingServiceRequest=!0;c.internalChange=g;g=new DataCollection;this.P2.fillDcFromQueryFields(g,this.descQueryFields,this.descQueryFieldSources,d,this.validateQueryFields,b)&&(b=new ServiceEntry(this.descServiceId,g,!1,descReturned,c,this.name,ServerAction.NONE,null,null,this.fieldToFocusAfterExecution,h),this.P2.win.serverStub.callService(b));
return}this.dependentSelectionField&&this.manageDependentLists(b,d,h);(f=this.fromField||this.toField)&&f.dependentSelectionField&&(f=this.P2.fields[f],f.getValue(d)&&f.manageDependentLists(b,d,h));b&&this.copyTo&&(h=this.P2.getField(this.copyTo))&&(h.getValue(d)||h.setValue(b,null,d,h.supressDescOnLoad,!1));this.onChangeActionName&&(debug("on change triggered for "+this.name+" onchange \x3d "+this.onChangeActionName),this.P2.act(c,this.name,this.onChangeActionName,b));this.onUserChangeActionName&&
!g&&(debug("on user change triggered for "+this.name+" onchange \x3d "+this.onUserChangeActionName),this.P2.act(c,this.name,this.onUserChangeActionName,b));this.isFilterOperator&&this.filterSelectionChanged(c,b)};
a.manageDependentLists=function(b,c,d){d=this.dependentSelectionField;for(var f=0;f<d.length;f++){var g=this.P2.fields[d[f]];if(g)if(g.listServiceId){var h=g.name;g.table&&(h=g.table.getObjectId(h,c));if(h=this.P2.doc.getElementById(h)){if(h.keyValue==b)break;h.keyValue=b}b?g.callListService(b,h,c,!0):(g.fillList(null,h),g.getValue()&&g.saveValue("",h,c,!0))}else debug(g.name+" is defined as a dependent selection field for "+this.name+". But "+g.name+" does not have a listServiceId.");else debug(" field "+
d[f]+" is not found when it is tried as a dependent selection field for "+this.name)}};var descReturned=function(b,c,d){b.pendingServiceRequest=null;d.win.P2.fields[c].setDescFields(b,d.dc.grids[d.serviceId],!1,b.internalChange,d.listServiceOnLoad)};
a.setDescFields=function(b,c,d,f,g){var h=this.descFields;if(h){var k=this.P2.getUnqualifiedNames(h),l=0;this.table&&(l=this.table.getRowNumber(b));if(this.isUniqueField&&"add"==this.P2.pageMode)c&&1<c.length&&!this.doNotValidate?(b.isValid=!1,d=new ExilityError(this.descMessageId||"Value already exists"),d.field=this,d.obj=b,this.P2.catchError(d)):b.isValid=!0;else{var m=null,n=0,r=null,q=null,t=null,s=null,v=!1,u=this.comboDisplayFields&&exilComboWin;c&&1<c.length?(v=b.isValid=!0,m=c[0],n=m.length,
t=c[1],u&&2<c.length&&(r=findRowIndex(c,b.value),0<r?t=c[r]:(v=!1,t=null,this.doNotValidate||(b.isValid=!1)))):c&&!this.doNotValidate&&(v=b.isValid=!1);c=null;for(var w=h.length,x=0;x<w;x++)if(r=h[x]){q=k[x];s="";if(v)if(this.doNotMatchDescNames)x<=n&&(s=t[x]);else for(var y=0;y<n;y++)if(q==m[y]){s=t[y];break}r==this.name?c=s:this.P2.setFieldValue(r,s,null,l,!1,!0,g)}if(v)c||(c=this.getValueFromObject(b)),this.doNotValidate&&exilParms.donotSetFirstDescValue&&!u||(this.saveValue(c,b,l),this.setValueToObject(b,
c),this.table&&this.table.rowChanged(b,this.unqualifiedName,l,f),this.triggerFieldChangedEvents(c,b,l,!0,f,g));else if(!d&&(this.triggerFieldChangedEvents("",b,l,!0,f,g),!this.doNotValidate)){s="invalid "+this.label;message(s,"Warning","Ok",null,null,null);try{b.select&&b.select(),b.focus&&b.focus()}catch(z){}}}}else debug("descFields property is not set for "+this.name+". Code picker will not show any values")};a.setMinMax=function(b,c){this.minDate=b;this.maxDate=c};
a.filterSelectionChanged=function(b,c){var d=b.id,d=d.substr(0,d.length-8),f=this.P2.doc.getElementById(d+"ToDiv");6==c?f.style.display="":f&&(f.style.display="none",this.P2.setFieldValue(d+"To",""))};var TextInputField=function(){AbstractInputField.call(this);this.requiresValidation=!0;this.minCharsToTriggerService=0;this.maxRowsToDisplay=7},a=TextInputField.prototype=new AbstractInputField;
a.setValueToObject=function(b,c){var d=dataTypes[this.dataType];if(d&&d.includesTime){var d=getDateTimeParts(c),f=this.getTimeObjects(b);f.dt&&(f.dt.value=d.dt);f.hr&&(f.hr.value=d.hr);f.mn&&(f.mn.value=d.mn);f.sc&&(f.sc.value=d.sc);f.am&&(f.am.selectedIndex=d.am)}else b.value=c};
a.getValueFromObject=function(b){var c=dataTypes[this.dataType];if(!c||!c.includesTime)return b.value=trim(b.value);b=this.getTimeObjects(b);c=b.dt.value;if(!c)return"";var d=b.hr&&b.hr.value||"0",d=parseInt(d,10)||0;b.am&&b.am.selectedIndex?d+=12:10>d&&(d="0"+d);return c+" "+d+":"+(b.mn&&b.mn.value||"00")+":"+(b.sc&&b.sc.value||"00")};
a.getTimeObjects=function(b){var c=this.name;this.table&&b.rowIdx&&(c=c+"__"+b.rowIdx);b=this.P2.doc;return{dt:b.getElementById(c+"Hr"),mn:b.getElementById(c+"Mn"),sc:b.getElementById(c+"Sc"),am:b.getElementById(c+"Am")}};var CheckBoxField=function(){AbstractInputField.call(this);this.isChecked=!1;this.checkedValue=exilParms.checkedValue;this.uncheckedValue=exilParms.uncheckedValue},a=CheckBoxField.prototype=new AbstractInputField;
a.initialize=function(){this.value=this.isChecked?this.checkedValue:this.uncheckedValue};a.getValueFromObject=function(b){return b.checked?this.checkedValue:this.uncheckedValue};a.hasValue=function(){return this.isChecked};a.setValueToObject=function(b,c){var d=c.toUpperCase();b.checked=c==b.value||c==this.checkedValue||"1"==c||"Y"==d||"YES"==d||"TRUE"==d?this.isChecked=!0:this.isChecked=!1};var HiddenField=function(){AbstractInputField.call(this);this.isEditable=!1},a=HiddenField.prototype=new AbstractInputField;
a.setValueToObject=function(b,c){b&&(b.value=c)};a.getValueFromObject=function(b){if(b)return b.value;debug("Hidden field shoudl not be used as a dom element. use P2.getFieldValue(fieldName) instead.");return null};var RadioButtonField=function(){AbstractInputField.call(this);this.isRadio=!0},a=RadioButtonField.prototype=new AbstractInputField;
a.getInpuElements=function(b){b.type&&(b=b.parentNode);b.id||(b=b.parentNode);b=b.getElementsByTagName("input");return b&&b.length?b:(debug("Design error: Radio buttons for field "+this.name+" not found in the dom"),null)};a.setValueToObject=function(b,c){var d=this.getInpuElements(b);if(d){for(var f=!1,g=0;g<d.length;g++)b=d[g],f||b.value!=c?b.checked=!1:f=b.checked=!0;if(!f&&this.defaultValue)for(g=0;g<d.length;g++)if(b=d[g],b.value==this.defaultValue){b.checked=!0;break}}};
a.getValueFromObject=function(b){var c=this.getInpuElements(b);if(!c)return debug("Design error: Radio buttons for field "+this.name+" not found in the dom"),null;for(var d=0;d<c.length;d++)if(b=c[d],b.checked)return b.value;return""};
a.callListService=function(b,c,d,f){c||(c=this.name,this.table&&(c=this.table.getObjectId(this.name,d)),c=this.P2.doc.getElementById(c));c&&(b?c.listServiceKey=b:c.listServiceKey&&delete c.listServiceKey,debug(this.name+" will expect a list service key value of "+c.listServiceKey));this.P2.callListService([["serviceId","keyValue"],[this.listServiceId,b]],c,this.name,this.listServiceQueryFieldNames,this.listServiceQueryFieldSources,d,f)};
a.fillListToObject=function(b,c,d,f){this.grid=b;var g="";if((f=b&&b.length)&&1<f){if(!this.htmlParts&&!this.init())return debug("Error while initializing "+this.name+" radio button field. "),!1;for(var g=[],h=1;h<f;h++){var k=b[h];g.push(this.htmlParts[0]);g.push(k[0]);g.push(this.htmlParts[1]);g.push(k[1]||k[0]);g.push(this.htmlParts[2])}g=g.join("")}c.innerHTML=g;d||this.setValueToObject(c,this.value)};
a.fillList=function(b,c,d,f){if(this.table){d=null;var g=this.P2.doc;if(this.sameListForAllRows){this.fillListToObject(b,this.obj,!0,f);for(var h=this.table,k=h.nbrRows,l=h.grid,m=1;m<=k;m++)l[m]&&(d=h.getObjectId(this.name,m),(c=g.getElementById(d))?this.fillListToObject(b,c,!1,f):debug(d+" is not a DOM element for field name "+this.name+" when we tried it to push a radio list to it"))}else{if(!c&&(d=this.table.getObjectId(this.name),c=g.getElementById(d),!c)){debug("Unable to get the dom object for field "+
this.name+" for assigning the value list we got from server.");return}this.fillListToObject(b,c,!1,f)}}else c||(c=this.obj),this.fillListToObject(b,c,!1,f)};a.init=function(){var b=this.P2.doc.getElementById(this.name);if(!b)return debug("Design Error: dom element with id\x3d"+this.name+" as a radio group is not found"),!1;this.htmlParts=b.innerHTML.split("---");b.innerHTML="";b.style.visibility="visible";return!0};
var TextAreaField=function(){AbstractInputField.call(this);this.requiresValidation=!0;this.numberOfRows=3;this.numberOfCharactersPerRow=40},a=TextAreaField.prototype=new AbstractInputField;a.getValueFromObject=function(b){return b.value=trim(b.value)};a.setValueToObject=function(b,c){b.value=c};var FileField=function(){AbstractInputField.call(this);this.isFileField=!0},a=FileField.prototype=new AbstractInputField;a.getValueFromObject=function(b){return b.value.replace(/^C:\\fakepath\\/i,"")};
a.setValueToObject=function(b,c){b.value=c};var PasswordField=function(){TextInputField.call(this)},SelectionField=function(){AbstractInputField.call(this);this.valueType="text"},a=SelectionField.prototype=new AbstractInputField;a.setGrid=function(b){for(var c={},d=1;d<b.length;d++){var f=b[d][0],g=b[d][1];g&&"0"!=g&&(c[f]=!0)}this.setAllValues(null,c);this.value=b};a.setList=function(b){for(var c={},d=0;d<b.length;d++)c[b[d]]=!0;this.setAllValues(null,c);this.value=b};
a.setValueToObject=function(b,c){if(this.multipleSelection){for(var d={},f=c.split(","),g=0;g<f.length;g++)d[f[g]]=!0;this.setAllValues(b,d)}else{b.backupValue=null;d=b.options;for(g=0;g<d.length;g++)if(d[g].value==c){d[g].selected=!0;return}g=this.P2.doc.createElement("option");g.innerHTML=(new String(c)).replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;");g.value=c;g.selected=!0;b.appendChild(g)}};
a.setAllValues=function(b,c){b||(b=this.P2.doc.getElementById(this.name));for(var d=b.options,f=d.length,g=0;g<f;g++){var h=d[g];c[h.value]?(h.selected=!0,delete c[h.value]):h.selected=!1}var d=this.P2.doc,k;for(k in c)k&&(f=d.createElement("option"),f.innerHTML=(new String(k)).replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;"),f.value=k,f.selected=!0,b.appendChild(f))};
a.getValueFromObject=function(b){if(!this.multipleSelection)return 0<=b.selectedIndex?b.options[b.selectedIndex].value:"";b=b.options;var c=b.length,d=[],f;switch(this.selectionValueType){case "text":for(var g=0;g<c;g++)f=b[g],f.selected&&d.push(f.value);return d.join(",");case "list":for(g=0;g<nbrOptions;g++)f=b[g],f.selected&&d.push(f.value);return d;case "grid":d.push(["value","selected"]);for(g=0;g<nbrOptions;g++)f=b[g],f.selected?d.push([f.value,"1"]):d.push([f.value,"0"]);1==d.length&&(d.length=
0);return d;default:return message("Design error: Multiple select has valueType\x3d"+this.valueType+". Only text, list and grid are allowed. "+this.name+" will not work properly","Error","Ok",null,null,null),""}};a.fillDc=function(b){this.multipleSelection?"text"==this.selectionValueType?b.values[this.name]=this.value:"grid"==this.selectionValueType?b.grids[this.name]=this.value||[["value","selected"]]:b.lists[this.name]=this.value||[]:(b.values[this.name]=this.value,this.fillDcWithRelatives(b))};
a.fillList=RadioButtonField.prototype.fillList;a.initSelection=function(b){return(b=b&&b.options&&b.options[0])?(b.selected=!0,b.value):""};
a.fillListToObject=function(b,c,d,f){if(c)if(this.grid=b,this.multipleSelection)this.fillMultiValuesToObject(b,c);else{var g=null,h=null,k=b?b.length:0;0<=c.selectedIndex&&(g=c.options[c.selectedIndex].value);g||(g=c.backupValue);if(g&&(c.backupValue=null,1<k)){for(var l=1;l<k;l++)if(b[l][0]==g){h=g;break}null==h&&(c.backupValue=g)}null==h&&1<k&&(this.selectFirstOption||2==k&&this.isRequired)&&(h=b[1][0]);k="";if(!1==this.isRequired||null==h)k='\x3coption value\x3d"" selected\x3d"selected"\x3e',this.blankOption&&
(k+=this.blankOption.replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;")),k+="\x3c/option\x3e";l=null;null!=h&&(l={},l[h]=!0);(b=this.buildOptions(b,c,l))?(k+=b,this.showMoreFunctoinName&&(k+='\x3coption value\x3d"'+ExilityPage.MORE_OPTION_VALUE+'"\x3eShow More\x3c/option\x3e'),c.innerHTML=k,d||h==g||(d=!1,f&&(d=this.supressDescOnLoad),this.P2.fieldChanged(c,this.name,!0,d,f))):(g&&this.P2.fieldChanged(c,this.name,!0,!1,f),c.innerHTML=k)}else debug("fillListToObject can not work without an dom element")};
a.buildOptions=function(b,c,d){if(!b||2>b.length)return"";c=[];for(var f=b[0].length,g=1<f,f=2<f,h=1;h<b.length;h++){var k=b[h][0];c.push('\x3coption value\x3d"');c.push(k);c.push('" ');d&&d[k]&&c.push('selected\x3d"selected" ');if(f){var l=b[h][2];l&&(c.push('class\x3d"'),c.push("0"===l?"inactiveoption":l),c.push('" '))}c.push("\x3e");g&&(k=this.codeAndDesc?k+" - "+b[h][1]:b[h][1]);c.push(k.replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;"));c.push("\x3c/option\x3e")}return c.join("")};
a.fillMultiValuesToObject=function(b,c,d){var f={},g=c.options;d=0;for(var h=g.length,k,l=0;l<h;l++)k=g[l],k.selected&&""!=k.value&&(f[k.value]=!0,d++);b=this.buildOptions(b,c,f);c.innerHTML=b;!b&&d&&this.P2.fieldChanged(c,this.name,!0,!1)};a.getDisplayVal=function(b){var c=this.grid;this.valueList&&(c=PM.valueListToGrid(this.valueList));var d=PM.findRowIndex(c,b,0);return 0<=d?(b=c[d],b[1]||b[0]):b};var takeCareOfIeGotcha=function(b){};a.callListService=RadioButtonField.prototype.callListService;
a.specialValidateValue=function(b){var c=b.length;if("grid"==this.selectionValueType)for(var c=b.length-1,d=1;d<b.length;d++){var f=b[d][1];f&&"0"!=f||c--}if(!c){if(this.isRequired)throw new ExilityError("exilValueRequired");if(!this.basedOnField)return b;c=this.P2.getFieldValue(this.basedOnField);if(!c)return b;if(!this.basedOnFieldValue||c==this.basedOnFieldValue)throw new ExilityError("exilValueRequired");}return b};
var AssistedInputField=function(){AbstractInputField.call(this);this.isAssisted=this.requiresValidation=!0};AssistedInputField.ATTR="data-suggest";a=AssistedInputField.prototype=new AbstractInputField;a.matchStartingChars=!1;a.helpText="Help is not available on this field";a.FETCHING_MESSAGE=[["","Fetching....."]];a.FETCHING_MESSAGE.stillFetching=!0;
a.initialize=function(){this.P2.ia||(this.P2.ia=new InputAssistant(this.P2));if(this.valueList){var b=this.valueList.split(";");this.valueList=[];for(var c=0;c<b.length;c++){var d=b[c].split(","),f=[d[0].trim()];d[1]?f.push(d[1].trim()):f.push(f[0]);this.valueList.push(f)}}(this.valueList||this.listServiceId||this.suggestionServiceId)&&(b=this.P2.doc.getElementById(this.name))&&b.setAttribute("autocomplete","off")};
a.setValueToObject=function(b,c){if(this.valueList||this.valueLists||this.listServiceId){b.internalValue=c;var d=this.valueList;if(!d&&this.valueLists){var f=b&&b.rowIdx;f||0==f||(this.table?f=this.table.currentRow:(debug("Design Error: current row can not be established for an assisted field. Setting it to 0."),f=0));(d=this.valueLists[f])||(this.valueLists[f]=d=[])}d||(this.valueList=d=[]);f="";if(c||""===c){for(var g=!1,h=0;h<d.length;h++){var k=d[h];if(k[0]==c){f=k[1]||c;g=!0;break}}g?b.valueNotFoundInList&&
delete b.valueNotFoundInList:(f=c,debug(c+" is not found in the list of values for "+this.name),d.push([c,c]),b.valueNotFoundInList=!0)}b.value=f}else b.value=c};a.getValueFromObject=function(b){return b.internalValue||""==b.internalValue?b.internalValue:b.value||""};a.callListService=SelectionField.prototype.callListService;
a.getDisplayVal=function(b){if(!this.valueList)return b?b:"";var c=this.valueList;b||0==b||(b=this.internalValue);var d=findRowIndex(c,b,0);if(0<=d)return c[d][1]||c[d][0];debug("display value for ["+b+"] not found");return b||""};a.isChanged=function(b){var c=this.getValue();this.valueList&&(c=this.getDisplayVal(c));return c!=b.value};
a.fillList=function(b,c,d,f){c||this.table||(c=this.P2.getFieldObject(this.name));b||(b=[["",""]]);this.blankOption&&(b=this.addBlankOption(b));d=[];for(var g=1;g<b.length;g++)d.push(b[g]);this.table&&!this.sameListForAllRows?(this.valueLists||(this.valueLists={}),g=this.table.currentRow,c&&"undefined"!=c.rowIdx?g=c.rowIdx:debug("ele not found for fillList. pushing to current row for "+this.name),this.valueLists[g]=d):this.valueList=d;b="";this.selectFirstOption&&d.length&&((g=d[0][0])||""===g)&&
(b=g);var h=this.P2.ia&&this.P2.ia.assistant;h&&h.field!=this&&(h=null);if(this.table&&this.sameListForAllRows)for(var k=this.table.grid,g=1;g<k.length;g++)(c=k[g])&&!c.isDeleted&&(c=this.P2.getFieldObject(this.name,g),c.valueNotFoundInList?this.setValueToObject(c,c.internalValue):this.setValue(b,c,g,null,!0,!1,f),h&&h.ele===c&&h.restart(d));else c&&(c.valueNotFoundInList?this.setValueToObject(c,c.internalValue):this.setValue(b,c,null,null,!0,!1,f),h&&h.ele===c&&h.restart(d))};
a.addBlankOption=function(b){if(!b||!b.length)return[["",""],["",this.blankOption]];for(var c=b[0],d=[],f=c.length,g=0;g<f;g++)d.push("");d[1]=this.blankOption;c=[c,d];for(d=1;d<b.length;d++)g=b[d],1==f&&g.push(g[0]),c.push(g);return c};
a.getValueList=function(b){if(this.valueList)return this.valueList;if(this.valueLists){var c=this.valueLists[b.rowIdx];c||(this.valueLists[b.rowIdx]=c=this.FETCHING_MESSAGE);return c}return this.listServiceId?(debug(this.name+" does not have valueList though it has a list service attached to that"),this.FETCHING_MESSAGE):null};
a.getSuggestions=function(b,c){if(this.localSuggestionList){var d=this.getSuggesitonsFromLocalStore(c);this.P2.ia.assistant.setSuggestions(b,c,d)}else{d=new DataCollection;d.addValue(this.unqualifiedName||this.name,c);if(this.suggestionServiceFields)for(var f=this.suggestionServiceFields.length,g=0;g<f;g++){var h=this.suggestionServiceFields[g],k=this.P2.getField(h);k&&k.unqualifiedName&&(h=k.unqualifiedName);k=this.suggestionServiceFieldSources?this.P2.getFieldValue(this.suggestionServiceFieldSources[g]):
k.getValue();d.addValue(h,k)}this.courier=new FieldServiceCourier(this,b,c);d=new ServiceEntry(this.suggestionServiceId,d,!1,null,this.courier,this.name,ServerAction.NONE,!1,!1,null);this.P2.win.serverStub.callService(d)}};
a.getSuggesitonsFromLocalStore=function(b){var c=this.localSuggestionList;if(!c)return null;var d=c.length;if(!c[1].text)for(var f=1;f<d;f++){var g=c[f];g.text=g[0].toUppercase()}b=b.toUppercase();for(var h=[c[0]],f=1;f<d;f++){var g=c[f],k=g.text.indexOf(b);if(this.matchStartingChars){if(0!==k)continue}else if(-1===k)continue;h.push(g)}return h};
a.gotSuggestions=function(b,c,d){if(this.beingAssisted){var f=null,g;for(g in b.grids){f=b.grids[g];break}this.P2.ia.assistant.setSuggestions(c,d,f)}else debug("Suggested values service came too late for field "+this.name)};a.focussed=function(b){return this.P2.ia.start(this,b)};a.blurred=function(b){return this.P2.ia.end(this,b)};FieldServiceCourier=function(b,c,d){this.field=b;this.ele=c;this.val=d};
FieldServiceCourier.prototype.serviceReturned=function(b){this.field.courier!==this?debug("User has typed before we could suggest for what she had already typed for field "+this.field.name):(this.field.courier=null,this.field.gotSuggestions(b,this.ele,this.val))};InputAssistant=function(b){this.P2=b;this.win=b.win};
InputAssistant.prototype={start:function(b,c){if(this.ele&&this.ele===c||c.hasAttribute("disabled")||c.hasAttribute("readonly"))return!1;this.ele=c;this.field=b;this.oldValue=c.value;b.beingAssisted=!0;var d=dataTypes[b.dataType];if(d&&d.basicType==AbstractDataType.DATE)return this.dateAssistant||(this.dateAssistant=new DateAssistant(this.P2)),this.assistant=this.dateAssistant,this.assistant.start(b,c,d),!0;if(b.suggestionServiceId)return this.suggestionAssistant||(this.suggestionAssistant=new SuggestionAssistant(this.P2)),
this.assistant=this.suggestionAssistant,this.assistant.start(b,c),!0;this.vList=null;if(d=b.getValueList(c))return this.listAssistant||(this.listAssistant=new ListAssistant(this.P2)),this.assistant=this.listAssistant,this.assistant.start(b,c,d),!0;this.ele=null;b.beingAssisted=!1;return!0},end:function(b,c,d){if(c&&c!==this.ele)return!1;if(this.toRetainFocus)return this.letItGo?this.letItGo=!1:new TimeBomb(this.ele,"focus",null,0,this.win),!1;this.assistant?(this.assistant.end(c),this.assistant=null):
debug("Possible error. trying to close an assistent that was never created");b.beingAssisted=!1;this.ele=null;return!0},mouseDownedOnAssistant:function(){this.toRetainFocus=!0;new TimeBomb(this,"mousedownEventsDone",!1,0,this.win)},mousedownEventsDone:function(){this.toRetainFocus=!1},monthBlurred:function(){this.toRetainFocus?new TimeBomb(this.ele,"focus",null,0,this.win):this.end(this.field,this.ele,!0)}};
var DateAssistant=function(b){this.P2=b;this.win=b.win;b=b.doc;var c=b.createElement("div");c.className="cal";c.style.position="absolute";c.innerHTML=this.paintCal();b.body.appendChild(c);this.viewStyle=c.style;this.yearEle=b.getElementById("cal_year");this.monthEle=b.getElementById("cal_month");this.dayEle=b.getElementById("cal_dates")};
DateAssistant.prototype={weekDays:"SMTWTFS".split(""),daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],start:function(b,c,d){this.field=b;this.ele=c;this.lastValue=c.value;var f=PM.getDocumentXy(c);this.viewStyle.top=f.y+c.clientHeight+1+"px";this.viewStyle.left=f.x+"px";f=PM.getToday();this.minDate=b.minDate||PM.getToday(-d.maxDaysBeforeToday);this.tmin=100*this.minDate.getFullYear()+this.minDate.getMonth();this.maxDate=b.maxDate||PM.getToday(d.maxDaysAfterToday);this.tmax=100*this.maxDate.getFullYear()+
this.maxDate.getMonth();(b=c.value)&&(b=PM.parseDate(b));b||(b=this.maxDate<f?this.maxDate:this.minDate>f?this.minDate:f);this.year=this.oYear=b.getFullYear();this.month=this.oMonth=b.getMonth();this.date=this.oDate=b.getDate();this.yearEle.innerHTML=this.year;this.monthEle.selectedIndex=this.month;this.render();this.viewStyle.display=""},end:function(){this.viewStyle.display="none"},paintCal:function(){var b=[];b.push('\x3ctable id\x3d"cal_table" onmousedown\x3d"P2.ia.mouseDownedOnAssistant(event)" \x3e\x3ctr\x3e\x3ctd id\x3d"cal_header"\x3e\x3cdiv id\x3d"cal_prev" onclick\x3d"P2.ia.assistant.changeYear(-1)"\x3e\x3c/div\x3e\x3cdiv id\x3d"cal_year"\x3eYear\x3c/div\x3e\x3cdiv id\x3d"cal_next" onclick\x3d"P2.ia.assistant.changeYear(1)" \x3e\x3c/div\x3e\x3cdiv id\x3d"cal_month_div"\x3e\x3cselect id\x3d"cal_month" onmousedown\x3d"P2.ia.letItGo \x3d true;" onblur\x3d"P2.ia.monthBlurred();" onchange\x3d"P2.ia.assistant.changeMonth()" \x3e');
for(var c=0;12>c;c++)b.push('\x3coption value\x3d"'+c+'"\x3e'),b.push(PM.exilParms.monthNames[c]),b.push("\x3c/option\x3e");b.push('\x3c/select\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3ctable id\x3d"cal_dates_table"\x3e\x3cthead\x3e\x3ctr\x3e');for(c=0;7>c;c++)b.push("\x3cth\x3e"),b.push(this.weekDays[c]),b.push("\x3c/th\x3e");b.push('\x3c/tr\x3e\x3c/thead\x3e\x3ctbody id\x3d"cal_dates" onclick\x3d"P2.ia.assistant.clicked(event);"\x3e');for(c=0;6>c;c++){b.push("\x3ctr\x3e");for(var d=
0;7>d;d++)b.push("\x3ctd\x3e\x26nbsp;\x3c/td\x3e");b.push("\x3c/tr\x3e")}b.push("\x3c/tbody\x3e\x3c/table\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e");return b.join("")},render:function(){this.yearEle.innerHTML=this.year;this.monthEle.selectedIndex=this.month;var b=null,c=0,d=32,f=100*this.year+this.month;f<this.tmax&&f>this.tmin?b="ok":f<this.tmin||f>this.tmax?b="nok":(f==this.tmin&&(c=this.minDate.getDate()),f==this.tmax&&(d=this.maxDate.getDate()));f=-1;this.year===this.oYear&&this.month===this.oMonth&&
(f=this.oDate);var g=(new Date(this.year,this.month,1)).getDay(),h=this.daysInMonth[this.month];1==this.month&&0==this.year%4&&this.year%100&&(h=29);for(var k,l,m=1,n=this.dayEle.childNodes,r=Math.ceil((h+g)/7),q=0;q<r;q++)if(k=n[q],k.style){var t=k.childNodes;k.style.display="";for(var s=0;7>s;s++){var v=t[s];v.style&&(0==q&&s<g||m>h?(k=" ",l="empty"):(k=m,m++,k==f?(this.selectedTd=v,l="sel"):l=b?b:k>=c&&k<=d?"ok":"nok"),v.className=l,v.firstChild.nodeValue=k)}}n[r]&&(n[r].style.display="none")},
mouseDowned:function(){this.toRetainFocus=!0;new TimeBomb(this.P2.ia,"retainFocus",!1,0,this.win)},clicked:function(b){b=b.target||b.srcElement;3==b.nodeType&&(b=b.parentNode);if("ok"==b.className||"sel"==b.className){b=new Date(this.year,this.month,parseInt(b.innerHTML,10));var c=dataTypes[this.dataType];this.ele.value=c&&c.includesTime?formatDateTime(b):formatDate(b);this.P2.focusNext(this.field,this.ele)}},changeYear:function(b){this.year+=b;this.render()},changeMonth:function(){this.month=this.monthEle.selectedIndex;
this.render()}};var ListAssistant=function(b){this.P2=b;this.win=b.win;b.listDiv||(b.listDiv=this.createListDiv(b.doc));this.div=b.listDiv};
ListAssistant.prototype={createListDiv:function(b){var c=b.createElement("div");c.innerHTML='\x3cdiv id\x3d"list_assistant" style\x3d"position:absolute; z-index:3;display:none" onmousedown\x3d"P2.ia.assistant.rowClicked(event)"\x3e\x3c/div\x3e';c=c.firstChild;3==c.nodeType&&(c=c.nextSibling);b.body.appendChild(c);return c},start:function(b,c,d,f){this.field=b;this.ele=c;this.displayValue=this.oldValue=this.ele.value;this.oldInternalValue=this.ele.internalValue;this.vList=d;this.nbrRows=d.length;if(b.columnIndexesToShow){if(b=
b.columnIndexesToShow.split(","),this.colIdx=parseInt(b[0],10),1<b.length)for(this.colIndexes=[],d=0;d<b.length;d++)this.colIndexes.push(parseInt(b[d],10))}else this.colIdx=d.length&&1<d[0].length?1:0;this.ucasedValues=[];this.val=null;this.wrongChars=!1;this.curRow=null;this.position();this.div.removeAttribute(AssistedInputField.ATTR);this.render();f||(this.listener=this.P2.addListener(c,"keydown",this,"keyDowned"));this.oldValue&&this.matchARow(this.oldValue)},position:function(){var b=getDocumentXy(this.ele),
c=this.div.style;c.top=b.y+this.ele.clientHeight-1+"px";c.left=b.x-1+"px";this.div.innerHTML="";this.field.listCss?this.div.className=this.field.listCss:(this.div.className="",c.width=(this.field.listWidth||this.ele.clientWidth)+"px")},end:function(){this.ele.value&&this.displayValue==this.ele.value||(this.ele.value?this.ele.value=this.displayValue:this.displayValue=this.ele.internalValue="");this.P2.removeListener(this.listener);this.div.style.display="none"},keyDowned:function(b){var c=b.keyCode;
if(9!==c)if(27===c||13===c)27===c&&(this.ele.value=this.oldValue,this.ele.internalValue=this.oldInternalValue),b.preventDefault?b.preventDefault():b.returnValue=!1,this.P2.focusNext(this.field,this.ele);else{if(!this.vList.stillFetching)if(38===c)this.moveUpDown(!0,b.shiftKey);else if(40===c)this.moveUpDown(!1,b.shiftKey);else if(48>c||90<c){if(32!==c&&46!==c&&8!==c&&(96>c||111<c))return}else this.matchARow(String.fromCharCode(c));b.preventDefault?b.preventDefault():b.returnValue=!1}},moveUpDown:function(b,
c){this.val=null;c?this.scroll(b):(this.curRow||this.select(null,0),this.select(b?this.curRow&&this.curRow.previousSibling||this.div.lastChild:this.curRow&&this.curRow.nextSibling||this.div.firstChild))},matchARow:function(b){if(this.val){if(this.wrongChars)return;this.val+=b;b=this.curRow}else{this.wrongChars=!1;if(" "==b)return;this.val=b;b=this.curRow&&this.curRow.nextSibling}b||(b=this.div.firstChild);for(var c=+b.getAttribute("idx"),d=c;;){if(d&&d>=this.vList.length){alert(d+" points outside the array of length "+
this.ucasedValues.length);return}var f=this.ucasedValues[d];if(!f)if(f=this.vList[d]&&this.vList[d][this.colIdx])f.toUpperCase||(f=new String(f)),this.ucasedValues[d]=f=f.toUpperCase();else{alert("For i \x3d "+d+" and colIdx "+this.colIdx+" we did not get a value.\n"+this.vList);return}if(0==f.indexOf(this.val)){this.select(b);break}b=b.nextSibling;d++;b||(b=this.div.firstChild,d=0);if(d===c){this.wrongChars=!0;break}}this.timer&&(this.timer.stop(),this.timer=null);this.timer=new TimeBomb(this,"resetValue",
null,500,this.win)},resetValue:function(){this.val=null;this.wrongChars=!1},select:function(b,c){if(b)c=parseInt(b.getAttribute("idx"),10);else if(c||0==c)b=this.div.childNodes[c];this.curRow&&(this.curRow.className="");b?(b.className="selected",this.curRow=b,this.displayValue=this.ele.value=this.vList[c][this.colIdx],this.ele.internalValue=this.vList[c][0]):this.curRow=null;this.ele.focus();this.ele.select&&this.ele.select();if(this.isScrolled&&b){var d=b.offsetTop,f=this.div.scrollTop;d<f?this.div.scrollTop=
d:(d+=b.clientHeight,d>f+this.div.clientHeight&&(this.div.scrollTop=d-this.div.clientHeight))}},rowClicked:function(b){var c=b.target||b.srcElement;3==c.nodeType&&(c=c.parentNode);(c=parseInt(c.getAttribute("idx"),10))||0==c?(b.preventDefault?b.preventDefault():b.returnValue=!1,this.displayValue=this.ele.value=this.vList[c][this.colIdx],this.ele.internalValue=this.vList[c][0],this.P2.focusNext(this.field,this.ele)):debug("Suprising that there was a click on a dom element with no idx attriute. click ignored")},
render:function(){if(this.vList&&this.vList.length){this.nbrRows=this.vList.length;var b=[];if(this.colIndexes){b.push("\x3ctable\x3e\x3ctbody\x3e");for(var c=0;c<this.nbrRows;c++){var d=this.vList[c];b.push("\x3ctr\x3e");for(var f=0;f<this.colIndexes.length;f++)b.push('\x3ctd idx\x3d"'),b.push(c),b.push('"\x3e'),b.push(htmlEscape(d[this.colIndexes])),b.push("\x3c/td\x3e");b.push("\x3c/tr\x3e")}b.push("\x3c/tbody\x3e\x3c/table\x3e")}else for(c=0;c<this.nbrRows;c++)d=this.vList[c][this.colIdx],b.push('\x3cdiv idx\x3d"'),
b.push(c),b.push('" '),b.push('title\x3d"'),b.push(d),b.push('" \x3e'),b.push(htmlEscape(d)),b.push("\x3c/div\x3e");this.field.suggestionCss&&(this.div.className=this.field.suggestionCss);this.div.innerHTML=b.join("")}else this.nbrRows=0,this.div.innerHTML="No valid options.";this.div.style.display="";this.isScrolled=this.div.scrollHeight>this.div.clientHeight?!0:!1},scroll:function(b){if(this.isScrolled){if(b){if(!this.div.scrollTop)return;b=this.div.scrollTop-this.div.clientHeight;0>b&&(b=0)}else if(b=
this.div.scrollTop+this.div.clientHeight,b>this.div.scrollHeight)return;this.div.scrollTop=b}},restart:function(b){this.start(this.field,this.ele,b,!0)}};var SuggestionAssistant=function(b){this.P2=b;b.listDiv||(b.listDiv=this.createListDiv(b.doc));this.div=b.listDiv};
SuggestionAssistant.prototype={createListDiv:ListAssistant.prototype.createListDiv,position:ListAssistant.prototype.position,scroll:ListAssistant.prototype.scroll,start:function(b,c){this.field=b;this.ele=c;this.oldValue=c.value;this.minChars=b.suggestAfterMinChars;this.matchStartingChars=b.matchStartingChars;this.suggestions={};this.lastToken=null;this.position();this.div.setAttribute(AssistedInputField.ATTR,"waiting"+this.minChars);this.div.style.display="";this.listener=this.P2.addListener(c,"keyup",
this,"keyPressed");c.value&&this.filter()},end:function(b,c){this.P2.removeListener(this.listener);this.div.style.display="none"},keyPressed:function(b){if(b){var c=b.keyCode;if(27===c){this.ele.value=this.oldValue;this.P2.focusNext(this.field,this.ele);return}if(38===c||40===c){this.move(38===c,b.shiftKey);b.preventDefault?b.preventDefault():b.returnValue=!1;return}}this.timer=new TimeBomb(this,"filter",null,0,this.win)},filter:function(){if(this.ele){var b=trim(this.ele.value);if(!b||b.length<this.minChars)this.clear(),
this.div.setAttribute(AssistedInputField.ATTR,"waiting"+this.minChars);else{var c=b.substr(0,this.minChars).toUpperCase(),d=this.suggestions[c];d?"fetching"!=d&&(this.lastToken!=c&&(this.lastToken=c,this.vList=d.list,this.uCasedValues=d.uList,this.colIdx=d.idx,this.render()),this.hideAndShow(b),this.div.setAttribute(AssistedInputField.ATTR,this.nbrActiveRows?"active":"noMatch")):(this.suggestions[c]="fetching",this.field.getSuggestions(this.ele,c),this.clear(),this.div.setAttribute(AssistedInputField.ATTR,
"fetching"))}}else debug("filter triggered but ele is null!!. possible bug with the implemented event model.")},setSuggestions:function(b,c,d){if(b!=this.ele)debug(" List recd too late.");else{var f=0,g=[];if(d&&1<d.length){1<d[0].length&&(f=1);for(var h=1;h<d.length;h++)g.push(d[h][f].toUpperCase()),d[h-1]=d[h];d.length--}else d=[];h={};h.list=d;h.idx=f;h.uList=g;this.suggestions[c]=h;b.value&&0==b.value.toUpperCase().indexOf(c)?this.filter(!0):debug("list stored for token "+c+" with "+d.length+
" values")}},render:function(){this.curRow=null;if(this.nbrActiveRows=this.nbrRows=this.vList?this.vList.length:0){for(var b=[],c=0;c<this.nbrRows;c++){var d=this.vList[c][this.colIdx];b.push('\x3cdiv idx\x3d"');b.push(c);b.push('" title\x3d"');b.push(d);b.push('" \x3e');b.push(htmlEscape(d));b.push("\x3c/div\x3e")}this.div.innerHTML=b.join("");this.isScrolled=this.div.scrollHeight>this.div.clientHeight?!0:!1}else this.div.innerHTML="No Sugegstions..",this.div.setAttribute(AssistedInputField.ATTR,
"noMatch");this.div.style.display="";this.div.setAttribute(AssistedInputField.ATTR,"active")},clear:function(){this.nbrRows&&(this.lastValue=null,this.div.innerHTML="")},hideAndShow:function(b){b=b.toUpperCase();if(b!=this.lastValue){this.lastValue&&b.indexOf(this.lastValue);this.lastValue=b;for(var c=this.div.firstChild,d=this.nbrActiveRows=0;d<this.nbrRows;d++){if(!c){this.nbrRows=d;break}c.style||(c=c.nextSibling);c=c.nextSibling}d=this.uCasedValues[d].indexOf(b);b&&(this.matchStartingChars?0!=
d:0>d)?c.style.display="none":(c.style.display="",this.nbrActiveRows++);this.curRow&&(this.curRow.className="",this.curRow=null)}},move:function(b,c){this.val=null;if(c)this.scroll(b);else{this.curRow||this.select(null,0);var d=b?this.getPreviousRow(this.curRow):this.getNextRow(this.curRow);this.select(d)}},getNextRow:function(){for(var b=this.curRow,c=!1;;){if(b)b=b.nextSibling,b.style||(b=b.nextSibling);else{if(c)return null;b=this.div.firstChild;c=!0}if(b&&!b.style.display)return b}},getPrevRow:function(){for(var b=
this.curRow,c=!1;;){if(b)b=b.previousSibling,b.style||(b=b.previousSibling);else{if(c)return null;b=this.div.lastChild;c=!0}if(b&&!b.style.display)return b}},select:function(b,c){if(b)c=parseInt(b.getAttribute("idx"),10);else if(c||0==c)b=this.div.childNodes[c];this.curRow&&(this.curRow.className="");b?(b.className="selected",this.curRow=b,this.displayValue=this.ele.value=this.vList[c][this.colIdx]):this.curRow=null;if(this.isScrolled&&b){var d=b.offsetTop;d<this.div.scrollTop?this.div.scrollTop=
d:(b=this.getNextRow(b))?d>this.div.scrollTop+this.div.clientHeight&&(this.div.scrollTop=d-this.div.clientHeight):this.div.scrollTop=this.div.scrollHeight-this.div.clientHeight}},rowClicked:function(b){var c=b.target||b.srcElement;3==c.nodeType&&(c=c.parentNode);(c=parseInt(c.getAttribute("idx"),10))||0==c?(b.preventDefault?b.preventDefault():b.returnValue=!1,this.displayValue=this.ele.value=this.vList[c][this.colIdx],this.P2.focusNext(this.field,this.ele)):debug("Suprising that there was a click on a dom element with no idx attriute. click ignored")}};
var ChartField=function(){AbstractField.call(this);this.chartType="DEFAULT";this.showLegends=!0;this.yaxislabelformatterid=null;this.colors="#1D7CDC #0A233B #89BD00 #950300 #00ACD0 #492873 #F69035 #72A0E9 #C9271E".split(" ");this.yaxiscolumn=this.xaxiscolumn=null;this.isMultiDataSet=!1;this.groupbycolumn=null};ChartField.prototype=new AbstractField;ChartField.prototype.setLegend=function(b){this.legend=b};ChartField.prototype.getLegend=function(){return this.legend};
ChartField.prototype.setValueToObject=function(b,c){};ChartField.prototype.fillReport=function(b){this.setGrid(b)};
ChartField.prototype.setGrid=function(b){this.value=b;var c=this.P2.win.document.getElementById(this.name);if(c)if(!b||2>b.length)c.innerHTML="",c.setAttribute("data-noData","data-noData"),debug("No data for for chart "+this.name);else{c.removeAttribute("data-noData");c=this.getOptions();b=this.getDataSeries(b,c);if(!this.eventsAssigned){var d=null,d=null;this.onClickFunctionName&&((d=this.P2.win[this.onClickFunctionName])&&"function"==typeof d?this.mouseClicked=d:debug("Onclick function "+this.onClickFunctionName+
" is not defined in user page"));this.onMoveFunctionName&&((d=this.P2.win[this.onMoveFunctionName])&&"function"==typeof d?this.mouseMoved=d:debug("onMoveFunctionName "+this.onMoveFunctionName+" is not defined in user page"));this.eventsAssigned=!0}this.drawChart(b,c)}else debug("Design Error: No dom element found with name "+this.name+" for chart field, and hence no chart is drawn.")};ChartField.prototype.drawChart=function(b,c){alert("Index page for this project has not loaded chart driver. Chart will not be showing-up.")};
ChartField.prototype.getOptions=function(){var b={};this.rawDataDisplay&&"none"!=this.rawDataDisplay&&(b.rawDataDisplay=this.rawDataDisplay);this.colors&&(b.colors=this.colors.split?this.colors.split(","):this.colors);this.labelColor&&(b.labelColor=this.labelColor);b.legend=this.getLegendOptions();this.addSpecialOptions&&this.addSpecialOptions(b);return b};ChartField.prototype.getDataSeries=function(b,c){debug("Design error: getDataSeries is not implemented for chart field "+this.name)};
ChartField.LEGEND_OPTIONS={legendNbrColumns:"noColumns",legendLabelFormatter:"labelFormatter",legendLabelBoxBorderColor:"labelBoxBorderColor",legendPosition:"position",legendContainer:"container",legendMargin:"margin",legendBackgroundColor:"backgroundColor",legendBackgroundOpacity:"backgroundOpacity",legendHighlight:"legendHighlight"};
ChartField.prototype.getLegendOptions=function(){var b={show:!0},c;for(c in ChartField.LEGEND_OPTIONS){var d=this[c];d&&(b[ChartField.LEGEND_OPTIONS[c]]=d)}b.labelFormatter&&((c=this.P2.win[b.labelFormatter])?b.labelFormatter=c:(debug(b.labelFormatter+" is specified as a formatter, but a function with that name is not defined for this page."),delete b.labelFormatter));return b};
ChartField.prototype.getXYSeries=function(b){var c=[],d=b[0];if(2>d.length)return debug("Data for chart "+this.name+" has less than two columns"),c;var f=0,g=1,h=null;if(this.xaxiscolumn||this.yaxiscolumn||this.helpTextColumn)for(var k=0;k<d.length;k++){var l=d[k];l==this.xaxiscolumn?f=k:l==this.yaxiscolumn?g=k:l==this.helpTextColumn&&(h=k)}this.helpTexts=null==h?null:[];for(k=1;k<b.length;k++)d=b[k],c.push([d[f],d[g]]),null!=h&&this.helpTexts.push(d[h]);return c};
ChartField.prototype.getColumnData=function(b,c){var d=this.P2.win,f=new d.Array,g=c.length,h=b[0];this.helpTextColumn&&c.push(this.helpTextColumn);this.groupHelpTextColumn&&c.push(this.groupHelpTextColumn);for(var k=c.length,l=[],m=0;m<k;m++){l[m]=m;var n=c[m];if(n){for(var r=null,q=0;q<h.length;q++)if(n==h[q]){r=q;break}null==r?debug("Column "+n+" is not found in data for chart "+this.name+". Default column is used, and the chart may not render properly"):l[m]=r}}this.helpTexts=n=h=null;this.helpTextColumn&&
(h=l[g],this.helpTexts=[],this.groupHelpTextColumn&&(n=l[g+1]));for(q=1;q<b.length;q++){g=b[q];r=new d.Array;for(m=0;m<k;m++)r.push(g[l[m]]);f.push(r);this.helpTexts&&(n?this.helpTexts.push([g[h],g[n]]):this.helpTexts.push(g[h]))}return f};var PieChart=function(){ChartField.call(this);this.chartType="PIE"};PieChart.prototype=new ChartField;PieChart.prototype.getDataSeries=function(b,c){return this.getColumnData(b,[this.xaxiscolumn,this.yaxiscolumn])};
var BarChart=function(){ChartField.call(this);this.chartType="BAR";this.direction="vertical";this.stacking=!1};BarChart.prototype=new ChartField;BarChart.prototype.getDataSeries=function(b,c){var d=[],d=this.isMultiDataSet?[this.xaxiscolumn,this.yaxiscolumn,this.groupbycolumn]:[this.xaxiscolumn,this.yaxiscolumn];"horizontal"==this.direction&&d.swapItemsByIndex(0,1);return this.getColumnData(b,d)};Array.prototype.swapItemsByIndex=function(b,c){this[b]=this.splice(c,1,this[b])[0];return this};
var LineChart=function(){ChartField.call(this);this.type="LINE"};LineChart.prototype=new ChartField;LineChart.prototype.getDataSeries=function(b,c){var d=[],d=this.isMultiDataSet?[this.xaxiscolumn,this.yaxiscolumn,this.groupbycolumn]:[this.xaxiscolumn,this.yaxiscolumn];return this.getColumnData(b,d)};var BulletChart=function(){ChartField.call(this);this.type="BULLET";this.colors=["#3F81B7","#000000","#CCCCCC","#EEEEEE"]};BulletChart.prototype=new ChartField;
BulletChart.prototype.getDataSeries=function(b,c){return this.getColumnData(b,[this.valueOfInterest,this.comparativeValue,this.firstQualitativeRange,this.secondQualitativeRange,this.bulletlabelcolumn])};var SunBurstChart=function(){ChartField.call(this);this.type="SUNBURST";this.groupHelpTextColumn=this.helpTextColumn=this.corecolumn=this.level1column=this.level2column=this.distributionvaluecolumn=null};SunBurstChart.prototype=new ChartField;
SunBurstChart.prototype.getDataSeries=function(b,c){return this.getColumnData(b,[this.distributionvaluecolumn,this.level2column,this.level1column,this.corecolumn])};var SankeyChart=function(){ChartField.call(this);this.type="SANKEY";this.highlightColor=this.tocolumn=this.fromcolumn=this.distributionvaluecolumn=null};SankeyChart.prototype=new ChartField;SankeyChart.prototype.getDataSeries=function(b,c){return this.getColumnData(b,[this.distributionvaluecolumn,this.fromcolumn,this.tocolumn])};
var SpeedometerChart=function(){ChartField.call(this);this.type="SPEEDOMETER";this.highlightColor=this.tocolumn=this.fromcolumn=this.distributionvaluecolumn=null};SpeedometerChart.prototype=new ChartField;SpeedometerChart.prototype.getDataSeries=function(b,c){return this.getColumnData(b,[this.xaxiscolumn,this.yaxiscolumn])};var ImageField=function(){AbstractField.call(this);this.imageExtension=this.baseSrc=null};ImageField.prototype=new AbstractField;
ImageField.prototype.getValueFromObject=function(b){var c=this.baseSrc.length,d=b.src,f=d.length;this.imageExtension&&(f=this.baseSrc.indexOf(this.imageExtension));d=d.substring(c,f);debug("src was "+b.src+". I returned "+d+" as its value");return d};ImageField.prototype.setValueToObject=function(b,c){b.src=(this.baseSrc||"")+c+(this.imageExtension||"")};var StyleField=function(){AbstractField.call(this);this.defaultCss=this.name};StyleField.prototype=new AbstractField;
StyleField.prototype.getValueFromObject=function(b){return b.getAttribute("data-style")};StyleField.prototype.setValueToObject=function(b,c){b.setAttribute("data-style",c)};var CheckBoxGroupField=function(){AbstractInputField.call(this)};CheckBoxGroupField.prototype=new AbstractInputField;CheckBoxGroupField.prototype.getValue=function(){var b="",c=!0,d;for(d in this.checkedKeys)this.checkedKeys[d]&&(c?(b=d,c=null):b+=","+d);return b};
CheckBoxGroupField.prototype.setGrid=function(b){var c={};this.columnName=b[0][0];var d=b.length;if(1<d)for(var f=1;f<d;f++)c[b[f][0]]=!0;this.checkKeys(c)};CheckBoxGroupField.prototype.setList=function(b){for(var c=b.length,d={},f=0;f<c;f++)d[b[f]]=!0;this.checkKeys(d)};CheckBoxGroupField.prototype.setValue=function(b){this.setList(b.split(","));this.value=b;this.onChangeActionName&&this.P2.act(null,this.name,this.onChangeActionName,this.value)};
CheckBoxGroupField.prototype.checkKeys=function(b){var c=this.P2.doc;if(null==this.keyList)this.checkedKeys=b;else{this.checkedKeys={};for(var d=this.keyList.length,f=0;f<d;f++){var g=this.keyList[f],h=c.getElementById(this.name+"_"+g);b[g]?(h.checked=!0,this.checkedKeys[g]=!0):h.checked=!1}}};
CheckBoxGroupField.prototype.fillDc=function(b){this.keyList||this.buildKeyList();if(this.selectionValueType&&"text"!=this.selectionValueType)if("grid"==this.selectionValueType){var c=[];c.push([this.columnName||this.name]);for(var d=0;d<this.keyList.length;d++){var f=this.keyList[d];this.checkedKeys[f]&&c.push([f])}b.grids[this.name]=c}else if("list"==this.selectionValueType){c=[];for(f in this.checkedKeys)this.checkedKeys[f]&&c.push(f);b.lists[this.name]=c}else b.values[this.name]=this.getValue();
else b.values[this.name]=this.getValue()};CheckBoxGroupField.prototype.buildKeyList=function(){this.keyList=[];this.checkedKeys={};var b=this.P2.doc.getElementById(this.name);if(b){b=b.getElementsByTagName("input");debug("Going to check "+b.length+" check boxes ");for(var c=0;c<b.length;c++){var d=b[c],f=d.value;this.keyList.push(f);this.checkedKeys[f]=d.checked}}else debug("Design Error: No dom element found for check box group field "+this.name)};
CheckBoxGroupField.prototype.fillList=function(b,c){c||(c=this.obj);c.innerHTML="";var d=this.checkedKeys;this.checkedKeys={};this.keyList=[];if(b&&!(1>=b.length)){for(var f=b.length,g=[],h=1;h<f;h++){var k=b[h],l=k[0];this.keyList.push(l);var m=this.name+"_"+l;g.push('\x3cinput type\x3d"checkbox" id\x3d"');g.push(m);g.push('" value\x3d"');g.push(l);g.push('" onchange\x3d"P2.checkBoxGroupChanged(this, \'');g.push(this.name);g.push("');\" ");d&&d[l]&&(this.checkedKeys[l]=!0,g.push(' checked\x3d"checked"'));
g.push('/\x3e\x3clabel for\x3d"');g.push(m);g.push('"\x3e');g.push(k[1]||k[0]);g.push("\x3c/label\x3e\x3cbr /\x3e")}c.innerHTML=g.join("")}};
CheckBoxGroupField.prototype.changed=function(b){this.keyList||this.buildKeyList();if(this.minSelections||this.maxSelections){var c=0,d;for(d in this.checkedKeys)this.checkedKeys[d]&&c++;d=!1;b.checked?this.maxSelections&&c>=this.maxSelections&&(d=!0):this.minSelections&&c<=this.minSelections&&(d=!0);if(d){b.checked=b.checked?!1:!0;c="";this.minSelections&&(c=" A minimum of "+this.minSelections+" selections ");this.maxSelections&&(c=(c?c+" and a ":"A ")+" maximum of "+this.maxSelections);c+=" selections expected for "+
this.label;c=new ExilityError(c);c.field=this;c.obj=b;this.P2.catchError(e);return}}this.checkedKeys[b.value]=b.checked;this.value=this.getValueFromObject(b);this.onChangeActionName&&(debug("on change triggered for "+this.name+" onchange \x3d "+this.onChangeActionName),this.P2.act(b,this.name,this.onChangeActionName,this.value))};
CheckBoxGroupField.prototype.callListService=function(b,c){var d=[];d.push(["serviceId","keyValue"]);d.push([this.listServiceId,b]);this.P2.callListService(d,c,this.name,this.listServiceQueryFieldNames,this.listServiceQueryFieldSources)};CheckBoxGroupField.prototype.able=function(b,c){var d=this.P2.doc.getElementById(this.name+"_"+b);d?d.disabled=!c:debug(this.name+' does not have "'+b+'" as an option. A user code is seeking to enable/disable this')};
CheckBoxGroupField.prototype.select=function(b,c){var d=this.P2.doc.getElementById(this.name+"_"+b);d?(d.checked=c?!0:!1,this.changed(d)):debug(this.name+' does not have "'+b+'" as an option. A user code is seeking to enable/disable this')};
CheckBoxGroupField.prototype.setValueToObject=function(b,c){if(b)if(c){var d=c.toUpperCase();if(c==b.value||c==this.checkedValue||"1"==c||"Y"==d||"YES"==d||"TRUE"==d)b.checked=!0;else if(d=c.split("|"),1>=d.length&&(d=c.split(",")),1>=d.length)b.checked=!1;else if((d=b.getElementsByTagName("input"))&&d.length)for(var f=0;f<d.length;f++){for(var g=d[f],h=!1,k=0;k<c.length;k++)if(c[k]==g.value){h=!0;break}g.checked=h}else debug("Design error: CheckBoxGroupField is not rendered properly.")}else b.checked=
!1;else debug("Design Error: CheckBoxGroupField.setValueToObject() called with invalid element for field "+this.name)};CheckBoxGroupField.prototype.getValueFromObject=function(b){var c="",d=b&&b.parentNode&&b.parentNode.childNodes;if(!d||!d.length)return c;for(var f=0;f<d.length;f++)b=d[f],b.type&&"CHECKBOX"==b.type.toUpperCase()&&b.checked&&(c=""==c?b.value:c+("|"+b.value));return c};var ShadeOutputField=function(){AbstractField.call(this);this.bgcolor="white"};ShadeOutputField.prototype=new AbstractField;
ShadeOutputField.prototype.setValueToObject=function(b,c){if(b){var d="",d=0==c.length?this.bgcolor:c;b.style.backgroundColor=d}else debug("ERROR: null object passed to set value to object obj\x3d"+b+" and val \x3d "+c)};var ShadeInputField=function(){AbstractField.call(this);this.bgcolor="white"};ShadeInputField.prototype=new AbstractField;
ShadeInputField.prototype.setValueToObject=function(b,c){b?b.style.backgroundColor=c||"white":debug("ERROR: null object passed to set value to object ele\x3d"+b+" and val \x3d "+c)};ShadeInputField.prototype.getValueFromObject=function(b){return b.style.backgroundColor};var XmlTreeField=function(){AbstractField.call(this);this.treeStr=""};XmlTreeField.prototype=new AbstractField;
XmlTreeField.prototype.setValueToObject=function(b,c){if(b){var d;d=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Msxml2.XMLHTTP.6.0");try{d.open("GET",c,!1),d.send(null)}catch(f){message("Application is unable to process your request because network connection is not available. Please establish Network connection and try again.","","Ok",null,null,null);return}var g=null;d=d.responseText;try{g=new ActiveXObject("Microsoft.XMLDOM"),g.async="false",g.loadXML(d)}catch(h){try{parser=
new DOMParser,g=parser.parseFromString(d,"text/xml")}catch(k){alert(k.message)}}g.documentElement&&g.documentElement.firstChild?(d=['\x3cul class\x3d"rootnode"\x3e'],this.buildTree(d,g.documentElement,"/",this.showValues),d.push("\n\x3c/ul\x3e"),d=d.join(""),b.innerHTML=d,this.rootNode=b.childNodes[0].childNodes[0],this.expandAllOnLoad&&this.changeVisibility(this.rootNode,!0,!0)):alert("Error loading contents of url "+url+" as an XML. The file may have syntax errors.\n XML tree view will not be loaded.")}else debug("ERROR: null object passed to set value to object obj\x3d"+
b+" and val \x3d "+c)};
XmlTreeField.prototype.buildTree=function(b,c,d,f){var g,h;if(c.nodeType==Node.ELEMENT_NODE){var k=c.nodeName;g=k.indexOf(":");0<=g&&(g++,k=k.substring(g,k.length-g));var k=d+k,l=c.childNodes,m=c.attributes;if(0==m.length&&(0==l.length||1==l.length&&l[0].nodeType==Node.TEXT_NODE)){if(this.childHtmlAttributes){b.push("\n\x3cli ");h=this.childHtmlAttributes.split("); ");for(var n=0;n<h.length;n++){g=h[n].split("\x3d");if(2>g.length)break;g[1].match(/\);/)?b.push(g[0]+'\x3d"'+g[1]+'" '):b.push(g[0]+
'\x3d"'+g[1]+');" ')}b.push(' id\x3d"'+k+'" \x3e')}else b.push('\n\x3cli id\x3d"'+k+'" \x3e');b.push(c.nodeName);f&&c.firstChild&&(c=c.firstChild.nodeValue)&&b.push("\x3d\x26quot;"+c+"\x26quot;");b.push("\x3c/li\x3e")}else{b.push('\n\x3cli id\x3d"'+k+'" ');if(this.childHtmlAttributes)for(b.push("\n\x3cli "),h=this.childHtmlAttributes.split("); "),n=0;n<h.length;n++){g=h[n].split("\x3d");if(2>g.length)break;g[1].match(/\);/)?b.push(g[0]+'\x3d"'+g[1]+'" '):b.push(g[0]+'\x3d"'+g[1]+');" ')}b.push("onclick\x3d\"P2.xmlNodeClicked(this, '"+
this.name+"');\"\x3e");b.push('\x3cimg border\x3d"0" src\x3d"../../exilityImages/plus.gif" style\x3d"cursor:pointer;vertical-align:middle;"\x3e');b.push(c.nodeName);b.push("\x3c/li\x3e");b.push('\n\x3cul style\x3d"display: none;"\x3e');for(var r=0;r<m.length;r++){var q=m[r];b.push("\n\x3cli ");if(this.childHtmlAttributes)for(h=this.childHtmlAttributes.split("); "),n=0;n<h.length;n++){g=h[n].split("\x3d");if(2>g.length)break;g[1].match(/\);/)?b.push(g[0]+'\x3d"'+g[1]+'" '):b.push(g[0]+'\x3d"'+g[1]+
');" ')}b.push(' id\x3d"'+k+"/"+q.name+'"\x3e');b.push(q.name);f&&b.push("\x3d\x26quot;"+q.value+"\x26quot;");b.push("\x3c/li\x3e")}d+=c.nodeName+"/";for(r=0;r<l.length;r++)this.buildTree(b,l[r],d,f);b.push("\n\x3c/ul\x3e")}}};
XmlTreeField.prototype.changeVisibility=function(b,c,d){b||(b=this.rootNode);b&&3==b.nodeType&&(b=b.nextSibling);if(b){var f=b.nextSibling;f&&3==f.nodeType&&(f=f.nextSibling);if(f&&"UL"==f.nodeName){b=b.firstChild;3==b.nodeType&&(b=b.nextSibling);if(0<=b.src.indexOf("plus")){if(null==c||c)f.style.display="",b.src=b.src.replace("plus","minus")}else c||(f.style.display="none",b.src=b.src.replace("minus","plus"));if(d)for(d=f.childNodes,f=0;f<d.length;f++)this.changeVisibility(d[f],c,!0)}}};
XmlTreeField.prototype.setGrid=function(b){var c,d,f;if(menuHolder=this.P2.doc.getElementById(this.name)){var g=!1;c=[];this.childHtmlAttributes&&(g=!0,c=this.childHtmlAttributes.split("); "));var h=this.P2.doc.createElement("ul");h.setAttribute("class","rootnode");h.setAttribute("id","0");menuHolder.appendChild(h);for(h=1;h<b.length;h++){var k=b[h][0];d=b[h][1];var l=b[h][2];f=b[h][3];var m=b[h][4];if(0==k)if("y"==f||"Y"==f){f=this.P2.doc.createElement("li");f.setAttribute("id",d);f.setAttribute("onclick",
"P2.xmlNodeClicked(this, '"+this.name+"');menuNavigateToPage('"+m+"');");if(g)for(m=0;m<c.length;m++){d=c[m].split("\x3d");if(2>d.length)break;d[1].match(/\);/)?f.setAttribute(d[0],d[1]):f.setAttribute(d[0],d[1]+");")}f.innerHTML='\x3cimg border\x3d"0" src\x3d"../../exilityImages/plus.gif" style\x3d"cursor:pointer;vertical-align:middle;"\x3e'+l;l=this.P2.doc.createElement("ul");l.style.display="none";this.P2.doc.getElementById(k).appendChild(f);this.P2.doc.getElementById(k).appendChild(l)}else{f=
this.P2.doc.createElement("li");f.setAttribute("id",d);f.setAttribute("onclick","menuNavigateToPage('"+m+"');");if(g)for(m=0;m<c.length;m++){d=c[m].split("\x3d");if(2>d.length)break;d[1].match(/\);/)?f.setAttribute(d[0],d[1]):f.setAttribute(d[0],d[1]+");")}f.innerHTML=l;this.P2.doc.getElementById(k).appendChild(f)}else if("y"==f||"Y"==f){f=this.P2.doc.createElement("li");f.setAttribute("id",d);f.setAttribute("onclick","P2.xmlNodeClicked(this, '"+this.name+"');menuNavigateToPage('"+m+"');");if(g)for(m=
0;m<c.length;m++){d=c[m].split("\x3d");if(2>d.length)break;d[1].match(/\);/)?f.setAttribute(d[0],d[1]):f.setAttribute(d[0],d[1]+");")}f.innerHTML='\x3cimg border\x3d"0" src\x3d"../../exilityImages/plus.gif" style\x3d"cursor:pointer;vertical-align:middle;"\x3e'+l;l=this.P2.doc.createElement("ul");l.style.display="none";this.P2.doc.getElementById(k).nextSibling.appendChild(f);this.P2.doc.getElementById(k).nextSibling.appendChild(l)}else{f=this.P2.doc.createElement("li");f.setAttribute("id",d);f.setAttribute("onclick",
"menuNavigateToPage('"+m+"');");if(g)for(m=0;m<c.length;m++){d=c[m].split("\x3d");if(2>d.length)break;d[1].match(/\);/)?f.setAttribute(d[0],d[1]):f.setAttribute(d[0],d[1]+");")}f.innerHTML=l;this.P2.doc.getElementById(k).nextSibling.appendChild(f)}}b=menuHolder.innerHTML;menuHolder.innerHTML="";menuHolder.innerHTML=b;this.rootNode=menuHolder.childNodes[0].childNodes[0]}this.expandAllOnLoad&&this.changeVisibility(this.rootNode,!0,!0)};var AbstractAction=function(){};
AbstractAction.prototype.act=function(b,c,d){message("Design Error : A concrete class of AbstractAction has not implemented the required method act(win, obj, params)","Error","Ok",null,null,null);return!1};AbstractAction.prototype.getQryString=function(){for(var b="",c=this.queryFieldSources||this.queryFieldNames,d=0;d<this.queryFieldNames.length;d++)b+="\x26"+this.queryFieldNames[d]+"\x3d"+this.P2.getFieldValue(c[d]);return b};
AbstractAction.prototype.executeFunction=function(b,c,d,f){if(0<b.indexOf("("))eval("this.P2.win."+b);else{var g=this.P2.win[b];if(g)g(c,d,f);else{debug(b+" is not defined as a function at window level. trying it as a method of an object..");try{eval(b+"()")}catch(h){try{this.P2.win.eval(b+"()")}catch(k){alert(b+" is neither a function, nor a method of an object. local function not executed.")}}}}};var DummyAction=function(){AbstractAction.call(this);this.warnIfFormIsModified=!1};
DummyAction.prototype=new AbstractAction;DummyAction.prototype.act=function(){};var ResetAction=function(){AbstractAction.call(this);this.resetFormModifiedState=!0};ResetAction.prototype=new AbstractAction;ResetAction.prototype.act=function(){if(this.fieldsToReset)return"all"==this.fieldsToReset[0]?this.P2.resetAllFields():this.P2.resetFields(this.fieldsToReset),!0;this.P2.win.location.reload(!0);return!0};var CloseAction=function(){AbstractAction.call(this);this.warnIfFormIsModified=!0};
CloseAction.prototype=new AbstractAction;CloseAction.prototype.act=function(b,c,d){var f=this.P2.win.currentP2;if(f&&f.pendingPicker)return f.codePickerReturned(null),!0;this.functionName&&this.executeFunction(this.functionName,b,c,d);if(window.messageBtnAction1)window.messageButtonClicked(null);else if(this.P2.error)return!1;exilityPageStack.goBack(this.P2.win);return!0};var LocalAction=function(){AbstractAction.call(this)};LocalAction.prototype=new AbstractAction;
LocalAction.prototype.act=function(b,c,d){d||(d=this.parameter);if(this.functionName)return this.executeFunction(this.functionName,b,c,d),this.fieldToFocusAfterExecution&&(b=this.P2.doc.getElementById(this.fieldToFocusAfterExecution))&&b.focus&&b.focus(),!0;debug("local action "+this.name+" has no functionName. It is acting as a dummy function.");return!0};var NavigationAction=function(){AbstractAction.call(this);this.windowDisposal=this.REPLACE;this.toBeReported=!0};NavigationAction.prototype=new AbstractAction;
NavigationAction.REPLACE="replace";NavigationAction.POPUP="popup";NavigationAction.RETAIN_STATE="retainState";NavigationAction.RESET="reset";NavigationAction.MENU_RESET="menuReset";NavigationAction.TOKEN_TO_SUBSTITUTE="#value#";
NavigationAction.prototype.act=function(b,c,d){b=this.pageToGo;null!=this.substituteValueFrom&&(b=b.replace(NavigationAction.TOKEN_TO_SUBSTITUTE,this.P2.getFieldValue(this.substituteValueFrom)));if(this.queryFieldNames||this.serviceId){c=null;this.queryFieldNames&&(c=this.P2.makeQueryString(this.queryFieldNames,this.queryFieldSources,null,this.validateQueryFields));if(!c)return;this.serviceId&&(c=0>=this.queryFieldNames.length?"serviceId\x3d"+this.serviceId:c+("\x26serviceId\x3d"+this.serviceId));
null!=exilityTraceWindow&&(c+="\x26exilityServerTrace\x3d1");b+="?"+c}this.passDc&&(window.passedDc=d&&d.dc?d.dc:this.getDc());d=this.P2.win;if(this.windowToGo){d=window.frames[this.windowToGo];if(!d)return message(this.windowToGo+" is not a name of a frame. ","Warning","Ok",null,null,null),!1;this.pageToGo?exilityPageStack.goTo(d,NavigationAction.REPLACE,b):d.focus();return!0}exilityPageStack.goTo(d,this.windowDisposal,b,null,this.windowName)};
NavigationAction.prototype.getDc=function(){var b=new DataCollection;if(this.queryFieldNames&&!this.P2.fillDcFromQueryFields(b,this.queryFieldNames,this.queryFieldSources,null,this.validateQueryFields))return null;this.P2.addPageSizes(b);if(this.fieldsToSubmit){if(!this.P2.validate(this.fieldsToSubmit,this.tablesToSubmit))return null;this.P2.fillDcFromForm(b,this.fieldsToSubmit,this.tablesToSubmit,this.sendAllFields)}else if(this.passDc){if(!this.P2.validate())return null;if(this.atLeastOneFieldIsRequired&&
0==this.P2.countEnteredFields())return(new ExilityError("At least one field must have some value")).render(),null;this.P2.fillDcFromForm(b)}return b};var ServerAction=function(){AbstractAction.call(this);this.toRefreshPage=ServerAction.BEFORE;this.toBeReported=!0};ServerAction.prototype=new AbstractAction;ServerAction.BEFORE="beforeMyAction";ServerAction.AFTER="afterMyAction";ServerAction.NONE="none";
ServerAction.prototype.act=function(b,c,d,f){this.disableForm&&coverPage(coverPickerStyle,imgPickerStyle,imgMainPrgIndStyle);d=this.getDc();if(!d)return this.disableForm&&uncoverPage(coverPickerStyle,imgPickerStyle,imgMainPrgIndStyle),debug("error: form validation failed"),!1;b=new ServiceEntry(this.serviceId,d,this.waitForResponse,this.callBackActionName,b,c,this.toRefreshPage,this.disableForm,this.showPage,this.fieldToFocusAfterExecution,f,this.callBackEvenOnError);this.showPage=null;this.P2.win.serverStub.callService(b);
return!0};
ServerAction.prototype.getDc=function(){var b=new DataCollection;if(this.queryFieldNames&&!this.P2.fillDcFromQueryFields(b,this.queryFieldNames,this.queryFieldSources,null,this.validateQueryFields))return null;this.P2.addPageSizes(b);if(this.fieldsToSubmit){if(!this.P2.validate(this.fieldsToSubmit,this.tablesToSubmit))return null;this.P2.fillDcFromForm(b,this.fieldsToSubmit,this.tablesToSubmit,this.sendAllFields)}else if(this.submitForm){if(!this.P2.validate())return null;if(this.atLeastOneFieldIsRequired&&0==
this.P2.countEnteredFields())return(new ExilityError("At least one field must have some value")).render(),null;this.P2.fillDcFromForm(b)}return b};ServerAction.prototype.resetFieldsToSubmit=function(b){this.sendAllFields=!0;this.fieldsToSubmit={};for(var c=0;c<b.length;c++)this.fieldsToSubmit[b[c]]=!0};var MailToAction=function(){AbstractAction.call(this)};MailToAction.prototype=new AbstractAction;
MailToAction.prototype.act=function(b,c,d){b=this.mailTo;if(!b)return debug("no address specified for mailTo action"),!1;this.substituteValueFrom&&(b=b.replace("#value#",this.P2.getFieldValue(this.substituteValueFrom)));window.open("mailto:"+b);return!0};var FileAction=function(){ServerAction.call(this)};FileAction.prototype=new ServerAction;
FileAction.prototype.act=function(){var b=this.getDc();if(!b)return!1;b.values.serviceId=this.serviceId;b.values[ClientConstants.CSRF_HEADER]=getCsrfToken();this.formSubmit(b);return!0};
FileAction.prototype.formSubmit=function(b){if(this.submitInNewWindow){var c=window.open("_blank");if(!c)return alert("Pop-up blocker is preventing us from opening a new window for file upload"),!1;c=c.document;c.write('\x3cbody onload\x3d"document.forms[0].submit();"\x3e\x3cspan\x3eContacting the server... Please wait....\x3c/span\x3e\x3cform method\x3d"post" accept-charset\x3d"UTF-8" enctype\x3d"multipart/form-data" action\x3d"'+htmlRootPath+this.serverResource+'"\x3e');for(var d in b.values){var f=
b.values[d],g=this.P2.getField(d);g&&g.isFileField?c.write('\x3cinput type\x3d"file" name\x3d"'+d+'" value\x3d"'+f+'"/\x3e'):f&&c.write('\x3cinput type\x3d"hidden" name\x3d"'+d+'" value\x3d"'+f+'"/\x3e')}c.write("\x3c/form\x3e\x3c/body\x3e");c.close()}else{var c=this.P2.doc,h=c.createElement("FORM");h.acceptCharset="UTF-8";c.body.appendChild(h);for(d in b.values){var f=b.values[d],k=!1;(g=this.P2.getField(d))&&g.constructor==FileField&&(k=!0);k?(g=c.createElement("INPUT"),g.type="file",g.name=d,g.value=
f,h.appendChild(g)):f&&(g=c.createElement("INPUT"),g.type="hidden",g.name=d,g.value=f,h.appendChild(g))}h.encType="multipart/form-data";h.action=htmlRootPath+this.serverResource;h.method="POST";h.submit();c.body.removeChild(h)}};window.serverPlatform||(window.serverPlatform="jsp");var DownloadFileAction=function(){FileAction.call(this);this.serverResource="../exilityClient/"+serverPlatform+"/DownloadFile."+serverPlatform};DownloadFileAction.prototype=new FileAction;
var UploadFileAction=function(){FileAction.call(this);this.serverResource="../exilityClient/"+serverPlatform+"/UploadFile."+serverPlatform};UploadFileAction.prototype=new FileAction;
UploadFileAction.prototype.act=function(){var b=this.getDc();if(!b)return!1;b.values.serviceId=this.serviceId;b.values[ClientConstants.CSRF_HEADER]=getCsrfToken();var c=this.P2.doc,d=!1,f;for(f in b.values){var g=!1,h=this.P2.getField(f);h&&(h=h.constructor,h==FileField&&(g=!0));g&&(d=!0,c.getElementById(f).name=f)}if(d)f=c.getElementById("form1"),f.acceptCharset="UTF-8",h=c.createElement("INPUT"),h.type="hidden",h.name="dc",h.value=this.P2.win.serverStub.serializeDc(b),f.appendChild(h),h=c.createElement("INPUT"),
h.type="hidden",h.name="baseHTMLFolderName",h.value=exilParms.baseHTMLFolderName,f.appendChild(h),f.encoding="multipart/form-data",this.P2.doc.onload="uploadFileReturned(true)",f.action=htmlRootPath+this.serverResource,f.method="POST",f.submit();else{var k=g=d=null,l=!1;for(f in b.grids){for(var m=b.grids[f],n=0;n<m[0].length;n++)if(h=this.P2.getField(f+"_"+m[0][n]))if(h=h.constructor,h==FileField){l=!0;d=f;g=m[0][n];k=n;break}if(l)break}l&&(PM.fileUploadData=[],PM.fileUploadData.fileDataGrid=b.grids[d],
PM.fileUploadData.gridNameContainingFile=d,PM.fileUploadData.gridColumnContainingFile=g,PM.fileUploadData.gridColumnFileIndex=k,PM.fileUploadData.noOfFilesToUpload=b.grids[d].length-1,PM.fileUploadData.currentFileToUpload=1,PM.fileUploadData.doc=c,PM.fileUploadData.P2=this.P2,PM.fileUploadData.serverResource=this.serverResource,b.grids[d]=null,PM.fileUploadData.dc=b,PM.fileUploaded=!1,uploadFiles())}return!0};
function uploadFiles(){var b=PM.fileUploadData.fileDataGrid,c=PM.fileUploadData.dc,d=PM.fileUploadData.gridNameContainingFile,f=PM.fileUploadData.gridColumnContainingFile,g=PM.fileUploadData.gridColumnFileIndex;PM.debug("Grid : "+b);PM.debug("dc : "+c);PM.debug("gridNameContainingFile : "+d);PM.debug("gridColumnContainingFile"+f);PM.debug("gridColumnFileIndex : "+g);var h=PM.fileUploadData.doc,k=h.createElement("DIV");k.id="exilFileUploadDiv";k.style.display="none";h.body.appendChild(k);var l=h.createElement("FORM");
l.acceptCharset="UTF-8";k.appendChild(l);for(k=1;k<b.length;k++){var m=k;if(""!=b[m][g]){h.getElementById(d+"_"+f+"__"+m).name=f;var n=h.getElementById(d+"_"+f+"__"+m);l.appendChild(n);n=h.createElement("INPUT");n.type="hidden";n.name="REMARK_"+m;n.value=b[m][g+1];l.appendChild(n)}}b=h.createElement("INPUT");b.type="hidden";b.name="dc";b.value=doSerialize(c);l.appendChild(b);c=h.createElement("IFRAME");c.name="exilFileUploadFrame";c.src="";c.onload="uploadFileReturned()";l.appendChild(c);l.encoding=
"multipart/form-data";l.action=htmlRootPath+PM.fileUploadData.serverResource;l.method="POST";l.target="exilFileUploadFrame";l.submit()}function uploadFileReturned(b){"undefined"==typeof dc?PM.currentActiveWindow.P2.act(null,null,"callBack"):(dc.success||parent.message("Error while uploading the file. Please try again","","Ok",null,null,null),b&&parent.PM.exilityPageStack.goBack())}
var ReportAction=function(){ServerAction.call(this);this.reportName=null;this.serverResource="../"+serverPlatform+"/ShowReport."+serverPlatform;this.submitInNewWindow=!1};ReportAction.prototype=new ServerAction;function checkFileDownloadCookie(){""!=top.getCookie("fileDownloaded")?uncoverPage(coverPickerStyle):setTimeout("checkFileDownloadCookie();",100)}
ReportAction.prototype.act=function(){var b=this.getDc();if(!b)return!1;this.submitInNewWindow||(coverPage(coverPickerStyle,imgPickerStyle),""!=top.getCookie("fileDownloaded")&&top.removeCookie("fileDownloaded"),setTimeout("checkFileDownloadCookie();",100));b.values.reportName=this.reportName;b.values.serviceId=this.serviceId;var c=this.P2.doc,d=c.createElement("FORM");d.acceptCharset="UTF-8";this.submitInNewWindow?c.body.appendChild(d):top.exilReportFrame.document.body.appendChild(d);var f=c.createElement("INPUT");
f.type="hidden";f.name="dc";f.value=this.P2.win.serverStub.serializeDc(b);d.appendChild(f);d.encoding="multipart/form-data";d.action=htmlRootPath+this.serverResource;d.method="POST";d.target=this.submitInNewWindow?"_blank":"_self";d.submit();this.submitInNewWindow?c.body.removeChild(d):top.exilReportFrame.document.body.removeChild(d);return!0};var SaveAsXlsAction=function(){ReportAction.call(this);this.reportName=null;this.serverResource="../"+serverPlatform+"/DownloadXLS."+serverPlatform};
SaveAsXlsAction.prototype=new ReportAction;var rowType={none:"none",first:"first",current:"current",next:"next",last:"last"},AbstractTable=function(){this.P2=this.name=null;this.columns={};this.columnNames=[];this.grid=[[]];this.nbrRows=this.nbrColumns=this.currentRow=0};
AbstractTable.prototype.addColumn=function(b){var c=this.nbrColumns;b.columnIdx=c;b.table=this;var d=b.unqualifiedName;this.columnNames.push(d);this.columns[d]=b;this.grid[0][c]=b.value;this.hasSingleRow&&(this.grid[1][c]=b.value);this.nbrColumns++;b.rowSum&&(this.rowSumIndexes||(this.rowSumIndexes=[]),this.rowSumIndexes.push(c),this.hasAggregates=!0);b.rowAverage&&(this.rowAverageIndexes||(this.rowAverageIndexes=[]),this.rowAverageIndexes.push(c),this.hasAggregates=!0);b.columnSum&&(this.columnSumIndexes||
(this.columnSumIndexes=[]),this.columnSumIndexes.push(b),this.hasAggregates=!0);b.columnAverage&&(this.columnAverageIndexes||(this.columnAverageIndexes=[]),this.columnAverageIndexes.push(b),this.hasAggregates=!0)};AbstractTable.prototype.getValue=function(b,c,d){c||(c=this.currentRow);c=this.grid[c];return!c||c.isDeleted&&!d?"":c[b]};
AbstractTable.prototype.getColumnValue=function(b,c,d){c||(c=this.currentRow);c=this.grid[c];if(!c||c.isDeleted&&!d)return"";d=this.columns[b];return d?c[d.colIdx]:(debug(b+" is not a column in table "+this.name),"")};AbstractTable.prototype.setColumnValue=function(b,c,d){var f=this.columns[b];f?f.setValue(c,null,d):debug(b+" is not a column in table "+this.name+". Value "+c+" not set.")};
AbstractTable.prototype.saveValue=function(b,c,d,f){d||(d=this.currentRow,d>=this.grid.length&&(d=0));var g=this.grid[d];if(!g)return debug(this.name+" does not have row "+d+" and hence can not save value of "+b+" to column no "+c),null;var h=g[c];if(h!==b)return g[c]=b,this.quickSearchEle&&this.quickSearchRebuildRow(d),this.linkedTable&&(c=this.linkedColumns[c],null!=c&&(c.setValue(b,null,this.currentLinkedRow),f||this.linkedTable.rowChanged(null,null,this.currentLinkedRow))),h};
AbstractTable.prototype.validateColumn=function(b,c){if(!this.linkedTable){var d=dataTypes[b.dataType];d||debug("field "+b.name+" has a dataType \x3d "+b.dataType+". This is not a valid dataType. Validation skipped.");var f=b.columnIdx,g,h,k,l,m,n=this.P2.doc,r=null,q=null,t=b;this.linkedDisplayTable&&(r=this.P2.getField(this.linkedDisplayTable.name+"_"+b.unqualifiedName))&&(t=r,q=this);for(m=1;m<this.grid.length;m++)if(k=this.grid[m],null!=k&&!k.isDeleted&&(!this.keyFieldName||k[this.keyIdx]||this.idFieldName&&
k[this.idIdx]&&!k.keyIsGenerated)&&(!c||k.changedByUser)){h=k[f];this.currentRow=m;try{l=t.validateValue(h,d,!0,q),l!=h&&(g=n.getElementById(this.getObjectId(b.name,m)),b.setValueToObject(g,l),k[f]=l)}catch(s){r?(s.obj=n.getElementById(r.name),s.field=r,this.clicked()):(s.obj=n.getElementById(this.getObjectId(b.name,m)),s.field=b);if(exilParms.stopAtFirstError)throw s;s.render(s.obj)}}}};
AbstractTable.prototype.initRepeatingPanel=function(){this.addedElements=[];this.repeatedPanels={};this.nbrRepeatedPanels=0;var b=this.P2.doc,c=this.repeatingPanelName||this.panelName,d=b.getElementById(c+"TabsDiv");if(d){var f=b.getElementById(c+"Tab");this.tabLabelParent=f.parentNode;this.tabLabelEle=this.tabLabelParent.removeChild(f);f=b.getElementById(c+"TabLeft");this.tabLabelParentLeft=f.parentNode;this.tabLabelEleLeft=this.tabLabelParentLeft.removeChild(f);f=b.getElementById(c+"TabRight");
this.tabLabelParentRight=f.parentNode;this.tabLabelEleRight=this.tabLabelParentRight.removeChild(f)}else if(c=this.panelName+"Top",d=b.getElementById(c),!d){message("Design error: "+this.name+"is being repeated, but its top panel with name \x3d "+c+" is not found in dom","Error","Ok",null,null,null);return}this.panelToClone=d;this.parentPanel=b=d.parentNode;this.siblingElement=d.nextSibling;b.removeChild(d);debug("I got "+this.panelToClone.id+" as the panel to be removed from the dom with parentEle \x3d "+
b.id)};
AbstractTable.prototype.cloneAndAddPanel=function(b,c,d,f){debug("going to repeat "+(this.repeatingPanelName||this.panelName)+" for key \x3d "+b+" and label \x3d "+c);c||(c=b);var g=this.P2.doc,h=this.panelToClone.cloneNode(!0);h.id+=b;this.addedElements.push(h);if(this.mergeWithTable)return this.stubNameForMerging?(f=this.stubNameForMerging,b&&(f+=b),(g=g.getElementById(f))?g.appendChild(h):debug(this.name+" table has row with key "+b+" but the linked table "+this.mergeWithTableName+" does not have a row with that key.")):this.mergeWithTable.mergeChildPanel(h,
this.mergeOnColumnName,b),h;this.siblingElement?this.parentPanel.insertBefore(h,this.siblingElement):this.parentPanel.appendChild(h);var k=g.getElementById(this.panelName+"Slider");k&&(k.id+=b,k.setAttribute("key",b));var l,m,n;this.tabLabelEle&&(l=this.panelName+b+"Tab",m=this.panelName+b+"TabLeft",n=this.panelName+b+"TabRight",k=this.tabLabelEle.cloneNode(!0),k.id=l,panelLeft=this.tabLabelEleLeft.cloneNode(!0),panelLeft.id=m,panelRight=this.tabLabelEleRight.cloneNode(!0),panelRight.id=n,this.tabLabelParentLeft.appendChild(panelLeft),
this.tabLabelParent.appendChild(k),this.tabLabelParentRight.appendChild(panelRight),m=k.getAttribute("tabcontainername"),0==this.nbrRepeatedPanels?(this.P2.win[m+"ActiveTabName"]=l,this.P2.win[m+"ActivePanelName"]=h.id,h.style.display=""):(k.className="passivetablabel",h.style.display="none"),this.addedElements.push(k),this.addedElements.push(panelLeft),this.addedElements.push(panelRight),k.onclick=this.P2.win.getTabFunction(h.id,m),k.innerHTML=c);l=this.panelName+"Label";if(k=g.getElementById(l))k.innerHTML=
c,k.id=l+b;l=this.panelName+"Twister";if(k=g.getElementById(l))k.id=l+b,k.onclick=this.P2.win.getTwisterFunction(this.panelName+b);if(!k&&f){if(c=g.getElementById(d))d=c.parentNode.id,c=g.getElementById(d),c.id=d+b;if(c=g.getElementById(d+"Twister"))c.id=d+"Twister"+b,c.onclick=this.P2.win.getTwisterFunction(d+b);if(d=g.getElementById(f))f=d.parentNode.id,d=g.getElementById(f),d.id=f+b;if(d=g.getElementById(f+"Twister"))d.id=f+"Twister"+b,d.onclick=this.P2.win.getTwisterFunction(f+b)}return h};
AbstractTable.prototype.changeIdsOfAddedPanel=function(b){var c,d,f=this.P2.doc;this.rowsCanBeAdded&&(c=this.name+"AddRow",(d=f.getElementById(c))?(d.id=c+b,d.key=b):debug("Design Error : add row button with id "+c+" is missing in dom for table "+this.name));c=this.name+"Footer";if(d=f.getElementById(c)){d.id=c+b;d.key=b;for(var g=0;g<this.columnNames.length;g++)if(c=this.name+"_"+this.columnNames[g]+"Footer",d=f.getElementById(c))d.id=c+b,d.key=b}else debug("Design Error : add row button with id "+
c+" is missing in dom for table "+this.name);c=null;if(d=f.getElementById(this.panelName))c=d,d.id=this.panelName+b,d.key=b;if(d=f.getElementById(this.panelName+"Slider"))d.id+=b,d.setAttribute("key",b);if(d=f.getElementById(this.name))d.id=this.name+b,d.key=b,c=d.tBodies?d.tBodies[0]:d.firstChild;c&&(this.nbrRepeatedPanels++,this.repeatedPanels[b]=c);return c};
AbstractTable.prototype.deleteAllRows=function(){if(this.addedElements){for(var b=this.addedElements.length,c=0;c<b;c++){var d=this.addedElements[c];d.parentNode.removeChild(d)}this.addedElements=[];this.grid.length=1;this.nbrRows=0}else debug("Design error: this.addedElements  not found for a repeatng display panel")};AbstractTable.prototype.getRowNumber=function(b){return 1};AbstractTable.prototype.getObjectId=function(b,c){return b};
AbstractTable.prototype.clicked=function(b){b&&(b=this.getRowNumber(b))&&(this.currentRow=b)};AbstractTable.prototype.rowSelected=function(b){if(b=this.getRowNumber(b))this.currentRow=b};AbstractTable.prototype.validate=function(){return!0};
AbstractTable.prototype.rowChanged=function(b,c,d,f){d||(d=this.getRowNumber(b));d&&(this.currentRow=d);if(!f&&d&&(b=this.grid[d])&&(b.changedByUser=!0,this.actionFieldName&&(c=b[this.actionIdx],!c&&(!this.keyFieldName||this.keyFieldName==this.actionFieldName||b[this.keyIdx]||this.idFieldName&&!b.keyIsGenerated)))){c="modify";if(b.keyIsGenerated||this.idFieldName&&!b[this.idIdx])c="add";this.actionField.setValue(c,null,d);debug("action field is set to "+c)}};
AbstractTable.prototype.isRowDeleted=function(b){b=this.grid[b];this.linkedTable&&(b=this.linkedTable.grid[this.currentLinkedRow]);return b?b.isDeleted:!1};AbstractTable.prototype.getFieldValue=function(b,c){return null!=this.grid[b]?this.grid[b][c.columnIdx]:!1};
var ListOrGridTable=function(){AbstractTable.call(this);this.toBeSentToServer=!0;this.initialNumberOfRows=0;this.distinctKeys=this.childTableHtmlCell=this.childTableMetaCell=this.mainTableColumns=this.childTableColumns=this.childTable=this.htmlRowToClone=this.tableBodyObject=null;this.qtyBySize=!0;this.doNotShowTreeViewCheckBox=!1;this.paginateCallback=null;this.numberOfOrigDataRows=0;this.linkedElementName=this.linkedTableName=null};ListOrGridTable.prototype=new AbstractTable;
ListOrGridTable.prototype.getObjectId=function(b,c){if(!c){if(0==this.nbrRows)return b;c=this.currentRow}return b+"__"+c};ListOrGridTable.prototype.getRowNumber=function(b){if(!b)return 0==this.nbrRows?0:this.currentRow;if(b.rowIdx)return b.rowIdx;for(;b&&"BODY"!=b.tagName;){if(b.rowIdx)return b.rowIdx;b=b.parentNode}return this.currentRow};
ListOrGridTable.prototype.getTopRowNumber=function(){var b=this.P2.doc,c=b.getElementById(this.panelName+"Left");c||(c=b.getElementById(this.panelName));for(var b=c.scrollTop,d=this.tableBodyObject.firstChild;d.nextSibling;){if(d.offsetTop>b){c.scrollTop=d.offsetTop;break}if(d.offsetTop==tblTop&&"none"!=d.display)break;d=d.nextSibling}return d.rowIdx};
ListOrGridTable.prototype.getKey=function(){return this.repeatOnFieldName?this.grid[this.currentRow][this.P2.fields[this.repeatOnFieldName].columnIdx]:null};var NAVIGATION_ACTIONS={MoveNext:"next",MovePrev:"prev",MoveLast:"last",MoveFirst:"first",DeleteRow:"del",UndeleteRow:"undelete",NewRow:"new"};
ListOrGridTable.prototype.init=function(){if(!this.inited)if(this.htmlFragments)this.initTemplate();else{var b=this.P2.doc;this.cloneFlag=0;this.repeatingColumnName&&this.cacheRepeatingColumn(b);var c=b.getElementById(this.name+"Body");c||(c=b.getElementById(this.name));this.tableBodyObject=c&&c.tBodies?c.tBodies[0]:getFirstNonTextNode(c);c=getFirstNonTextNode(this.tableBodyObject);c.rowIdx=0;c.id=this.name+"0";this.htmlRowToClone=this.tableBodyObject.removeChild(c);this.frozenColumnIndex&&this.initFrozenPanel(b);
this.grid.length=1;this.nbrRows=0;this.idIdx=this.idFieldName?this.P2.fields[this.idFieldName].columnIdx:null;this.keyIdx=this.keyFieldName?this.P2.fields[this.keyFieldName].columnIdx:null;this.actionFieldName?(this.actionField=this.P2.fields[this.actionFieldName],this.actionIdx=this.actionField.columnIdx):this.actionIdx=null;this.initialNumberOfRows&&(this.addRows(this.initialNumberOfRows,null),this.currentRow=1);this.treeViewInit&&this.treeViewInit();this.pageSize&&0<this.pageSize&&(this.P2.win[this.name+
"PageSize"]=this.pageSize);if(this.rowSum||this.rowAverage)b.getElementById(this.name+"tfoot").style.display="";this.quickSearchFieldName&&this.quickSearchInit();this.initNavigationButtons();this.repeatOnFieldName&&((b=this.elderBrother||this.youngerBrother)?this.initBrothers(b):this.initRepeatingPanel());this.inited=!0}};
ListOrGridTable.prototype.initNestedTable=function(){var b=this.P2.doc.getElementById(this.nestedTableName);if(b){b.parentNode.removeChild(b);this.setNestedTr(b);b=this.nestedTable=this.P2.tables[this.nestedTableName];b.nestedParent=this;var c=this.columns[this.nestOnColumnName];c?(this.nestOnIdx=c.columnIdx,(c=b.columns[this.nestedTableColumnName])?b.nestedColumnIdx=c.columnIdx:debug(this.nestedTableColumnName+" is declared as nestedTableColumnName to link parent table "+this.name+" with nested table "+
this.nestedTableName+". this column is not defined in the nested table.")):debug(this.nestOnColumnName+" is declared as the name of the column using which table "+this.name+" is to be linked too its child table "+this.nestedTableName+". This column does not exist")}else debug(this.nestedTableName+" is not defined as a list/grid panel")};
ListOrGridTable.prototype.setNestedTr=function(b){var c=this.tableBodyObject.parentNode.insertRow(0);c.style.display="none";var d=c.insertCell(0);d.colSpan=this.htmlRowToClone.cells.length;d.appendChild(b);this.nestedTableTr=c};ListOrGridTable.prototype.EXIL_EXPANDED="exil-expanded";
ListOrGridTable.prototype.showNestedTable=function(b){if(b.getAttribute(this.EXIL_EXPANDED))b.removeAttribute(this.EXIL_EXPANDED),this.nestedTableTr.style.display="none";else{if(this.nestedTableTr.parentNode){var c=this.nestedTableTr.previousSibling;c&&c.removeAttribute(this.EXIL_EXPANDED);this.nestedTableTr.parentNode.removeChild(this.nestedTableTr)}this.currentRow=b.rowIdx;(c=b.nextSibling)?this.tableBodyObject.insertBefore(this.nestedTableTr,c):this.tableBodyObject.appendChild(this.nestedTableTr);
b.setAttribute("exil-expanded","exil-expanded");this.nestedTable.filterData(this.nestedTableColumnName,this.grid[this.currentRow][this.nestOnIdx],"eq");this.nestedTableTr.style.display=""}};ListOrGridTable.prototype.initBrothers=function(b){b=this.P2.tables[b];b.inited&&(this.elderBrother?(b.initRepeatingPanel(),this.repeatedPanels={},this.nbrRepeatedPanels=0):(this.initRepeatingPanel(),b.repeatedPanels={},b.nbrRepeatedPanels=0))};
ListOrGridTable.prototype.cacheRepeatingColumn=function(b){var c=this.columns[this.repeatingColumnName];this.repeatedField=c;c.toBeSentToServer=!1;var d=b.getElementById(c.name).parentNode;this.repeatingColumnSibling=d.nextSibling;this.repeatingColumnParent=d.parentNode;this.repeatingColumnEle=this.repeatingColumnParent.removeChild(d);d=b.getElementById(c.name+"Label");this.repeatingHeaderSibling=d.nextSibling;this.repeatingHeaderParent=d.parentNode;this.repeatingHeaderEle=this.repeatingHeaderParent.removeChild(d);
if(this.columnSumIndexes||this.columnAverageIndexes)d=b.getElementById(c.name+"Footer"),this.repeatingFooterSibling=d.nextSibling,this.repeatingFooterParent=d.parentNode,this.repeatingFooterEle=this.repeatingFooterParent.removeChild(d);this.nbrColumnsRepeated=0;c.rowSum&&(this.repeatedColumnToBeSummed=!0);c.rowAverage&&(this.repeatedColumnToBeAveraged=!0)};
ListOrGridTable.prototype.initNavigationButtons=function(){var b={},c=!1,d;for(d in NAVIGATION_ACTIONS){var f=NAVIGATION_ACTIONS[d],g=this.P2.doc.getElementById(this.name+d);if(!g){if(!this.linkedDisplayTable)continue;g=this.P2.doc.getElementById(this.linkedDisplayTable.name+"_"+this.name+d);if(!g)continue}g.tableName=this.name;g.navigationAction=f;g.disabled="new"!=f;this.P2.addListener(g,"click",this,"navigate");b[f]=g;c=!0}c&&(this.navigationButtons=b)};
ListOrGridTable.prototype.createLinks=function(){this.nestedTableName&&this.initNestedTable();if(this.mergeWithTableName){var b=this.P2.tables[this.mergeWithTableName];if(b){this.mergeWithTable=b;if(this.stubNameForMerging)b.tablesToBeMerged||(b.tablesToBeMerged=[],b.stubsForMergingTables=[]),b.tablesToBeMerged.push(this),b.stubsForMergingTables.push(this.stubNameForMerging);else if(this.mergeOnColumnName)b.childTableToMerge=this;else{debug("ERROR:"+this.name+" is to be merged with "+this.mergeWithTableName+
" but neither stubNameForMerging nor mergeOnColumnName is specified.");return}this.doNotSetDataToMe=!0;this.P2.hideOrShowPanels([this.name],"none")}else debug(this.name+" uses "+this.mergeWithTableName+" but that table does not exist")}};
ListOrGridTable.prototype.mergeChildPanel=function(b,c,d){var f=this.columns[c];if(f){for(var f=f.columnIdx,g=this.grid.length,h=null,k=1;k<g;k++)if(d==this.grid[k][f]){h=k;break}null==h?debug("ERROR: "+this.name+" does not have a row with a value of "+d+" in column "+c+". Child table rows are not merged properly."):(c=this.P2.doc.getElementById(this.name+h),"TR"==c.tagName?(c=this.tableBodyObject.parentNode.insertRow(c.rowIndex+1),c=c.insertCell(0),c.colSpan=this.htmlRowToClone.cells.length,c.append(b)):
c.appendChild(b))}else debug("ERROR: "+this.name+" is missing a column by name "+c+" that is used for merging child table with it.")};
ListOrGridTable.prototype.initFrozenPanel=function(b){var c=b.getElementById(this.name+"RightBody");c||(c=b.getElementById(this.name+"Right"));this.rightTableBodyObject=c.tBodies[0];c=this.rightTableBodyObject.firstChild;c.rowIdx=0;c.id=this.name+"Right0";this.rightHtmlRowToClone=this.rightTableBodyObject.removeChild(c);if(c=b.getElementById(this.name+"ScrollBody"))this.scrollTableBodyObject=c.tBodies[0],c=this.scrollTableBodyObject.firstChild,c.rowIdx=0,c.id=this.name+"Scroll0",this.scrollHtmlRowToClone=
this.scrollTableBodyObject.removeChild(c)};ListOrGridTable.prototype.cloneFrozenRow=function(b,c){var d=this.rightHtmlRowToClone.cloneNode(!0);d.className=b;d.rowIdx=c;d.id=this.name+"Right"+c;this.rightTableBodyObject.appendChild(d);this.scrollHtmlRowToClone&&(d=this.scrollHtmlRowToClone.cloneNode(!0),d.className=b,d.rowIdx=c,d.id=this.name+"Scroll"+c,this.actionDisabled&&(d.style.cursor="default",d.title="click action disabled"),this.scrollTableBodyObject.appendChild(d))};
ListOrGridTable.prototype.setData=function(b,c,d,f){if(this.htmlFragments)this.setDataToTemplate(b);else if(this.repeatOnFieldName)this.setDataToRepeatingPanel(b,f),this.aggregate(),this.childTableToMerge&&this.childTableToMerge.setData(b,c,d);else{this.pageSize&&this.initPagination(b);var g=b.grids[this.name],h=g.length;this.sortByColumn&&this.resetSortImage(this.sortByColumn);if(c){if(2>h)return;this.serverData||(this.serverData=[g[0]]);for(var k=1;k<h;k++)this.serverData.push(g[k])}else{var l=
this.nestedTableName&&this.P2.doc.getElementById(this.nestedTableName);l&&l.parentNode.removeChild(l);this.deleteAllRows();l&&this.setNestedTr(l);this.serverData=g}k=null;if(this.repeatedField){this.childGrid=k=b.grids[this.childTableName];if(this.childKeysTableName){l=b.grids[this.childKeysTableName];if(!l){message("Design Error : Dc is to contain a grid with name \x3d "+this.childKeysTableName,"Error","Ok",null,null,null);return}k=this.createDataForRepeatedColumns(k,!1);k.keys=l}else k=this.createDataForRepeatedColumns(k,
!0);this.repeatedData=k;this.repeatColumns()}l=this.P2.doc;if(k=l.getElementById(this.name+"NoData")){var m=l.getElementById(this.panelName)||l.getElementById(this.name),n=l.getElementById(this.panelName+"Top"),l=l.getElementById(this.name+"PaginationData");2>h?c||(k.style.display="",m.style.display="none",n&&(n.className="collapsedfieldset"),l&&(l.style.display="none")):(k.style.display="none",m.style.display="",n&&(n.className="expandedfieldset"),l&&(l.style.display=""))}this.pgEle&&(this.pgEle.style.display=
2>h?"none":"");this.quickSearchEle&&this.quickSearchReset();if(2>h)this.resetNavigationButtons(),this.aggregate&&this.aggregate(),this.initialNumberOfRows&&exilParms.displayInitialRows&&this.addRows(this.initialNumberOfRows,null,!0,f),this.numberOfOrigDataRows=0;else{m=getcolumnToColumnMap(g[0],this.columnNames);l=this.P2.doc;this.fieldCols=m;this.currentRow=this.grid.length-1;for(k=1;k<h;k++){this.currentRow++;var n=this.htmlRowToClone.cloneNode(!0),r=Array(this.nbrColumns),q=this.currentRow%2?"row2":
"row1";n.className=q;n.rowIdx=this.currentRow;n.id=this.name+this.currentRow;this.tableBodyObject.appendChild(n);r.tr=n;this.frozenColumnIndex&&(this.cloneFrozenRow(q,this.currentRow),r.righTr=this.rightTableBodyObject.lastChild);if(q=l.getElementById(this.name+"_"+this.name+"Delete"))q.id=q.id+"__"+this.currentRow;c&&(r.isAppended=!0);this.grid.push(r);this.addDataToARow(l,r,n.rowIdx,g[k],m,null,d,f);this.treeViewColumnName&&this.treeViewKeyColumn&&this.treeViewParentKeyColumn&&this.treeViewHasChildColumn&&
(this.renameTreeIds(k),this.treeViewIndentRow(k,r,n));this.repeatedField&&this.setDataToRepeatedColumns(l,r[this.idIdx],k)}this.treeViewColumnName&&(d=this.P2.doc.getElementById(this.name+"BulkCheck"))&&(d.checked=!1);this.initialNumberOfRows&&this.initialNumberOfRows>h&&exilParms.displayInitialRows&&this.addRows(this.initialNumberOfRows-h,null,!0,f);1<h&&(this.numberOfOrigDataRows=h);this.nbrRows+=h-1;c||this.simulateClickIfRequired();this.hasAggregates&&this.aggregate();this.hideOrShowColumns();
this.resetNavigationButtons();this.childTableToMerge&&this.childTableToMerge.setData(b)}}};ListOrGridTable.prototype.setDataToTemplate=function(b){var c="",d=b.grids[this.name],f="",g=this.htmlFragments[1];g&&1==g[0]&&(f=g[2]);if(!d||2>d.length)c=f;else{var c=[],h=1,g=this.htmlFragments[0];f&&(g=this.htmlFragments[2],h=3);c.push(g[2]);b=this.getHtmlForATable(c,b,d,h);c.push(this.htmlFragments[b][2]);c=c.join("")}this.tableBodyObject.innerHTML=c};
ListOrGridTable.prototype.getHtmlForATable=function(b,c,d,f){if(!d||!d.length||2>d.length)debug("no data rows found for an embedded table "+this.htmlFragments[f][1]);else{for(var g=this.htmlFragments[f],h=g[2],k=null,l=1;l<d.length;l++){b.push(h);for(var m=d[l],n=f+1,r=this.htmlFragments.length;n<r;){var g=this.htmlFragments[n],q=g[0];if(4==q){k=n;break}3==q?(g=this.filterRowsFromChildTable(c.grids[g[1]],m[0]),n=this.getHtmlForATable(b,c,g,n),b.push(this.htmlFragments[n][2])):5==q?(q=g[1],0==q?b.push(l):
b.push(m[q-1]),b.push(g[2])):debug("Error in algorithm. Unable to create inner html for rows of table "+this.tableName);n++}}return k}};ListOrGridTable.prototype.filterRowsFromChildTable=function(b,c){if(!(b&&b.length&&b[0]&&1<b[0].length))return[[]];for(var d=[b[0]],f=1;f<b.length;f++){var g=b[f];g[1]==c&&d.push(g)}debug(d.length+" rows filtered. This iincludes the header row");return d};
ListOrGridTable.prototype.initTemplate=function(){(this.tableBodyObject=this.P2.doc.getElementById(this.name))||alert("An element with id "+this.name+" is required for this page to work properly. It is missing in the html template used by this page.")};
ListOrGridTable.prototype.simulateClickIfRequired=function(){var b;if(this.simulateClickOnFirstRow||this.simulateClickOnRow==rowType.first)b=1;else if(this.simulateClickOnRow==rowType.current)b=this.currentRow;else if(this.simulateClickOnRow==rowType.next)b=this.getNextRow(this.currentRow,!1,!1)||this.currentRow;else return!1;debug("going to simulate a click on "+this.name);this.clicked(this.P2.doc.getElementById(this.name+b));return!0};
ListOrGridTable.prototype.setRowCss=function(){var b=this.tableBodyObject.childNodes;if(b&&b.length)for(var c=!0,d=0;d<b.length;d++){var f=b[d];"none"!=f.style.display&&(f.className=c?"row1":"row2",c=!c)}};
ListOrGridTable.prototype.deleteAllRows=function(){var b=this.tableBodyObject,c;if(b.deleteRow&&b.rows.length)for(c=b.rows.length;0<=--c;)b.deleteRow(c);else b.innerHTML="";if(this.frozenColumnIndex){b=this.rightTableBodyObject;for(c=this.rightTableBodyObject.childNodes.length;0<=--c;)b.deleteRow(c);if(b=this.scrollTableBodyObject)for(c=this.rightTableBodyObject.childNodes.length;0<=--c;)b.deleteRow(c)}this.grid.length=1;this.nbrRows=0;if(this.repeatedField&&this.nbrColumnsRepeated)for(;this.nbrColumnsRepeated;)this.nbrColumnsRepeated--,
b=this.repeatingHeaderSibling?this.repeatingHeaderSibling.previousSibling:this.repeatingHeaderParent.lastChild,this.repeatingHeaderParent.removeChild(b),b=this.repeatingColumnSibling?this.repeatingColumnSibling.previousSibling:this.repeatingColumnParent.lastChild,this.repeatingColumnParent.removeChild(b),this.repeatingFooterParent&&(b=this.repeatingFooterSibling?this.repeatingFooterSibling.previousSibling:this.repeatingFooterParent.lastChild,this.repeatingFooterParent.removeChild(b))};
ListOrGridTable.prototype.deleteAllRowsFromRepeatingPanel=function(){for(var b=0;b<this.addedElements.length;b++){var c=this.addedElements[b];c&&c.parentNode&&c.parentNode.removeChild(c)}this.addedElements=[];this.repeatedPanels={};this.nbrRepeatedPanels=0};
ListOrGridTable.prototype.addDataToARow=function(b,c,d,f,g,h,k,l){var m,n="__"+d;this.addSeqNo&&((m=b.getElementById(this.name+"SeqNo"))?(m.id+=n,m.innerHTML=d):debug("sequence number field not found for table "+this.name));var r=b.getElementById(this.name+"_"+this.panelName+"Delete");r&&(r.id+=n);this.rowsCanBeDeleted&&(m=b.getElementById(this.name+"_"+this.name+"Delete"))&&(m.id+=n,m.rowIdx=d);var r=this.columnNames.length,q,t=[],s=null,v=[];if((this.dataForNewRowToBeClonedFromFirstRow||this.dataForNewRowToBeClonedFromRow==
rowType.first)&&k&&2<this.grid.length){for(var u=1,u=1;u<this.grid.length&&!this.grid[u];u++);for(m=0;m<r;m++)v[m]=this.grid[u][m];if(this.newRowColumnsNotToBePopulatedWithData&&""!=this.newRowColumnsNotToBePopulatedWithData)for(m=this.newRowColumnsNotToBePopulatedWithData.split(","),u=0;u<m.length;u++)for(s=0;s<r;s++)if(this.columnNames[s]==m[u]){var w=this.columns[this.columnNames[s]];v[s]=w.defaultValue?w.defaultValue:"";break}}else if(this.dataForNewRowToBeClonedFromRow==rowType.last&&k&&2<this.grid.length){for(u=
this.grid.length-2;!this.grid[u]&&0<u||this.grid[u].isDeleted;)u--;for(m=0;m<r;m++)v[m]=this.grid[u][m];if(this.newRowColumnsNotToBePopulatedWithData&&""!=this.newRowColumnsNotToBePopulatedWithData)for(m=this.newRowColumnsNotToBePopulatedWithData.split(","),u=0;u<m.length;u++)for(s=0;s<r;s++)if(this.columnNames[s]==m[u]){w=this.columns[this.columnNames[s]];v[s]=w.defaultValue?w.defaultValue:"";break}}else if(this.dataForNewRowToBeClonedFromRow==rowType.current&&k&&2<this.grid.length){for(m=0;m<r;m++)v[m]=
this.grid[this.currentRow][m];if(this.newRowColumnsNotToBePopulatedWithData&&""!=this.newRowColumnsNotToBePopulatedWithData)for(m=this.newRowColumnsNotToBePopulatedWithData.split(","),u=0;u<m.length;u++)for(s=0;s<r;s++)if(this.columnNames[s]==m[u]){w=this.columns[this.columnNames[s]];v[s]=w.defaultValue?w.defaultValue:"";break}}else if(this.dataForNewRowToBeClonedFromRow==rowType.next&&k&&2<this.grid.length){u=0;for(this.grid.length>this.currentRow+2&&(u=this.currentRow+1);null==this.grid[u]&&u<this.grid.length;)u+=
1;for(m=0;m<r;m++)v[m]=this.grid[u][m];if(this.newRowColumnsNotToBePopulatedWithData&&""!=this.newRowColumnsNotToBePopulatedWithData)for(m=this.newRowColumnsNotToBePopulatedWithData.split(","),u=0;u<m.length;u++)for(s=0;s<r;s++)if(this.columnNames[s]==m[u]){w=this.columns[this.columnNames[s]];v[s]=w.defaultValue?w.defaultValue:"";break}}else v=this.grid[0];(m=this.nestedParent)&&(v[this.nestedColumnIdx]=m.getKeyForNestedChild());for(u=0;u<r;u++)if(w=this.columns[this.columnNames[u]],!this.repeatedField||
this.repeatedField!=w)if(m=b.getElementById(w.name),q=v[u],f?g&&(g[u]||0==g[u])?(q=f[g[u]])&&(s=dataTypes[w.dataType])&&(q=s.formatIn(q)):k&&(q=null==f[u]||""==f[u]?w.defaultValue:f[u]):h&&w.name==this.repeatOnFieldName?q=h:w.initSelection&&0==this.cloneFlag&&(q=w.initSelection(m)),!q&&this.idFieldName&&u==this.idIdx&&(this.localId?this.localId--:this.localId=-1,q=this.localId,c.keyIsGenerated=!0),c[u]=q,m){var x=q;q&&w.formatter&&(x=w.format(q));w.setValueToObject(m,x);if(q!=v[u]||""!=q&&(this.dataForNewRowToBeClonedFromFirstRow||
this.dataForNewRowToBeClonedFromRow==rowType.current||this.dataForNewRowToBeClonedFromRow==rowType.next||this.dataForNewRowToBeClonedFromRow==rowType.first||this.dataForNewRowToBeClonedFromRow==rowType.last)&&k)s={},s.field=w,s.val=q,s.ele=m,t.push(s);s=w.name+n;m.id=s;m.rowIdx=d;if(w.isRadio){var y=m.innerHTML,y=y.split(w.name+"Radio").join(s+"Radio");m.innerHTML=y;w.setValueToObject(m,x)}if(w.isCheckbox&&0<m.innerHTML.length&&(y=m.innerHTML,y=y.split(w.name+"Checkbox").join(s+"Checkbox"),m.innerHTML=
y,q))for(y=q.split("|"),x=0;x<y.length;x++)for(q=0;q<m.childNodes.length;q++)m.childNodes[q].type&&"CHECKBOX"==m.childNodes[q].type.toUpperCase()&&m.childNodes[q].value==y[x]&&(m.childNodes[q].checked=!0);for(q=0;q<relatedElementSuffixes.length;q++)if(m=b.getElementById(w.name+relatedElementSuffixes[q]))m.id=s+relatedElementSuffixes[q],m.rowIdx=d}else debug("DESIGN ERROR :table\x3d "+this.name+" field \x3d"+w.name+" is not found in dom");for(q=0;q<t.length;q++)s=t[q],s.field.triggerFieldChangedEvents&&
(s.field.supressDescOnLoad&&!k?s.field.triggerFieldChangedEvents(s.val,s.ele,d,s.field.supressDescOnLoad,!0,l):s.field.triggerFieldChangedEvents(s.val,s.ele,d,!1,!0,l));c=this.htmlRowToClone.childNodes;for(q=0;q<c.length;q++)for(f=0;f<c[q].childNodes.length;f++)if(g=[],g=c[q].childNodes[f],g.type&&("BUTTON"==g.type.toUpperCase()||"SUBMIT"==g.type.toUpperCase()||"IMAGE"==g.type.toUpperCase())){if(m=b.getElementById(g.id))s=g.id+n,m.id=s,m.rowIdx=d}else if(g.tagName&&"TABLE"==g.tagName.toUpperCase()&&
"buttonelementtable"==g.className)for(h=[],h=g.childNodes[g.childNodes.length-1],g=h.childNodes[0].childNodes,u=0;u<g.length;u++)if(m=b.getElementById(g[u].id))for(s=g[u].id+n,m.id=s,m.rowIdx=d,x=0;x<m.childNodes.length;x++)m.childNodes[x].tagName&&"FONT"==m.childNodes[x].tagName.toUpperCase()&&(s=m.childNodes[x].id+n,m.childNodes[x].id=s,m.childNodes[x].rowIdx=d);this.treeViewColumnName&&this.treeViewIndentRow(d)};ListOrGridTable.prototype.getKeyForNestedChild=function(){return this.grid[this.currentRow][this.nestOnIdx]};
ListOrGridTable.prototype.addInitialRowsToRepeatingPanel=function(b,c){for(var d=b.grids[this.name],f=getColumnIndex(d[0],this.P2.fields[this.repeatOnFieldName].unqualifiedName),g=null,h=1;h<d.length;h++){var k=d[h][f];if(k!=g){var g=k,l=this.initialNumberOfRows-this.repeatedPanels[k].childNodes.length;0<l&&this.addRows(l,k,!0,c)}}};
ListOrGridTable.prototype.addRows=function(b,c,d,f){var g=c?this.repeatedPanels[c]:this.tableBodyObject;if(this.maxRows&&this.maxRows<this.countAllRows()+b)message("You can have a maximum of "+this.maxRows+" data rows. If you intend to delete some rows, please do that before adding a new row","Warning","Ok",null,null,null);else{for(var h=this.P2.doc,k=1;k<=b;){var l=this.grid.length;this.nbrRows++;for(var m=this.htmlRowToClone.getElementsByTagName("INPUT"),n=0;n<m.length;n++)m[n].removeAttribute("disabled",
0);m=this.htmlRowToClone.getElementsByTagName("SELECT");for(n=0;n<m.length;n++)m[n].removeAttribute("disabled",0);m=this.htmlRowToClone.getElementsByTagName("TEXTAREA");for(n=0;n<m.length;n++)m[n].removeAttribute("disabled",0);m=this.htmlRowToClone.cloneNode(!0);n=l%2?"row2":"row1";m.className=n;m.rowIdx=l;m.id=this.name+l;this.actionDisabled&&(m.style.cursor="default",m.title="row click is disabled");g.appendChild(m);d&&this.repeatedField&&this.setDataToRepeatedColumns(h,null,l);this.frozenColumnIndex&&
this.cloneFrozenRow(n,l);m=Array(this.nbrColumns);m.addedByUser=!0;this.grid.push(m);this.addDataToARow(h,m,l,null,null,c,d,f);k++;if(this.nestedTableOwner&&d){l=this.P2.getTable(this.nestedTableOwner);m=l.nestOnColumnName?l.columns[l.nestOnColumnName]:null;if(!m)return;m=this.P2.getFieldValue(m.name);n=this.columns[l.nestOnColumnName].name;if(!n){debug("Error: ["+l.nestOnColumnName+"] is not exist for the grid ["+this.name+"]");return}this.P2.setFieldValue(n,m)}}this.totalRows&&(this.totalRows+=
b);this.currentRow=this.grid.length-1;if(this.firstFieldName){c=this.getObjectId(this.firstFieldName,this.currentRow);try{h.getElementById(c).focus()}catch(r){}}this.hasAggregates&&this.aggregate();this.quickSearchEle&&this.quickSearchAdd(b);this.linkedDisplayTable?this.clicked(h.getElementById(this.name+(this.currentRow+b-1))):this.resetNavigationButtons();this.P2.win.checkIframeSize()}};
ListOrGridTable.prototype.cloneRow=function(b){b||(b=this.currentRow);var c=this.P2.doc,d=c.getElementById(this.name+b);if(d){var d=d.nextSibling,f=this.grid[b];b=[];for(var g=0;g<f.length;g++)b[g]=f[g];b.addedByUser=!0;this.actionFieldName&&(b[this.actionIdx]="add");f=null;this.idFieldName&&(f=b[this.idIdx],b[this.idIdx]="");this.nbrRows++;g=this.grid.length;this.grid.push(b);var h=this.htmlRowToClone.cloneNode(!0);h.className=g%2?"row2":"row1";h.rowIdx=g;h.id=this.name+g;d?this.tableBodyObject.insertBefore(h,
d):this.tableBodyObject.appendChild(h);this.addDataToARow(c,b,g,null,null,null,!0);if(this.idFieldName&&(this.localId||(this.localId=0),this.localId--,b[this.idIdx]=this.localId,b.keyIsGenerated=!0,this.repeatedField)){d=this.repeatedData.data[f];b={};for(var k in d)b[k]=d[k];this.repeatedData.data[this.localId]=b;this.setDataToRepeatedColumns(c,f,g)}this.resetNavigationButtons();this.P2.win.checkIframeSize()}else debug("Design Error : could not get row for insert with name \x3d "+this.name+b)};
ListOrGridTable.prototype.getTBody=function(b,c){var d=this.repeatedPanels[b];if(d)return d;this.elderBrother?(d=this.P2.tables[this.elderBrother],d.cloneAndAddPanel(b,c,this.name,this.elderBrother),d.changeIdsOfAddedPanel(b)):(this.cloneAndAddPanel(b,c,this.name,this.youngerBrother),this.youngerBrother&&this.P2.tables[this.youngerBrother].changeIdsOfAddedPanel(b));return this.changeIdsOfAddedPanel(b)};ListOrGridTable.prototype.hideField=function(b){this.hideOrShowField(b,"none")};
ListOrGridTable.prototype.hideOrShowField=function(b,c){for(var d=this.P2.doc,f=d.getElementById(b+"Label"),g=1;g<this.grid.length;g++)this.grid[g]&&(f=this.getObjectId(b,g),f=d.getElementById(f))&&(f.style.display=c,(f=f.nextSibling)&&"3"==f.nodeType&&(f=f.nextSibling),f&&(f.style.display=c))};
ListOrGridTable.prototype.hideOrShowColumns=function(){var b=this.P2.doc;if(this.columnName&&this.displayList)for(var c=[],d=[],c=this.columnName,d=this.displayList,f=0;f<c.length;f++){var g=b.getElementById(c[f]+"Label");g&&(g.style.display=d[f]);for(var h=1;h<this.grid.length;h++)if(this.grid[h]){if(g=b.getElementById(c[f]+"__"+h))g.parentNode.style.display=d[f];g.nextSibling&&(g=g.nextSibling);g&&"3"==g.nodeType&&(g=g.nextSibling);g&&(g.parentNode.style.display=d[f])}if(g=b.getElementById(c[f]+
"Footer"))g.style.display=d[f]}};
ListOrGridTable.prototype.mouseOver=function(b,c,d){b.saveBgc||(b.saveBgc=b.style.backgroundColor);exilParms.listHoverColor&&(b.style.backgroundColor=exilParms.listHoverColor);if(!d&&(this.frozenColumnIndex&&(d="Right",0<b.id.indexOf("Right"+b.rowIdx)&&(d=""),d=this.P2.doc.getElementById(this.name+d+b.rowIdx),this.mouseOver(d,c,!0)),PM.toolTipEle)){var f=d=0;c.pageX||c.pageY?(d=c.pageX,f=c.pageY):(d=c.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft)-document.documentElement.clientLeft,
f=c.clientY+(document.documentElement.scrollTop||document.body.scrollTop)-document.documentElement.clientTop);c=[];var g=b.cells;b=b.cells.length;for(var h=0;h<b;h++)c.push(g[h].innerHTML);PM.toolTipEle.innerHTML='\x3cspan class\x3d"field" style:"background-color: yellow;"\x3e'+c.join("-")+"\x3c/span\x3e";PM.toolTipStyle.top=f+130+"px";PM.toolTipStyle.left=d+130+"px";PM.toolTipStyle.display="inline"}};
ListOrGridTable.prototype.mouseOut=function(b,c,d){b.style.backgroundColor=b.saveBgc||"";d||(this.frozenColumnIndex&&(d="Right",0<b.id.indexOf("Right"+b.rowIdx)&&(d=""),b=this.P2.doc.getElementById(this.name+d+b.rowIdx),this.mouseOut(b,c,!0)),PM.toolTipEle&&(PM.toolTipEle.innerHTML="",PM.toolTipStyle.display="none"))};
ListOrGridTable.prototype.clicked=function(b,c){if(this.actionDisabled||this.P2.errorOccurred)return!1;var d=b?b.rowIdx:1;if(b=this.P2.doc.getElementById(this.name+d)){this.currentRow=d;this.nestedTable&&this.showNestedTable(b);var f=[];f[0]=this.columnNames;f[1]=this.getClientRowWithServerData(d)||this.grid[d];d=b.rowIdx;if(this.multipleSelect)return this.simulateClick(b,null),this.onClickActionName&&this.P2.act(b,null,this.onClickActionName,f),!0;var g=this.P2.win.currentP2;g&&g.pendingPicker?g.codePickerReturned(f):
(this.selectedRow&&this.selectedRow!=b&&this.simulateClick(this.selectedRow,!1),this.simulateClick(b,!0),this.onClickActionName&&this.P2.act(b,null,this.onClickActionName,f),this.linkedDisplayTable&&(this.linkedDisplayTable.copyFromList(d),this.resetNavigationButtons()),scrollIntoView(b))}else debug(this.name+" has current row set to "+this.currentRow+" and hence is not suitable to be clicked")};
ListOrGridTable.prototype.dblClicked=function(b){debug("ListPanel.rowDblClicked() tableName\x3d"+this.name);if(this.actionDisabled)return!1;if(b)this.currentRow=b.rowIdx;else if(debug("clicked called with no tr for table "+this.name+" Currrent row assumed"),b=this.currentRow,b=this.P2.doc.getElementById(this.name+b),!b){debug(this.name+" has current row set to "+this.currentRow+" and hence is not suitable to be clicked");return}this.onDblClickActionName&&this.P2.act(b,null,this.onDblClickActionName);
return!0};
ListOrGridTable.prototype.rowUp=function(b){debug("row up for "+this.name+" with tr as "+(b&&b.nodeName));if(this.actionDisabled)return!1;b&&(this.currentRow=b.rowIdx);b=this.currentRow;var c=this.getNextRow(this.currentRow);if(!c)return debug(this.name+" can not move the row "+b+" up because there are no rows above this."),!1;var d=this.grid[b];this.grid[b]=this.grid[c];this.grid[c]=d;var d=this.P2.doc.getElementById(this.name+b),f=this.P2.doc.getElementById(this.name+c);f.parentNode.removeChild(f);f.parentNode.appendChild(f,
d);this.rightTableBodyObject&&(d=this.P2.doc.getElementById(this.name+"Right"+b),f=this.P2.doc.getElementById(this.name+"Right"+c),f.parentNode.removeChild(f),f.parentNode.appendChild(f,d));return!0};
ListOrGridTable.prototype.getNextRow=function(b,c,d){if(this.sortByColumn)return this.getNextSortedRow(b,c,d);var f=this.grid.length;if(1>=f||0==this.nbrRows)return 0;var g=1,h=f,k=1;c&&(g=-1,h=0,k=f-1);d||(k=0);d=b+g;if(0>=b||b>=f)k=0,d=c?f-1:1;for(;d!=b;){if(d==h){if(0==k)break;d=k;k=0}if(this.grid[d]&&(c=this.P2.doc.getElementById(this.name+d),"none"!=c.style.display))return d;d+=g}return 0};
ListOrGridTable.prototype.getNextSortedRow=function(b,c,d){if(1>=this.grid.length||0==this.nbrRows)return 0;for((b=this.P2.doc.getElementById(this.name+b))||(d=!0);b||d;)if(b?b=c?b.previousSibling:b.nextSibling:(b=c?this.tableBodyObject.lastChild:this.tableBodyObject.firstChild,d=!1),b&&"none"!=b.style.display)return b.rowIdx;return 0};
ListOrGridTable.prototype.getClientRowWithServerData=function(b){var c=[];b=this.serverData&&this.serverData[b];if(!b)return null;for(var d=0;d<this.nbrColumns;d++){var f=this.fieldCols[d],g="";f||0==f?g=b[f]:(f=this.columns[this.columnNames[d]],f.defaultValue&&(g=f.defaultValue));c.push(g)}return c};
ListOrGridTable.prototype.simulateClick=function(b,c){var d=null;if(this.frozenColumnIndex){var f="Right";0<b.id.indexOf("Right"+b.rowIdx)&&(f="");d=this.P2.doc.getElementById(this.name+f+b.rowIdx);f||(f=b,b=d,d=f)}null==c&&(c=!this.selectedRows[b.rowIdx]);c?(b.savedClassName||(b.savedClassName=b.className),b.className="selectedlistrow",this.selectedRow=b,this.currentRow=b.rowIdx,this.multipleSelect&&(this.selectedRows[b.rowIdx]=!0),d&&(d.className="selectedlistrow",this.selectedOtherRow=d)):(b.className=
b.savedClassName,this.selectedRow=null,this.multipleSelect&&this.selectedRows[b.rowIdx]&&delete this.selectedRows[b.rowIdx],d&&(d.className=b.savedClassName,this.selectedOtherRow=null))};ListOrGridTable.prototype.returnRows=function(b){var c=[];c[0]=this.serverData[0];for(var d in this.selectedRows)c.push(this.serverData[d]);if(b)for(d in b=this.tableBodyObject.childNodes,this.selectedRows)this.simulateClick(b[d],!1);if((d=this.P2.win.currentP2)&&d.pendingPicker)d.codePickerReturned(c);else return c};
ListOrGridTable.prototype.focusNext=function(b,c){for(var d=b.columnIdx,f=c.rowIdx,g=null,h=d+1;h!=d;h++){if(h==this.nbrColumns){if(f<this.grid.length&&(f=this.getNextRow(f,!1),0==f))break;h=0}column=this.columns[this.columnNames[h]];if(column.isEditable){f&&(c=this.P2.doc.getElementById(column.name+"__"+f));if(!c)return debug("Error:"+column.name+" has no HTML element"),null;if(!c.disabled)try{c.focus();c.select&&c.select();g=c;break}catch(k){return null}}}(d=g?!0:!1)||(g=this.columns[this.columnNames[this.nbrColumns-
1]]);f={};f.gotFocussed=d;f.ele=g;return f};
ListOrGridTable.prototype.fillDC=function(b){var c=[[]],d=[null],f=this.grid.length,g,h,k,l=null;for(g=1;g<f;g++)if(h=this.grid[g]){if(this.sendAffectedRowsOnly||this.autoSaveServiceName)if(!h[this.actionIdx]||h.beingSaved)continue;if(!this.keyFieldName||h[this.keyIdx]||this.idFieldName&&h[this.idIdx]&&!h.keyIsGenerated)if(d.push(h),c.push([]),this.autoSaveServiceName){l=g;break}}var m=0,n;for(n in this.columns)if(g=this.columns[n],g.toBeSentToServer){f=dataTypes[g.dataType];c[0][m]=n;k=g.columnIdx;
for(g=1;g<d.length;g++)h=d[g],(h=h[k])&&f&&(h=f.formatOut(h)),c[g][m]=h;m++}if(!m)return debug(this.name+" does not have any columns to be sent to server"),0;if(this.autoSaveServiceName&&!l)return 0;b.addGrid(this.name,c);if(this.repeatedField&&this.childGrid){c=[];g=this.childGrid[0];this.childKeysTableName||(g[2]=g[3]);g.length=3;c.push(g);n=this.repeatedData.data;for(g=1;g<d.length;g++)if(f=d[g][this.idIdx],m=n[f],!m.isDeleted)for(var r in m)if((h=m[r])||0==h)k=[],k[0]=f,k[1]=r,k[2]=h,c.push(k);
b.addGrid(this.childTableName,c)}return l};
ListOrGridTable.prototype.resetNavigationButtons=function(){if(this.linkedDisplayTable)if(0==this.nbrRows)this.P2.hideOrShowPanels([this.linkedDisplayTable.panelName],"none");else{this.P2.hideOrShowPanels([this.linkedDisplayTable.panelName],"");var b=this.P2.doc.getElementById(this.linkedDisplayTable.name);b&&(b.className=g?"deletedTable":"")}if(this.navigationButtons){var c=this.navigationButtons,d=!1,f=!1,g=!1;this.nbrRows&&(d=this.getNextRow(this.currentRow,!1),f=this.getNextRow(this.currentRow,
!0),g=this.grid[this.currentRow]&&this.grid[this.currentRow].isDeleted);this.linkedDisplayTable&&(b=this.P2.doc.getElementById(this.linkedDisplayTable.name))&&(b.className=g?"deletedTable":"");c.next&&(c.next.disabled=!d);c.last&&(c.last.disabled=!d);c.first&&(c.first.disabled=!f);c.prev&&(c.prev.disabled=!f);c.undelete&&(c.undelete.disabled=!g);c.del&&(c.del.disabled=this.nbrRows&&g?!0:!1)}};
ListOrGridTable.prototype.deleteAllTableRows=function(b){for(var c=this.grid.length,d=1;d<c;d++){var f=this.grid[d];if(f&&!(b&&f.isDeleted||!b&&!f.isDeleted)){var f=this.P2.doc.getElementById(this.name+d),g=this.P2.doc.getElementById(this.name+"_"+this.name+"Delete__"+d);this.deleteRow(g,f)&&(g.checked=!g.checked)}}};
ListOrGridTable.prototype.deleteRow=function(b,c,d){if(!d&&this.confirmOnRowDelete&&!confirm("Are you sure you want to delete?"))return!1;if(!c&&(debug("trying to delete/undelete row of "+this.name),c=b?getRowInTable(b):this.P2.doc.getElementById(this.name+this.currentRow),!c)){debug("Unable get TR element for delete operation on "+this.name);return}d=c.rowIdx;var f=this.grid[d];b||(b=this.P2.doc.getElementById(this.name+"_"+this.name+"Delete__"+d));var g=null,h=null;this.rightTableBodyObject&&(g=
this.name+d,c.id==g&&(g=this.name+"Right"+d),g=this.P2.doc.getElementById(g),this.scrollTableBodyObject&&(h=this.P2.doc.getElementById(this.name+"Scroll"+d)));var k=b&&"IMG"==b.tagName.toUpperCase(),l=this.repeatedData,m=null;l&&(m=f[this.idIdx],l=l.data[m]);if(f.isDeleted)return f.isDeleted=!1,this.undelete(c,g,k?b:null,d),l&&(l.isDeleted=!1,delete l.isDeleted),this.hasAggregates&&this.aggregate(),this.resetNavigationButtons(),!0;if(0<this.minRows&&this.countAllRows()<=this.minRows)return message("A minimum of "+
this.minRows+" data rows is required. Can not delete this row. If you intend to add rows, please do that before deleting this row","Warning","Ok",null,null,null),!1;f.isDeleted=!0;l&&(l.isDeleted=!0);l=null;this.toBeDeleted(f)?l=this.physicallyDelete(c,g,h,d):this.logicallyDelete(c,g,k?b:null,d);this.hasAggregates&&this.aggregate();l?(this.currentRow=l,this.clicked()):this.resetNavigationButtons();return!0};
ListOrGridTable.prototype.toBeDeleted=function(b){return this.idFieldName&&b[this.idIdx]&&!b.keyIsGenerated?!1:b.addedByUser?!0:this.doNotDeleteAppendedRows?!1:!0};
ListOrGridTable.prototype.undelete=function(b,c,d,f){b.className=b.savedClassName;b.style.backgroundColor=exilParms.gridUnDeletedColor||b.savedBackgroundColor||"";c&&(c.className=b.savedClassName);d&&(d.src=d.src.replace("undelete","delete"),d.className="deleteimg");this.currentRow=f;this.actionField&&this.actionField.setValue("modify",null,f)};
ListOrGridTable.prototype.physicallyDelete=function(b,c,d,f){b.parentNode.removeChild(b);c&&c.parentNode.removeChild(c);d&&d.parentNode.removeChild(d);this.grid[f]=null;this.nbrRows--;this.totalRows&&this.totalRows--;this.quickSearchEle?(this.quickSearchRebuildRow(f),this.gotFiltered&&this.quickSearch(this.quickSearchEle.value)):this.trEle&&(this.trEle.innerHTML=this.totalRows);b=0;0==this.nbrRows?this.keepABlankRow&&this.addRows(1):(b=this.getNextRow(f,!0))||(b=this.getNextRow(f,!1));return b};
ListOrGridTable.prototype.logicallyDelete=function(b,c,d,f){b.savedClassName=b.className;b.savedBackgroundColor=b.style.backgroundColor;b.className="deletedrow";exilParms.gridDeletedColor&&(b.style.backgroundColor=exilParms.gridDeletedColor);c&&(c.className="deletedrow");d&&(d.src=d.src.replace("delete","undelete"),d.className="undeleteimg");this.currentRow=f;this.actionField&&this.actionField.setValue("delete",null,f)};
ListOrGridTable.prototype.countAllRows=function(){for(var b=0,c=this.grid,d=c.length,f=1;f<d;f++){var g=c[f];g&&!g.isDeleted&&b++}return b};ListOrGridTable.prototype.countActiveRows=function(){if(null==this.keyIdx)return this.countAllRows();for(var b=0,c=this.grid,d=c.length,f=1;f<d;f++){var g=c[f];g&&!g.isDeleted&&(null==this.keyIdx||g[this.keyIdx]||this.idFieldName&&g[this.idIdx]&&!g.keyIsGenerated)&&b++}return b};
ListOrGridTable.prototype.disableAction=function(){for(var b=this.tableBodyObject.childNodes,c=b.length,d=0;d<c;d++){var f=b[d];f.style.cursor="auto";f.title="row click is disbaled."}this.actionDisabled=!0};ListOrGridTable.prototype.enableAction=function(){for(var b=this.tableBodyObject.childNodes,c=b.length,d=0;d<c;d++){var f=b[d];f.style.cursor="pointer";f.title=this.rowHelpText}this.actionDisabled=!1};
ListOrGridTable.prototype.navigate=function(b,c){this.currentRow||(this.currentRow=this.getSelectedRow());var d=this.currentRow;switch(c.navigationAction){case "next":d=this.getNextRow(d,!1);break;case "prev":d=this.getNextRow(d,!0);break;case "first":d=this.getNextRow(0,!1);break;case "last":d=this.getNextRow(this.grid.length,!0);break;case "del":this.P2.deleteTableRow(null,null,this.name);return;case "undelete":this.P2.deleteTableRow(null,null,this.name);return;case "new":this.P2.addTableRow(null,
this.name);this.clicked();return}0==d?debug("ERROR : "+c.navigationAction+" is not a valid navigaiton action on "+this.name+" with its current row at "+this.currentRow):(this.currentRow=d,this.clicked())};ListOrGridTable.prototype.getSelectedRow=function(){for(var b=this.P2.doc,c=1;c<this.grid.length;c++){var d=b.getElementById(this.name+c);if(d&&"selectedlistrow"==d.className)return c}debug(" no selected row found for "+this.name);return 0};
ListOrGridTable.prototype.initPagination=function(b,c){this.localPagination&&!c&&this.initLocalPagination(b);var d=this.P2.doc;if(!this.pgEle&&(this.pgEle=d.getElementById(this.name+"Pagination"),this.pgCountEle=d.getElementById(this.name+"PageCount"),!this.pgEle))return;var f=b.values[this.name+"TotalRows"];f?this.pgCountEle.style.display="":(this.pgCountEle.style.display="none",this.totalRows=f=(f=b.grids[this.name])?f.length-1:0);this.tpEle||(this.tpEle=d.getElementById(this.name+"TotalPages"),
this.cpEle=d.getElementById(this.name+"CurrentPage"),this.trEle=d.getElementById(this.name+"TotalRows"),this.fpEle=d.getElementById(this.name+"FirstPage"),this.ppEle=d.getElementById(this.name+"PrevPage"),this.npEle=d.getElementById(this.name+"NextPage"),this.lpEle=d.getElementById(this.name+"LastPage"));this.pgEle.style.display="";d=Math.floor((f-1)/this.pageSize)+1;this.totalRows=f;this.totalPages=d;this.currentPage=1;this.tpEle.innerHTML=d;this.cpEle.value=1;this.trEle.innerHTML=f;this.tpEle&&
this.cpEle&&this.trEle&&this.fpEle&&this.ppEle&&this.npEle&&this.lpEle&&(this.fpEle.className=ListPanel.INACTIVE_PAGE_CLASS,this.ppEle.className=ListPanel.INACTIVE_PAGE_CLASS,1==d?(this.npEle.className=ListPanel.INACTIVE_PAGE_CLASS,this.lpEle.className=ListPanel.INACTIVE_PAGE_CLASS):(this.npEle.className=ListPanel.ACTIVE_PAGE_CLASS,this.lpEle.className=ListPanel.ACTIVE_PAGE_CLASS),1==d?(this.fpEle.style.display="none",this.ppEle.style.display="none",this.npEle.style.display="none",this.lpEle.style.display=
"none"):(this.fpEle.style.display="",this.ppEle.style.display="",this.npEle.style.display="",this.lpEle.style.display=""))};ListOrGridTable.prototype.initLocalPagination=function(b){if(this.localRepaginationTriggered)this.localRepaginationTriggered=!1;else{var c=b.grids[this.name],d=c.length-1;this.filteredRows=this.entireServerData=null;if(!(d<=this.pageSize)){b.values[this.name+"TotalRows"]=d;this.entireServerData=c;for(var f=[],d=this.pageSize,g=0;g<=d;g++)f[g]=c[g];b.grids[this.name]=f}}};
ListOrGridTable.prototype.getServerData=function(){return this.entireServerData||this.serverData};ListOrGridTable.prototype.setServerData=function(b,c){this.entireServerData=b;this.filteredRows=c||null;this.localRepaginationTriggered=!0;this.repaginateServerData()};ListOrGridTable.prototype.setFilterRows=function(b){this.filteredRows=b;this.localRepaginationTriggered=!0;this.repaginateServerData()};
ListOrGridTable.prototype.repaginateServerData=function(){var b=this.entireServerData,c=this.filteredRows,d=[];d.push(b[0]);var f,g;if(c){g=f=c.length;g>this.pageSize&&(g=this.pageSize);for(var h=0;h<g;h++)d.push(b[c[h]])}else for(g=f=b.length-1,g>this.pageSize&&(g=this.pageSize),h=1;h<=g;h++)d.push(b[h]);b=new DataCollection;b.grids[this.name]=d;f>this.pageSize&&(b.values[this.name+"TotalRows"]=f);this.setData(b,!1,!1,!1)};
ListOrGridTable.prototype.paginate=function(b,c){var d=this.currentPage;switch(b){case "next":d++;break;case "first":d=1;break;case "last":d=this.totalPages;break;case "prev":d--;break;case "random":d=this.cpEle.value;break;case "go":d=this.getPageNumber()}if(!(d==this.currentPage||1>d||d>this.totalPages)){var f=1<d?ListPanel.ACTIVE_PAGE_CLASS:ListPanel.INACTIVE_PAGE_CLASS;if(this.fpEle||this.ppEle)this.fpEle.className=f,this.ppEle.className=f;f=d<this.totalPages?ListPanel.ACTIVE_PAGE_CLASS:ListPanel.INACTIVE_PAGE_CLASS;
this.npEle&&(this.npEle.className=f);this.lpEle&&(this.lpEle.className=f);this.cpEle&&(this.cpEle.value=d);this.currentPage=d;c||this.requestPage(d)}};ListOrGridTable.prototype.getPageNumber=function(){var b=this.currentPage;switch(this.P2.doc.getElementById(this.tableName+"PageSelection").value){case "next":b++;break;case "first":b=1;break;case "last":b=this.totalPages;break;case "prev":b--}return b};
ListOrGridTable.prototype.requestPage=function(b,c,d,f,g){if(this.localPagination)this.getPageFromServerData(b,c,d,f,g);else{var h=new DataCollection;h.values.tableName=this.name;h.values.pageNo=b;h.values.pageSize=this.pageSize;c&&(h.values.paginationColumnToSort=c,h.values.paginationSortDesc=d?1:0,f&&(h.values.paginationColumnToMatch=f,h.values.paginationValueToMatch=g));null!=this.paginationServiceName&&(h.values.paginationServiceName=this.paginationServiceName,h.values[this.name+"PageSize"]=this.pageSize);
if(null!=this.paginationServiceFieldNames&&(b=this.paginationServiceFieldNames.split(","),c=this.paginationServiceFieldNames.split(","),null!=this.paginationServiceFieldSources&&(c=this.paginationServiceFieldSources.split(",")),b.length==c.length))for(d=0;d<b.length;d++){f=trim(b[d]);g=trim(c[d]);var k=this.P2.getField(g);k.validate();h.values[f]=this.P2.getFieldValue(g);k.isFilterField&&(h.values[f+"Operator"]=this.P2.getFieldValue(g+"Operator"));var l=dataTypes[k.dataType];l&&"DATE"==l.basicType&&
(k.isFilterField?h.values[f+"To"]=this.P2.getFieldValue(g+"To"):k.fromField&&(h.values[f+"Operator"]=this.P2.getFieldValue(g+"Operator")))}h=new ServiceEntry("paginationService",h,!1,null,this,this.name,ServerAction.NONE);this.P2.win.serverStub.callService(h)}};
ListOrGridTable.prototype.getPageFromServerData=function(b,c,d,f,g){if(b){f&&this.filterServerData(f,g);c&&this.sortServerData(c,d);c=this.entireServerData;f=(d=this.filteredRows)?d.length:c.length-1;g=this.pageSize*(b-1);g>=f&&(g=0);b=g+this.pageSize;b>=f&&(b=f);f=[];if(d)for(;g<b;g++)f.push(c[d[g]]);else for(g++,b++;g<b;g++)f.push(c[g]);b=new DataCollection;b.grids[this.name]=f;this.serviceReturned(b)}};
ListOrGridTable.prototype.serviceReturned=function(b){if((b=b.grids[this.name])&&b.length){if(this.setPageData(b),this.hasAggregates&&this.aggregate(),b=this.paginateCallback)try{"function"==typeof b?b(this,this.name,this.se,!1):this.P2.act(this,this.name,b,this.se,!1)}catch(c){debug("Paginate Call back action failed with error :"+c)}}else debug("No data reced for "+this.name+" when paginaiton service returned.")};
ListOrGridTable.prototype.setPageData=function(b){var c=b.length;this.deleteAllRows();this.grid.length=1;this.serverData.length=1;for(var d=0;d<c;d++)this.serverData.push(b[d]);for(var f=this.P2.doc,g=this.fieldCols,h=(this.currentPage-1)*this.pageSize,d=1;d<=c;d++){h++;this.currentRow=d;var k=this.htmlRowToClone.cloneNode(!0),l=d%2?"row2":"row1";k.className=l;k.rowIdx=d;k.id=this.name+d;this.tableBodyObject.appendChild(k);this.frozenColumnIndex&&this.cloneFrozenRow(l,d);k=Array(this.nbrColumns);
this.grid.push(k);this.addPaginatedRow(f,k,d,b[d-1],g,h)}this.initialNumberOfRows&&this.initialNumberOfRows>c&&exilParms.displayInitialRows&&this.addRows(this.initialNumberOfRows-c,null,!0);1<c&&(this.numberOfOrigDataRows=c);this.treeViewColumnName&&(b=this.P2.doc.getElementById(this.name+"BulkCheck"))&&(b.checked=!1);this.nbrRows=c;this.currentRow=1;this.simulateClickIfRequired()};
ListOrGridTable.prototype.addPaginatedRow=function(b,c,d,f,g,h){var k,l="__"+d;this.addSeqNo&&(k=b.getElementById(this.name+"SeqNo"),k.id+=l,k.innerHTML=h);h=this.columnNames.length;for(var m,n=this.grid[0],r=0;r<h;r++){var q=this.columns[this.columnNames[r]];k=b.getElementById(q.name);if((m=g[r])||0==m){if(m=f[m])if(q.formatter)m=q.format(m);else{var t=dataTypes[q.dataType];t&&(m=t.formatIn(m))}}else m=n[r];c[r]=m;q.setValueToObject(k,m);k.id+=l;k.rowIdx=d}this.hideOrShowColumns();this.treeViewColumnName&&
this.treeViewIndentRow(d)};ListOrGridTable.prototype.doneWith=function(){this.totalRows&&this.totalRows>this.nbrRows&&this.requestPage(0)};
var ListPanel=function(){ListOrGridTable.call(this);this.PAGE_SIZE=30;this.showHeader=!0;this.pageSize=this.PAGE_SIZE;this.multipleSelect=this.actionDisabled=this.addSeqNo=!1;this.selectedRows={};this.serverGrid=null;this.activePageNo=this.totalPages=0;this.selectedRow=null;this.onclickActionText="";this.onDblClickActionName=this.onClickActionName=null;this.simulateClickOnFirstRow=!1;this.simulateClickOnRow=rowType.none;this.paginationServiceFieldSources=this.paginationServiceFieldNames=this.paginationServiceName=
null;this.rowHelpText="";this.toBeSentToServer=!1};ListPanel.prototype=new ListOrGridTable;ListPanel.prototype.validateColumn=function(){return!0};ListPanel.ACTIVE_PAGE_CLASS="activepaginationbutton";ListPanel.INACTIVE_PAGE_CLASS="inactivepaginationbutton";ListPanel.prototype.removeFromList=function(b){b||(b=this.currentRow);var c=this.P2.doc.getElementById(this.name+b);c?(c.parentNode.removeChild(c),this.grid[b]=null):debug(b+" is not a valid row number in list panel "+this.name)};
var getcolumnToColumnMap=function(b,c){for(var d=c.length,f=b.length,g=Array(d),h=0;h<d;h++){g[h]=null;for(var k=c[h],l=0;l<f;l++)if(k==b[l]){g[h]=l;break}}return g},getColumnIndex=function(b,c){for(var d=b.length,f=0;f<d;f++)if(b[f]==c)return f;return null},ButtonField=function(b,c,d){this.name=b;this.label=c;this.actionName=d},ButtonPanel=function(){this.renderingOption=this.P2=this.name=null;this.buttons={}};
ButtonPanel.prototype.setData=function(b){b=b.grids[this.name];if(1>=b.length)if("nextToEachOther"==this.renderingOption)this.P2.hideOrShowPanels([this.name],"none");else for(b=this.P2.doc.getElementById(this.name+"ButtonList");b.options.length;)b.remove(0);else b=this.transposeIfRequired(b),this.P2.hideOrShowPanels([this.name],""),"nextToEachOther"==this.renderingOption?this.enableButtons(b):this.buildDropDown(b)};
ButtonPanel.prototype.enableButtons=function(b){var c=this.P2.doc,d=b.length;if(!(1>=d)){for(var f=1<b[0].length,g={},h=1;h<d;h++){var k=b[h];if(f){var l=k[1];if(!l||"0"==l)continue}g[k[0]]=!0}for(var m in this.buttons)(b=c.getElementById(m))?b.style.display=g[m]?"":"none":debug("Design Error: Button panel "+this.name+" has not produced a DOM element with name  "+m)}};
ButtonPanel.prototype.buildDropDown=function(b){var c,d=this.P2.doc,f=d.getElementById(this.name+"ButtonList");if(f){f.innerHTML="";var g=d.createElement("option");f.appendChild(g);var h=b.length;if(!(1>=h))if(2==h&&1<b[0].length)for(var k=1<b[0].length,l=0;l<b[0].length;l++){if(k&&(c=b[1][l],!c||"0"==c))continue;g=b[0][l];(c=this.buttons[g])?(g=d.createElement("option"),g.value=c.actionName,g.innerHTML=c.label,f.appendChild(g)):debug("Button Panel "+this.name+" is not defined with a button with name "+
g+" but server is trying to enable this button")}else for(k=1<b[0].length,l=1;l<h;l++){if(k&&(c=b[l][1],!c||"0"==c))continue;g=b[l][0];(c=this.buttons[g])?(g=d.createElement("option"),g.value=c.actionName,g.innerHTML=c.label,f.appendChild(g)):debug("Button Panel "+this.name+" is not defined with a button with name "+g+" but server is trying to enable this button")}}else debug("DESIGN ERROR: Button Panel "+this.name+" has not produced a drop-down boc with name \x3d "+this.Name+"ButtonList")};
ButtonPanel.prototype.transposeIfRequired=function(b){var c=b&&b.length;if(!c||2<c)return b;var c=b[0],d=c.length;if(!d||!this.buttons[c[d-1]])return b;var f=null;if(1==b.length)for(f=[[""]],b=0;b<d;b++)f.push([c[b]]);else{var f=[["",""]],g=b[1];for(b=0;b<d;b++)f.push([c[b],g[b]])}return f};var DisplayPanel=function(){AbstractTable.call(this);this.hasSingleRow=this.toBeSentToServer=!0;this.grid[1]=[];this.currentRow=this.nbrRows=1};DisplayPanel.prototype=new AbstractTable;
DisplayPanel.prototype.fillDC=function(b){var c,d,f,g,h;if(this.doNotSendInGrid)for(var k in this.columns)c=this.columns[k],c.toBeSentToServer&&c.fillDc(b);else{var l=[],m=this.grid.length;for(c=0;c<m;c++)if(d=this.grid[c])null==this.keyIdx||d[this.keyIdx]?(d.toBeSent=!0,l.push([])):this.grid[c].toBeSent=!1;k=0;for(var n in this.columns)if(c=this.columns[n],c.toBeSentToServer){g=dataTypes[c.dataType];l[0][k]=n;h=1;f=c.columnIdx;for(c=1;c<m;c++)(d=this.grid[c])&&!1!=d.toBeSent&&((d=this.grid[c][f])&&
g&&(d=g.formatOut(d)),l[h][k]=d,h++);k++}k?b.addGrid(this.name,l):debug(this.name+" has no columns to be sent to server. ")}};
DisplayPanel.prototype.createLinks=function(){if(this.linkedTableName){var b=this.P2.tables[this.linkedTableName];if(b){this.linkedTable=b;this.linkedTable.simulateClickOnFirstRow=!0;this.linkedTable.linkedDisplayTable=this;this.linkedColumns=[];this.toBeSentToServer=!b.toBeSentToServer;for(var c=this.grid[0],d=this.grid[1]=[],f=0;f<this.columnNames.length;f++){var g=this.columnNames[f];d[f]=c[f];(g=this.linkedTable.columns[g])&&(this.linkedColumns[f]=g)}b.nbrRows?b.clicked():this.P2.hideOrShowPanels([this.panelName],
"none")}else debug(this.name+" uses "+this.linkedTableName+" but that table does not exist")}};
DisplayPanel.prototype.copyFromList=function(b){this.linkedTable.autoSaveServiceName&&this.linkedTable.saveInBackground();var c=this.linkedTable.grid[b],d=this.grid[1];if(c)for(this.currentLinkedRow=b,b=0;b<this.columnNames.length;b++){var f=this.linkedColumns[b];if(f){var g=this.columns[this.columnNames[b]],f=d[b]=c[f.columnIdx],h=this.P2.doc.getElementById(g.name);g.setValueToObject(h,f);g.triggerFieldChangedEvents&&g.triggerFieldChangedEvents(f,h,null,!1,!0)}}};
DisplayPanel.prototype.init=function(){this.grid.length=1;this.nbrRows=0;this.linkedTableName||(this.initRepeatingPanel(),this.idIdx=this.idFieldName?this.P2.fields[this.idFieldName].columnIdx:null,this.keyIdx=this.keyFieldName?this.P2.fields[this.keyFieldName].columnIdx:null,this.actionFieldName?(this.actionField=this.P2.fields[this.actionFieldName],this.actionIdx=this.actionField.columnIdx):this.actionIdx=null)};var relatedElementSuffixes="Indent PlusMinus Picker Hr Mn Sc Am FieldsTable".split(" ");
DisplayPanel.prototype.setData=function(b){this.nbrRows&&this.deleteAllRows();var c=b.grids[this.name];if(c&&!(2>c.length)){var d=this.P2.doc;this.nbrRepeatedPanels=0;this.repeatedPanels={};var f=c[0],g=f.length,h;h=this.labelFieldName?getColumnIndex(f,this.P2.fields[this.labelFieldName].unqualifiedName):0;for(var k=this.grid[0],l=this.grid.length=1;l<c.length;l++){var m=c[l],n=l;if(this.cloneAndAddPanel(n,m[h])){var r=d.getElementById(this.tableName);r&&(r.id=this.tableName+n);if(r=d.getElementById(this.panelName))r.id=
this.panelName+n;this.nbrRepeatedPanels++;this.repeatedPanels[n]=l;for(var n=[],q=k.length,r=0;r<q;r++)n[r]=k[r];this.grid.push(n);this.nbrRows++;for(r=0;r<g;r++){var t=this.columnNames[r];if(q=this.columns[f[r]]){var s=m[r];if(s){var v=dataTypes[q.dataType];v&&(s=v.formatIn(s))}n[q.columnIdx]=s;if(v=d.getElementById(q.name)){q.setValueToObject(v,s);s="__"+l;v.id=q.name+s;v.rowIdx=l;if(v=d.getElementById(t+"Label"))v.id=q.name+s+"Label",v.rowIdx=l;for(t=0;t<relatedElementSuffixes.length;t++)if(v=
d.getElementById(q.name+relatedElementSuffixes[t]))v.id=q.name+s+relatedElementSuffixes[t],v.rowIdx=l}else debug(q.name+" not found in dom. Skipping this field")}else debug(f[r]+" is received from server but is not a field for table "+this.name)}}}if(this.tablesToBeMerged)for(l=this.tablesToBeMerged.length-1;0<=l;l--)this.tablesToBeMerged[l].setData(b,rowsToBeAppended,isFromAppendRows,listServiceOnLoad)}};
DisplayPanel.prototype.deleteAllRows=function(){for(var b=0;b<this.addedElements.length;b++){var c=this.addedElements[b];c&&c.parentNode&&c.parentNode.removeChild(c)}this.nbrRows=0;this.addedElements=[];this.repeatedPanels={};this.nbrRepeatedPanels=0};DisplayPanel.prototype.getObjectId=function(b,c){if(this.linkedTable)return b;if(!c){if(0==this.nbrRows)return b;c=this.currentRow}return b+"__"+c};
DisplayPanel.prototype.getRowNumber=function(b){if(!b)return 0==this.nbrRows?0:this.currentRow;if(b.rowIdx)return b.rowIdx;for(;"BODY"!=b.tagName;){if(b.rowIdx)return b.rowIdx;b=b.parentNode}return this.currentRow};
DisplayPanel.prototype.initRepeatingPanel=function(){this.addedElements=[];this.repeatedPanels={};this.nbrRepeatedPanels=0;var b=this.P2.doc,c=b.getElementById(this.panelName+"Top");if(!c){c=b.getElementById(this.panelName);if(!c){message("Design error: "+this.name+"is being repeated, but its panel with name \x3d "+this.name+" is not found in dom","Error","Ok",null,null,null);return}this.hasNoTop=!0}this.panelToClone=c;this.parentPanel=c.parentNode;this.siblingElement=c.nextSibling;this.parentPanel.removeChild(c)};
DisplayPanel.prototype.cloneAndAddPanel=function(b,c){c||(c=b);var d=this.P2.doc,f=this.panelToClone.cloneNode(!0);f.id+=b;this.siblingElement?this.parentPanel.insertBefore(f,this.siblingElement):this.parentPanel.appendChild(f);this.addedElements.push(f);var g=d.getElementById(this.panelName+"Slider");g&&(g.id+=b,g.setAttribute("key",b));var h;h=this.panelName+"Label";if(g=d.getElementById(h))g.innerHTML=c,g.id=h+b;h=this.panelName+"Twister";if(g=d.getElementById(h))g.id=h+b,g.onclick=this.P2.win.getTwisterFunction(this.name+
b);return f};
DisplayPanel.prototype.changeIdsOfAddedPanel=function(b){var c,d,f=this.P2.doc;this.rowsCanBeAdded&&(c=this.name+"AddRow",(d=f.getElementById(c))?(d.id=c+b,d.key=b):debug("Design Error : add row button with id "+c+" is missing in dom for table "+this.name));c=this.name+"Footer";if(d=f.getElementById(c)){d.id=c+b;d.key=b;for(var g=0;g<this.columnNames.length;g++)if(c=this.name+"_"+this.columnNames[g]+"Footer",d=f.getElementById(c))d.id=c+b,d.key=b}else debug("Design Error : add row button with id "+c+
" is missing in dom for table "+this.name);c=null;if(d=f.getElementById(this.panelName))c=d,d.id=this.panelName+b,d.key=b;if(d=f.getElementById(this.name))d.id=this.name+b,d.key=b,c=d.tBodies?d.tBodies[0]:d.firstChild;c&&(this.nbrRepeatedPanels++,this.repeatedPanels[b]=c);if(this.stubsForMergingTables)for(var h in this.stubsForMergingTables)(d=document.getElementById(h))?d.id=h+b:debug(this.name+" has to have a panel with name "+this.appendLinkedTableTo+" for it to accomdate a linked repeating table. Unable to find that. Data will not be added");
return c};DisplayPanel.prototype.focussed=function(b){if(b=this.getRowNumber(b))this.currentRow=b};DisplayPanel.prototype.deleteRow=function(b){var c=null;b&&(c=this.getRowNumber(b));c||(c=this.currentRow);this.grid[c]=null};var GridPanel=function(){ListOrGridTable.call(this);this.uniqueColumns=this.actionFieldName=this.keyFieldName=this.idFieldName=null;this.maxRows=this.minRows=0};GridPanel.prototype=new ListOrGridTable;
GridPanel.prototype.removeTableRows=function(b){for(var c=0,d=this.grid.length,f=1;f<d;f++){var g=this.grid[f];if(g&&!(b&&g.isDeleted||!b&&!g.isDeleted)){var g=this.P2.doc.getElementById(this.name+f),h=this.P2.doc.getElementById(this.name+"_"+this.name+"Delete__"+f),k;if(h.checked){var l=!0;if(k=this.functionBeforeDeleteRow)if(0<=k.indexOf("(")?eval("result \x3d this.P2.win."+k):l=this.P2.win[k](),l)break;if(l=this.deleteRow(h,g,0<c)){if(k=this.functionAfterDeleteRow)if(0<=k.indexOf("(")?eval("result \x3d this.P2.win."+
k):l=this.P2.win[k](),!1==l)break;c++}else e&&e.preventDefault&&e.preventDefault()}}}};GridPanel.prototype.bulkCheckAction=function(b,c){for(var d=this.columns[c],f=b.checked?"1":"0",g=1;g<this.grid.length;g++)if(this.grid[g]){var h=this.getObjectId(d.name,g);b=this.P2.doc.getElementById(h);d.setValueToObject(b,f);this.P2.fieldChanged(b,d.name,!1)}};
GridPanel.prototype.validate=function(){var b=this.panelName,c=this.P2.doc.getElementById(this.panelName+"Label");c&&(b=c.firstChild.nodeValue);for(var c=this.tableBodyObject.childNodes,d=0;d<c.length;d++){var f=c[d];"none"!=f.style.display&&(f.className=d%2?"row1":"row2")}if(this.minRows||this.maxRows){c=this.countActiveRows();if(this.minRows&&c<this.minRows)throw b=new ExilityError("At least "+this.minRows+" rows required for the grid "+b+"."),b.render(),b;if(this.maxRows&&c>this.maxRows)throw b=
new ExilityError("A maximum of "+this.minRows+" rows allowed for the grid "+b+"."),b.render(),b;}this.validateUniqueColumns()};GridPanel.prototype.focussed=function(b){if(b=this.getRowNumber(b))this.currentRow=b};GridPanel.prototype.validateUniqueColumns=function(){if(!this.uniqueColumns)return!0;if(!this.uniqeColumnArrays){this.uniqeColumnArrays=[];for(var b=this.uniqueColumns.split(";"),c=0;c<b.length;c++)this.uniqeColumnArrays.push(b[c].split(","))}for(c=0;c<this.uniqeColumnArrays.length;c++)this.validateOneUniqueSet(this.uniqeColumnArrays[c])};
GridPanel.prototype.validateOneUniqueSet=function(b){for(var c=[],d=b.length,f="",g=this.P2.doc,h,k=0;k<d;k++)h=this.columns[b[k]],c.push(h.columnIdx),f+=' "'+h.label+'"';for(var l=[],m=[],n=this.grid.length,r=0,q=0,k=1;k<n;k++){var t=this.grid[k];q++;if(null==t||t.isDeleted)q--,0>q&&(q=0);else{var s="";for(h=0;h<d;h++){var v=t[c[h]];""!=v&&(s+=","+v)}if(""!=s){for(t=0;t<r;t++)if(s==l[t]&&(h=this.columns[b[0]],this.tableBodyObject.childNodes[m[t]].className="validationfailedrow",!(t>=q)||this.tableBodyObject.childNodes[q-
1]))throw this.tableBodyObject.childNodes[q-1].className="validationfailedrow",b=g.getElementById(h.name+"__"+k),this.messageIdForUniqueColumns?d=new ExilityError(this.messageIdForUniqueColumns,f,t+1,q,s.substr(1)):(errMsg="Column",1<d&&(errMsg+="s"),errMsg=" "+f+" should have unique values across all rows. Rows "+(t+1)+" and "+q+" have same values.",d=new ExilityError(errMsg)),d.render(b),d;l[r]=s;m[r]=q-1;r++}}}};
GridPanel.prototype.getColumnValue=function(b,c){var d=c?this.grid[c]:this.grid[this.currentRow];if(!d)return"";var f=this.columns[b];return f?d[f.columnIdx]:""};
GridPanel.prototype.bulkDeleteClicked=function(b){var c,d=!1;"INPUT"==b.tagName?bulkChecked=b.checked:(d=!0,"undeleteimg"==b.className?(bulkChecked=!0,b.className="deleteimg",b.src=b.src.replace("undelete","delete")):(b.className="undeleteimg",b.src=b.src.replace("delete","undelete")));for(var f=1;f<this.grid.length;f++)if(this.grid[f]&&(c=this.P2.doc.getElementById(this.name+"_"+this.name+"Delete__"+f)))if(d){if(b.className!=c.className){var g=this.P2.doc.createEvent("HTMLEvents");g.initEvent("click",
!0,!0);c.dispatchEvent(g)}}else b.checked!=c.checked&&c.click()};GridPanel.prototype.bulkCheckClicked=function(b,c){for(var d,f=1;f<this.grid.length;f++)d=this.P2.doc.getElementById(this.name+"_"+c+"__"+f),b.checked!=d.checked&&d.click()};GridPanel.prototype.tabKeyPressed=function(){};GridPanel.prototype.getColumnValue=function(b,c){var d=c?this.grid[c]:this.grid[this.currentRow];if(!d)return"";var f=this.columns[b];return f?d[f.columnIdx]:""};
GridPanel.prototype.saveInBackground=function(){var b=new DataCollection,c=this.fillDC(b);debug("Got "+c+" as the row to be autosaved.");if(!c)return 0;if(this.functionBeforeAutoSave&&!this.P2.win[this.functionBeforeAutoSave](b,c))return debug("user defined function "+this.functionBeforeAutoSave+" returned false, and hence we are not going ahead with save.."),0;this.P2.doc.getElementById(this.name+c).setAttribute("exil-save","saving");this.grid[c].beingSaved=!0;b=new ServiceEntry(this.autoSaveServiceName,
b,!1,null,{gridPanel:this,rowIdx:c,serviceReturned:function(b){this.gridPanel.autoSaveReturned(b,this.rowIdx)}},null,!1,!1,!1,null,null,!0);this.P2.win.serverStub.callService(b);return c};
GridPanel.prototype.autoSaveReturned=function(b,c){if(this.functionAfterAutoSave)this.P2.win[this.functionAfterAutoSave](b,c);var d=this.grid[c];d?(delete d.beingSaved,b.success&&this.actionFieldName&&(d[this.actionIdx]="")):debug("ERROR: service returned for "+c+" but the row is already deleted.");this.P2.doc.getElementById(this.name+c).setAttribute("exil-save",b.success?"saved":"failed")};
ListOrGridTable.prototype.quickSearchInit=function(){var b=this.P2.doc.getElementById(this.quickSearchFieldName);b?(b.searchTableName=this.name,b.addEventListener?b.addEventListener("keyup",this.keyPressedOnQuickSearch,!0):b.attachEvent("onkeyup",this.keyPressedOnQuickSearch),this.quickSearchEle=b):alert("Design Error: "+this.quickSearchFieldName+" is not a valid field name. It is used as a quick search field for  list panel "+this.panelName)};
ListOrGridTable.prototype.keyPressedOnQuickSearch=function(){if(this.searchTableName){var b=null;try{b=currentActiveWindow.P2.getTable(this.searchTableName)}catch(c){debug("unable to get table "+c)}b?(debug(this.value+" is the value with entireServerData \x3d"+(b.entireServerData&&b.entireServerData.length)),b.entireServerData?b.paginatedQuickSearch(this.value):b.quickSearch(this.value)):debug("Unable to find table for quick search for element "+this.id)}else debug("We have issue with concept of this while handling events!!")};
ListOrGridTable.prototype.quickSearchReset=function(){this.quickSearchEle.value=this.lastFilteredText="";this.gotFiltered=!1};ListOrGridTable.prototype.quickSearchBuild=function(){for(var b=this.grid.length,c=this.columnNames.length,d=1;d<b;d++){var f=this.grid[d];f&&this.assignSearchText(f,c)}};ListOrGridTable.prototype.assignSearchText=function(b,c){for(var d=[],f=0;f<c;f++){var g=b[f];g.toUpperCase?d.push(g.toUpperCase()):d.push(g)}b.searchText=d.join(" ")};
ListOrGridTable.prototype.quickSearchRebuildRow=function(b){b||(b=this.currentRow);(b=this.grid[b])&&this.assignSearchText(b,this.columnNames.length)};ListOrGridTable.prototype.quickSearchAdd=function(b){for(var c=this.columnNames.length,d=this.grid.length,f=this.P2.doc,g=0;g<b;g++){var h=this.grid[d];h&&(this.assignSearchText(h,c),h.tr=f.getElementById(this.name+g));d++}this.gotFiltered&&this.quickSearch(this.quickSearchEle.value)};
ListOrGridTable.prototype.quickSearch=function(b){debug("|"+b+"| and last text was  |"+this.lastFilteredText+"|");if(this.lastFilteredText==b)debug("Not going to filter again!!|");else{this.lastFilteredText=b;var c=this.grid.length,d=0,f=this.columnNames.length;if(b){this.gotFiltered=!0;b=b.toUpperCase();for(var g=1;g<c;g++){var h=this.grid[g];if(h){h.searchText||this.assignSearchText(h,f);h.tr||(h.tr=this.P2.doc.getElementById(this.name+g));var k="none";0<=h.searchText.indexOf(b)&&(k="",d++);h.tr.style.display=
k;h.rightTr&&(h.rightTr.style.display=k)}}this.trELe&&(this.trEle.innerHTML=d+" of "+this.totalRows)}else if(this.gotFiltered){this.gotFiltered=!1;for(g=1;g<c;g++)(h=this.grid[g])&&h.tr?h.tr.style.display="":debug("Could not locate tr for row "+g);this.trEle&&(this.trEle.innerHTML=this.totalRows)}this.P2.win.adjustFrameHeightToBodyHeight();return d}};
ListOrGridTable.prototype.paginatedQuickSearch=function(b){this.getQuickSearchIndexes(b);var c=this.filteredRows.length;b=[this.entireServerData[0]];var d=c;d>this.pageSize&&(d=this.pageSize);for(var f=0;f<d;f++)b.push(this.entireServerData[this.filteredRows[f]]);f=new DataCollection;f.addGrid(this.name,b);c>d&&(f.values[this.name+"TotalRows"]=c);this.initPagination(f,!0);this.tableBodyObject.innerHTML="";this.rightTableBodyObject&&(this.rightTableBodyObject.innerHTML="");this.grid.length=1;this.nbrRows=
0;this.serverData=b;c=this.P2.doc;this.currentRow=0;for(f=1;f<=d;f++){var g=b[f];this.currentRow++;var h=this.htmlRowToClone.cloneNode(!0),k=Array(this.nbrColumns),l=this.currentRow%2?"row2":"row1";h.className=l;h.rowIdx=this.currentRow;h.id=this.name+this.currentRow;this.tableBodyObject.appendChild(h);this.frozenColumnIndex&&this.cloneFrozenRow(l,this.currentRow);this.grid.push(k);this.addDataToARow(c,k,h.rowIdx,g,this.fieldCols)}};
ListOrGridTable.prototype.getQuickSearchIndexes=function(b){b.toUpperCase&&(b=b.toUpperCase());var c=[],d=this.entireServerData,f=d.length-1;debug("going to filter "+f+" rows");for(var g=1;g<f;g++){var h=d[g];h.searchText||this.assignSearchText(h,h.length);0<=h.searchText.indexOf(b)&&c.push(g)}this.filteredRows=c;debug("ended up filtering "+this.filteredRows.length+" rows")};
var RepeatingDisplayPanel=function(){AbstractTable.call(this);this.toBeSentToServer=!0;this.labelFieldName=this.repeatOnFieldName=null};RepeatingDisplayPanel.prototype=new AbstractTable;RepeatingDisplayPanel.prototype.init=function(){this.grid.length=1;this.nbrRows=0;this.initRepeatingPanel()};RepeatingDisplayPanel.prototype.getRowNumber=function(b){return b.rowIdx||this.currentRow};RepeatingDisplayPanel.prototype.getObjectId=function(b,c){return b+"__"+c};
RepeatingDisplayPanel.prototype.setData=function(b,c,d,f){this.nbrRows&&this.deleteAllRows();c=this.P2.doc;this.nbrRepeatedPanels=0;this.repeatedPanels={};if((d=b.grids[this.name])&&!(2>d.length)){var g=d[0],h=g.length,k=getColumnIndex(g,this.P2.fields[this.repeatOnFieldName].unqualifiedName),l;l=this.labelFieldName?getColumnIndex(g,this.P2.fields[this.labelFieldName].unqualifiedName):k;for(var m=this.grid[0],n=1;n<d.length;n++){var r=d[n],q=r[k];if(this.cloneAndAddPanel(q,r[l])){this.nbrRepeatedPanels++;
this.repeatedPanels[q]=n;for(var q=[],t=m.length,s=0;s<t;s++)q[s]=m[s];this.grid.push(q);this.nbrRows++;for(s=0;s<h;s++)if(t=this.columns[g[s]]){var v=r[s];if(v){var u=dataTypes[t.dataType];u&&(v=u.formatIn(v))}q[t.columnIdx]=v;u=c.getElementById(t.name);t.setValueToObject(u,v);u.id=t.name+"__"+n;u.rowIdx=n}else debug(g[s]+" is received from server but is not a field for table "+this.name)}}c=d.length-1;exilParms.displayInitialRows&&this.initialNumberOfRows&&this.initialNumberOfRows>c&&this.addInitialRowsToRepeatingPanel(b,
f)}};RepeatingDisplayPanel.prototype.fillDC=function(b){var c=[],d=this.grid.length,f,g,h,k,l;for(f=0;f<d;f++)if(g=this.grid[f])null==this.keyIdx||g[this.keyIdx]?(g.toBeSent=!0,c.push([])):this.grid[f].toBeSent=!1;var m=0,n;for(n in this.columns)if(f=this.columns[n],f.toBeSentToServer){k=dataTypes[f.dataType];c[0][m]=n;l=1;h=f.columnIdx;for(f=1;f<d;f++)(g=this.grid[f])&&!1!=g.toBeSent&&((g=this.grid[f][h])&&k&&(g=k.formatOut(g)),c[l][m]=g,l++);m++}m?b.addGrid(this.name,c):debug(this.name+" does not have any columns to be sent to server")};
var mySortWorker=function(b,c){return b||0===b?c||0===c?b==c?0:b>c?1:-1:1:c||0===c?-1:0},mySort=function(b,c){return mySortWorker(b.val,c.val)},myMultiSort=function(b,c){for(var d=b.length,f=0;f<d;f++){var g=mySortWorker(b[f],c[f]);if(0!==g)return g}return 0};
ListOrGridTable.prototype.sort=function(b,c,d){b||(b=this.P2.doc.getElementById(this.name+"_"+c+"SortImage"));var f=this.sortByColumn;this.sortByColumn=c;b&&f&&f!=c&&this.resetSortImage(f);this.sortOrder=d?0>d?-1:1:f==c&&this.sortOrder?-this.sortOrder:1;debug("Going to sort table "+this.name+" on column "+this.sortByColumn+" with sort order as "+this.sortOrder);b&&(0<this.sortOrder?(b.src=b.src.replace("sortable","sortedUp").replace("sortedDown","sortedUp"),b.title="Sort Descending"):(b.src=b.src.replace("sortable",
"sortedDown").replace("sortedUp","sortedDown"),b.title="Sort Ascending"),b=this.P2.doc.getElementById(this.name+"_"+c+"Label"),b.savedClassName||""==b.savedClassName||(b.savedClassName=b.className||""),b.className="exilSortTHClass");this.totalRows&&1<this.totalPages||this.localPagination&&this.entireServerData?this.requestPage(1,c,0>this.sortOrder):(this.sortData(),(b=this.P2.win[this.name+"AfterSort"])&&b(c,0>this.sortOrder),this.simulateClickIfRequired());this.pageSize&&this.totalPages&&1<this.totalPages&&
this.cpEle&&(this.cpEle.value=1,this.paginate("random",!0))};ListOrGridTable.prototype.resetSortImage=function(b){var c=this.P2.doc.getElementById(this.name+"_"+b+"SortImage");c&&(c.src=0<this.sortOrder?c.src.replace("sortedUp","sortable"):c.src.replace("sortedDown","sortable"),c.title="Sort Ascending",c=this.P2.doc.getElementById(this.name+"_"+b+"Label"))&&(c.className=c.savedClassName)};
ListOrGridTable.prototype.sortData=function(){var b=this.columns[this.sortByColumn];if(b){var c=this.sortedIndexes=this.getSortedIndexes(this.sortByColumn,0>this.sortOrder);if(null!=c){if(this.initialNumberOfRows)for(var d=c.length+1;d<this.initialNumberOfRows;)c.push(d),d++;var d=[],f=this.tableBodyObject.lastChild,g=null,h=null;this.frozenColumnIndex&&(g=this.rightTableBodyObject.lastChild,h=[]);this.tableBodyObject.style.display="none";h&&(this.rightTableBodyObject.style.display="none",this.scrollTableBodyObject&&
(this.scrollTableBodyObject.style.display="none"));for(;f;)d[f.rowIdx]=f,this.tableBodyObject.removeChild(f),f=this.tableBodyObject.lastChild;for(;g;)h[g.rowIdx]=g,this.rightTableBodyObject.removeChild(g),g=this.rightTableBodyObject.lastChild;var k=null,l=!1;if(f=this.P2.doc.getElementById(b.name+"Label"))if(k=f.cellIndex,this.frozenColumnIndex){for(;"TABLE"!=f.nodeName;)f=f.parentNode;b=f.id.length;if(f.id.indexOf("Right")==b-5||f.id.indexOf("RightHeader")==b-11)l=!0}for(var b=1,m=c.length,n=0;n<
m;n++)if(f=d[c[n]]){if(this.tableBodyObject.appendChild(f),h&&(g=h[c[n]],this.rightTableBodyObject.appendChild(g)),"none"!=f.style.display){var r=b%2?"row2":"row1";this.resetHeaderSortClass(f,r);h&&this.resetHeaderSortClass(g,r);null!=k&&(f=l?g.cells[k]:f.cells[k],r=(r=f.className)?r+" exilSortTDClass":"exilSortTDClass",f.className=r);b++}}else debug(" for i \x3d "+n+" index is "+c[n]+" and tr is null!!!! ");this.tableBodyObject.style.display="";h&&(this.rightTableBodyObject.style.display="",this.scrollTableBodyObject&&
(this.scrollTableBodyObject.style.display=""))}}else debug(this.sortByColumn+" is not a valid column name. Sorting abandoned")};
ListOrGridTable.prototype.getSortedIndexes=function(b,c){if(!b||" "===b)return null;if(this.additionalColumnToSort&&b!=this.additionalColumnToSort)return this.getMutliSortedIndexes([b,this.additionalColumnToSort],c);var d=this.grid.length;this.initialNumberOfRows&&(d=this.numberOfOrigDataRows);if(1>=d)return null;var f=this.columns[b],g=null;f.getDisplayVal||(g=dataTypes[f.dataType])&&g.basicType==AbstractDataType.TEXT&&(g=null);for(var h=[],k=f.columnIdx,l=1;l<d;l++){var m=this.grid[l],m=m&&m[k];
f.getDisplayVal&&(m=f.getDisplayVal(m));m&&(g?m=g.clientObject(m):m.toUpperCase&&(m=m.toUpperCase()));h.push({val:m,idx:l})}h.sort(mySort);f=[];d=h.length;if(c)for(l=d-1;0<=l;l--)f.push(h[l].idx);else for(l=0;l<d;l++)f.push(h[l].idx);return f};
ListOrGridTable.prototype.getMutliSortedIndexes=function(b,c){var d=this.grid.length;this.initialNumberOfRows&&(d=this.numberOfOrigDataRows);if(1>=d)return null;for(var f=[],g=b.length,h=0;h<g;h++){var k=this.columns[b[h]];if(k){var l=null;k.getDisplayVal||(l=dataTypes[k.dataType])&&l.basicType==AbstractDataType.TEXT&&(l=null);f.push({idx:k.columnIdx,dt:l,field:k})}else debug(this.columns[columnName[h]]+" is not included in sorting as it is not a valid column name")}g=f.length;if(0==g)return debug("Not going to sort as no valid coulumns found."),
null;for(var l=[],m=1;m<d;m++){var n=this.grid[m];if(n&&!n.isDeleted){var r=[];r.idx=m;l.push(r);for(h=0;h<g;h++){var q=f[h],t=trim(n[q.idx]);t&&((k=q.field)&&k.getDisplayVal&&(t=k.getDisplayVal(t)),q.dt?t=q.dt.clientObject(t):t.toUpperCase&&(t=t.toUpperCase()));r.push(t)}}}l.sort(myMultiSort);f=[];d=l.length;if(c)for(m=d-1;0<=m;m--)f.push(l[m].idx);else for(m=0;m<d;m++)f.push(l[m].idx);return f};
ListOrGridTable.prototype.resetHeaderSortClass=function(b,c,d){"deletedrow"!=b.className&&b.className!=c&&(b.className=c);b=b.cells||b.childNodes;d=b.length;for(var f=0;f<d;f++)(c=b[f])&&"#text"!==c.nodeName&&c.className&&(c.className=c.className.replace("exilSortTDClass",""))};
ListOrGridTable.prototype.removeFilter=function(){this.filterObject.src=this.filterObject.src.replace("filtered","filterable");this.filterObject.title="Filter";this.filterData();this.filterObject=this.filterValue=this.filterByColumn=null};
ListOrGridTable.prototype.filter=function(b,c,d){b||(b=this.P2.doc.getElementById(this.name+"_"+c+"FilterImage"));var f=this.filterByColumn;this.filterByColumn=c;this.filterValue=d;this.filterObject=b;f!=c&&(b.src=b.src.replace("filterable","filtered"),b.title="Filter/Cancel");f&&(this.filterObject.src=this.filterObject.src.replace("filtered","filterable"),this.filterObject.title="Filter");f=null;0==d.indexOf("\x3c\x3d")?(f="le",d=d.substr(2)):0==d.indexOf("\x3e\x3d")?(f="ge",d=d.substr(2)):0==d.indexOf("!\x3d")?
(f="ne",d=d.substr(2)):0==d.indexOf("\x3d\x3d")?(f="eq",d=d.substr(2)):0==d.indexOf("\x3d")?(f="eq",d=d.substr(1)):0==d.indexOf("\x3c")?(f="lt",d=d.substr(1)):0==d.indexOf("\x3e")?(f="gt",d=d.substr(1)):(b=d.indexOf("%"),0==b?(b=d.lastIndexOf("%"),0==b?(d=d.substr(1),f="ew"):(d=d.substring(1,b),f="cn")):0<b&&(d=d.substring(0,b),f="sw"));this.filterData(c,d,f)};
ListOrGridTable.prototype.filterData=function(b,c,d){var f=this.grid.length,g,h=null,k=null,l=null,m=null,n=null;b&&(h=this.columns[b],n=h.columnIdx,(m=dataTypes[h.dataType])||(m=new TextDataType("text","",null,0,9999)),c=m.clientObject(c),m.basicType==m.TEXT&&(c=c.toUpperCase()),null==d&&(d=m.basicType==m.TEXT?"cn":"eq"),d=ListOrGridTable.comparators[d]);for(var r=this.P2.doc,q=1,t=1;t<f;t++){var s=this.grid[t];s&&((h=r.getElementById(this.name+t))||alert(this.name+t+" is not a tr "),this.rightTableBodyObject&&
(k=r.getElementById(this.name+"Right"+t),this.scrollTableBodyObject&&(l=r.getElementById(this.name+"Scroll"+t))),g=!0,b&&(g=m.clientObject(s[n]),m.basicType==m.TEXT&&(g=g?g.toUpperCase():""),g=d(g,c)),s=g?"":"none",h.style.display=s,k&&(k.style.display=s,l&&(l.style.display=s)),s=q%2?"row2":"row1",g&&("deletedrow"!=h.className&&h.className!=s&&(h.className=s,k&&(k.className=s)),q++))}};
ListOrGridTable.comparators={eq:function(b,c){return b?c?b.valueOf()==c.valueOf():!1:c?!1:!0},ne:function(b,c){return b!=c},gt:function(b,c){return b>c},ge:function(b,c){return b>=c},lt:function(b,c){return b<c},le:function(b,c){return b<=c},sw:function(b,c){return 0==b.indexOf(c)},ew:function(b,c){return b.lastIndexOf(c)==b.length-c.length},cn:function(b,c){return 0<=b.indexOf(c)}};
ListOrGridTable.prototype.sortServerData=function(b,c){var d=this.getColIdxForServerData(b);if(null!=d){var f=this.entireServerData,g=1,h=f.length,k=this.filteredRows,l=!1;k&&k.length+1!=h&&(l=!0,h=k.length,g=0);var m=[];if(this.additionalColumnToSort&&b!=this.additionalColumnToSort){for(var n=this.getColIdxForServerData(this.additionalColumnToSort);g<h;g++){var r=l?k[g]:g,q=f[r],t=q[d];t&&t.toUpperCase&&(t=t.toUpperCase());(q=q[n])&&q.toUpperCase&&(q=q.toUpperCase());t=[t,q];t.idx=r;m.push(t)}m.sort(myMultiSort)}else{for(;g<
h;g++)r=l?k[g]:g,(n=f[r][d])&&n.toUpperCase&&(n=n.toUpperCase()),debug("going to push "+n+" and "+r),m.push({val:n,idx:r});m.sort(mySort)}c&&m.reverse();d=this.filteredRows=[];h=m.length;for(g=0;g<h;g++)d.push(m[g].idx)}};
ListOrGridTable.prototype.filterServerData=function(b,c,d){b=this.getColIdxForServerData(b);if(null!==b){var f=this.entireServerData;c=c.toUpperCase();var g=[],h=null,k=f.length,l=0;d&&this.filteredRows&&(h=this.filteredRows,k=h.length,l=1);for(d=l;d<k;d++)(l=f[h?h[d]:d][b])&&0<=l.toString().toUpperCase().indexOf(c)&&g.push(d);this.filteredRows=g}};
ListOrGridTable.prototype.getColIdxForServerData=function(b){for(var c=this.entireServerData[0],d=c.length,f=0;f<d;f++)if(c[f]===b)return f;debug(b+" is not a column in paginated data of "+this.name);return null};
ListOrGridTable.prototype.aggregateAField=function(b,c,d){this.repeatedField&&b===this.repeatedField?(b.rowSum&&this.updateRepeatedRowAggregate(b,d,"sum"),b.rowAverage&&this.updateRepeatedRowAggregate(b,d,"avg"),b.columnSum&&this.updateRepeatedColumnAggregate(b,c,"sum"),b.columnAverage&&this.updateRepeatedColumnAggregate(b,c,"avg")):this.repeatOnFieldName?b.columnSum&&this.updateRepeatedPanelColumnAggregate(b,c,"sum"):(b.rowSum&&this.updateRowAggregate(d,"sum"),b.rowAverage&&this.updateRowAggregate(d,
"avg"),b.columnSum&&this.updateColumnAggregate(b,"sum"),b.columnAverage&&this.updateColumnAggregate(b,"avg"))};
ListOrGridTable.prototype.updateRepeatedPanelColumnAggregate=function(b,c,d){c=this.P2.fields[this.repeatOnFieldName].columnIdx;for(var f=0,g=0,h=b.columnIdx,k=1;k<this.grid.length;k++)if(this.grid[k]){var l=this.grid[k][c];if("sum"==d&&b.columnSumFunction)try{f=this.P2.win[b.columnSumFunction](this.grid)}catch(m){throw debug("Error while executing columnSumFunction : "+b.columnSumFunction+" on the field : "+b.name+" of the grid : "+this.name),m;}else if("avg"==d&&b.columnAverageFunction)try{f=this.P2.win[b.columnAverageFunction](this.grid)}catch(n){throw debug("Error while executing columnAverageFunction : "+
b.columnAverageFunction+" on the field : "+b.name+" of the grid : "+this.name),n;}else for(var r=1;r<this.grid.length;r++){var q=this.grid[r];if(q&&!q.isDeleted){if(q[c]==l){q=parseFloat(q[h]);if(isNaN(q))continue;f+=q}g++}}b.formatter?f=b.format(f):b.dataType&&(r=dataTypes[b.dataType])&&(f=r.formatIn(f));this.P2.doc.getElementById(b.name+"Footer"+l).innerHTML=f;f=0}};
ListOrGridTable.prototype.aggregate=function(){if(this.rowSumIndexes||this.rowAverageIndexes)for(var b=1;b<this.grid.length;b++){var c=this.grid[b];c&&!c.isDeleted&&(this.rowSumIndexes&&(this.repeatedColumnToBeSummed?this.updateRepeatedRowAggregate(this.repeatedField,b,"sum"):this.updateRowAggregate(b,"sum")),this.rowAverageIndexes&&(this.repeatedColumnToBeAveraged?this.updateRepeatedRowAggregate(this.repeatedField,b,"avg"):this.updateRowAggregate(b,"avg")))}if(this.columnSumIndexes)for(b=0;b<this.columnSumIndexes.length;b++)c=
this.columnSumIndexes[b],c==this.repeatedField?this.updateRepeatedColumnAggregate(c,null,"sum"):this.repeatOnFieldName?this.updateRepeatedPanelColumnAggregate(c,null,"sum"):this.updateColumnAggregate(c,"sum");if(this.columnAverageIndexes)for(b=0;b<this.columnAverageIndexes.length;b++)c=this.columnAverageIndexes[b],c==this.repeatedField?this.updateRepeatedColumnAggregate(c,null,"avg"):this.updateColumnAggregate(c,"avg")};
ListOrGridTable.prototype.updateRepeatedColumnAggregate=function(b,c,d){var f=[];if(c)f.push(c.getAttribute("key"));else{var f=[],g=this.repeatedData.keys;for(c=1;c<g.length;c++)f.push(g[c][0])}var h=this.repeatedData.data,g=[],k=[];for(c=0;c<f.length;c++)g.push(0),k.push(0);if("sum"==d&&b.columnSumFunction)try{g=this.P2.win[b.columnSumFunction](this.grid)}catch(l){throw debug("Error while executing columnSumFunction : "+b.columnSumFunction+" on the field : "+b.name+" of the grid : "+this.name),l;
}else if("avg"==d&&b.columnAverageFunction)try{g=this.P2.win[b.columnAverageFunction](this.grid)}catch(m){throw debug("Error while executing columnAverageFunction : "+b.columnAverageFunction+" on the field : "+b.name+" of the grid : "+this.name),m;}else{for(var n=1;n<this.grid.length;n++)if((c=this.grid[n])&&!c.isDeleted){var r=c[this.idIdx],r=h[r];for(c=0;c<f.length;c++)if(k[c]++,r){var q=parseFloat(r[f[c]]);q&&(g[c]+=q)}}for(c=0;c<g.length;c++)"avg"==d&&(g[c]=0==k[c]?"--":g[c]/k[c]),exilParams.doNotRoundOffColumnSumAndAvg||
(g[c]=Math.round(Math.round(100*g[c]))/100)}d=this.P2.doc;r=b.name+"Footer";for(c=0;c<f.length;c++)b.formatter?g[c]=b.format(g[c]):b.dataType&&(h=dataTypes[b.dataType])&&(g[c]=h.formatIn(g[c])),d.getElementById(r+f[c]).innerHTML=g[c]};
ListOrGridTable.prototype.updateRepeatedRowAggregate=function(b,c,d){var f=this.repeatedData.keys,g=this.repeatedData.data,h=0,k=0;if("sum"!=d||!b.rowSumFunction)if("avg"!=d||!b.rowAverageFunction)for(b=g[this.grid[c][this.idIdx]]||{},g=1;g<f.length;g++){var l=parseFloat(b[f[g][0]]);isNaN(l)||(h+=l,k++)}this.assignRowAggregateValue(h,k,c,d)};
ListOrGridTable.prototype.assignRowAggregateValue=function(b,c,d,f){for(var g="rowSum",h=null,k=null,l=0;l<this.columnNames.length;l++){var m=this.columns[this.columnNames[l]];m.rowSumFunction&&(h=m.rowSumFunction);m.rowAverageFunction&&(k=m.rowAverageFunction)}if("sum"==f&&h)try{b=this.P2.win[h](this.grid)}catch(n){throw debug("Error while executing rowSumFunction : "+h+" of the grid : "+this.name),n;}else if("avg"==f&&k){g="rowAverage";try{b=this.P2.win[k](this.grid)}catch(r){throw debug("Error while executing rowAverageFunction : "+
k+" of the grid : "+this.name),r;}}else"avg"==f?(g="rowAverage",b=c?Math.round(Math.round(100*b/c))/100:"--"):b=Math.round(Math.round(100*b))/100;c=this.columns[g];this.grid[d][c.columnIdx]=b;c.formatter&&(b=c.format(b));this.P2.doc.getElementById(c.name+"__"+d).innerHTML=b;c.columnSum&&this.updateColumnAggregate(c,"sum");c.columnAverage&&this.updateColumnAggregate(c,"avg")};
ListOrGridTable.prototype.updateRowAggregate=function(b,c){for(var d=0,f=0,g=null,h=null,k=0;k<this.columnNames.length;k++){var l=this.columns[this.columnNames[k]];l.rowSumFunction&&(g=l.rowSumFunction);l.rowAverageFunction&&(h=l.rowAverageFunction)}if("sum"!=c||!g)if("avg"!=c||!h)for(g=this.grid[b],k=0;k<this.rowSumIndexes.length;k++)h=parseFloat(g[this.rowSumIndexes[k]]),isNaN(h)||(d+=h,f++);this.assignRowAggregateValue(d,f,b,c)};
ListOrGridTable.prototype.updateColumnAggregate=function(b,c){var d=0,f=0,g=b.columnIdx;if("sum"==c&&b.columnSumFunction)try{d=this.P2.win[b.columnSumFunction](this.grid)}catch(h){throw debug("Error while executing columnSumFunction : "+b.columnSumFunction+" on the field : "+b.name+" of the grid : "+this.name),h;}else if("avg"==c&&b.columnAverageFunction)try{d=this.P2.win[b.columnAverageFunction](this.grid)}catch(k){throw debug("Error while executing columnAverageFunction : "+b.columnAverageFunction+
" on the field : "+b.name+" of the grid : "+this.name),k;}else{for(var l=1;l<this.grid.length;l++){var m=this.grid[l];if(m&&!m.isDeleted){var n=parseFloat(m[g]);b.formatter&&(n+"").length<m[g].length/2&&(n=parseFloat(b.deformat(m[g])));isNaN(n)||(d+=n,f++)}}d="avg"==c?0==f?"--":Math.round(Math.round(100*d/f))/100:Math.round(Math.round(100*d))/100}b.formatter?d=b.format(d):b.dataType&&(f=dataTypes[b.dataType])&&(d=f.formatIn(d));this.P2.doc.getElementById(b.name+"Footer").innerHTML=d};
ListOrGridTable.prototype.repeatColumns=function(){for(var b=this.repeatedData.keys,c=this.repeatedField.name,d=c+"Label",f,g=b.length,h=1;h<g;h++){var k=b[h][0];f=this.repeatingHeaderEle.cloneNode(!0);f.innerHTML=b[h][1];f.id=d+k;this.repeatingHeaderSibling?this.repeatingHeaderParent.insertBefore(f,this.repeatingHeaderSibling):this.repeatingHeaderParent.appendChild(f);this.repeatingFooterEle&&(f=this.repeatingFooterEle.cloneNode(!0),f.id=c+"Footer"+k,this.repeatingFooterSibling?this.repeatingFooterParent.insertBefore(f,
this.repeatingFooterSibling):this.repeatingFooterParent.appendChild(f));f=this.repeatingColumnEle.cloneNode(!0);this.repeatingColumnSibling?this.repeatingColumnParent.insertBefore(f,this.repeatingColumnSibling):this.repeatingColumnParent.appendChild(f);for(f=f.childNodes[0];f&&!f.id;)f=f.nextSibling;if(!f)throw alert("Exility Design Error: Unable to get the repeated field for "+this.name+". Report to Exility Tect team"),"Repeating column design error for table "+this.name;f.id=c+k;f.setAttribute("key",
k);this.nbrColumnsRepeated++;for(f=f.nextSibling;f&&f.tagName&&"SPAN"!=f.tagName.toUpperCase();)f=f.nextSibling;f&&(f=f.childNodes[0])&&f.tagName&&"IMG"==f.tagName.toUpperCase()&&f.setAttribute("key",k)}};
ListOrGridTable.prototype.setDataToRepeatedColumns=function(b,c,d){var f=this.repeatedField;c=this.repeatedData.data[c];for(var g=this.repeatedData.keys,h=g.length,k="__"+d,l=1;l<h;l++){var m=g[l][0],n=f.name+m,r=b.getElementById(n);c&&((m=c[m])||0==m)&&f.setValueToObject(r,m);r.id=n+k;r.rowIdx=d}};
ListOrGridTable.prototype.createDataForRepeatedColumns=function(b,c){var d={},f=[["key","label"]],g={};g.data=d;c&&(g.keys=f);if(1>=b.length)return g;for(var h={},k=[],l=b.length,m=1;m<l;m++){var n=b[m],r=n[0],q=n[1],t=d[r];t||(t={},d[r]=t);c?(h[q]||(h[q]=n[2],k.push(q)),t[q]=n[3]):t[q]=n[2]}if(c)for(k.sort(),l=k.length,m=0;m<l;m++)q=k[m],f.push([q,h[q]]);return g};
ListOrGridTable.prototype.saveRepeatedColumnValue=function(b,c,d){d=this.grid[d][this.idIdx];var f=this.repeatedData.data,g=f[d];g||(g={},f[d]=g);g[c]=b};
ListOrGridTable.prototype.setDataToRepeatingPanel=function(b,c){if(this.elderBrother||this.youngerBrother){var d=this.elderBrother?this.P2.tables[this.elderBrother]:this;d.rowsGotDeleted?d.rowsGotDeleted=!1:(d.deleteAllRowsFromRepeatingPanel(),d.rowsGotDeleted=!0)}else this.deleteAllRowsFromRepeatingPanel();this.grid.length=1;this.nbrRows=0;var d=this.P2.doc,f=b.grids[this.name];if(f&&!(2>f.length)){this.serverData=f;var g=f[0],h=getcolumnToColumnMap(g,this.columnNames);this.fieldCols=h;for(var k=
getColumnIndex(g,this.P2.fields[this.repeatOnFieldName].unqualifiedName),g=this.labelFieldName?getColumnIndex(g,this.labelFieldName):k,l=null,m=null,n=0,r=1;r<f.length;r++){var q=f[r],t=q[k];if(t!=l){l=t;m=this.getTBody(t,q[g]);if(!m)continue;n=m.childNodes.length;if(n==this.initialNumberOfRows)if(m.deleteRow)for(;0<=--n;)m.deleteRow(n);else m.innerHTML="";n=0}if(!m){alert("Design Error: repeatingField is not set up properly for this repeating table "+this.name+" with panel name "+this.panelName);
return}this.nbrRows++;q=this.htmlRowToClone.cloneNode(!0);n++;t=n%2?"row2":"row1";q.className=t;q.rowIdx=r;q.id=this.name+r;m.appendChild(q);this.frozenColumnIndex&&this.cloneFrozenRow(t,r);q=Array(this.nbrColumns);this.grid.push(q);this.addDataToARow(d,q,r,f[r],h,null,null,c)}this.initialNumberOfRows&&exilParms.displayInitialRows&&this.addInitialRowsToRepeatingPanel(b,c)}};
ListPanel.prototype.treeViewInit=function(){this.treeViewHasChildColumnIdx=this.treeViewParentKeyColumnIdx=this.treeViewKeyColumnIdx=-1;if(this.treeViewColumnName)for(var b=0;b<this.columnNames.length;b++)this.columnNames[b]==this.treeViewKeyColumn?this.treeViewKeyColumnIdx=b:this.columnNames[b]==this.treeViewParentKeyColumn?this.treeViewParentKeyColumnIdx=b:this.columnNames[b]==this.treeViewHasChildColumn&&(this.treeViewHasChildColumnIdx=b)};ListPanel.EXPANDED_NODE="minus.gif";
ListPanel.COLLAPSED_NODE="plus.gif";ListPanel.LEAF_NODE="space.gif";
ListPanel.prototype.treeViewIndentRow=function(b){var c=this.P2.doc,d=c.getElementById(this.name+b),f=this.grid[b],g=f[this.treeViewParentKeyColumnIdx],f=f[this.treeViewHasChildColumnIdx],h=null;if(g&&0<g.length)for(var k=b-1;0<k;k--)if(this.grid[k][this.treeViewKeyColumnIdx]==g){h=k;break}this.renameTreeImages(b,d,h);h&&(d.parentRowIdx=h,g=c.getElementById(this.name+"_"+this.treeViewColumnName+"__"+h+"Indent").style.width,g=parseInt(g.substr(0,g.indexOf("px")),10)+19,c.getElementById(this.name+"_"+
this.treeViewColumnName+"__"+b+"Indent").style.width=g+"px");"N"==f?(b=c.getElementById(this.name+"_"+this.treeViewColumnName+"__"+b+"PlusMinus"),c=b.src.split("/"),b.src=b.src.replace(c[c.length-1],ListPanel.LEAF_NODE),b.style.cursor="auto",d.rowState=ListPanel.LEAF_NODE):d.rowState=ListPanel.EXPANDED_NODE};var treeViewImageSuffixes=["PlusMinus","Select","Indent"];
ListPanel.prototype.renameTreeImages=function(b,c,d){for(var f=this.name+"_"+this.treeViewColumnName+"__"+b,g=this.P2.doc,h=0;h<treeViewImageSuffixes.length;h++){var k=treeViewImageSuffixes[h],l=g.getElementById(this.treeViewColumnName+k);l.id=f+k;l.rowIdx=b;l.tr=c;d&&(l.parentRowIdx=d)}};
ListPanel.prototype.treeViewExpandCollapseRow=function(b,c){b.tr.rowState==ListPanel.EXPANDED_NODE?(b.src=b.src.replace(ListPanel.EXPANDED_NODE,ListPanel.COLLAPSED_NODE),b.tr.rowState=ListPanel.COLLAPSED_NODE,this.treeViewHideChildRows(b,c)):b.tr.rowState==ListPanel.COLLAPSED_NODE&&(b.src=b.src.replace(ListPanel.COLLAPSED_NODE,ListPanel.EXPANDED_NODE),b.tr.rowState=ListPanel.EXPANDED_NODE,this.treeViewShowChildRows(b,c))};
ListPanel.prototype.treeViewShowChildRows=function(b,c){var d=this.grid[b.rowIdx][this.treeViewKeyColumnIdx];if(b.tr.rowState!=ListPanel.LEAF_NODE)for(var f,g=b.rowIdx+1;g<this.grid.length;g++){f=this.grid[g][this.treeViewParentKeyColumnIdx];if(f!=d)break;f=this.P2.doc.getElementById(this.name+"_"+c+"__"+g+"PlusMinus");f.tr.style.display="";f.tr.rowState==ListPanel.EXPANDED_NODE&&this.treeViewShowChildRows(f,c)}};
ListPanel.prototype.treeViewHideChildRows=function(b,c){var d=this.grid[b.rowIdx][this.treeViewKeyColumnIdx];if(b.tr.rowState!=ListPanel.LEAF_NODE)for(var f,g=b.rowIdx+1;g<this.grid.length;g++){f=this.grid[g][this.treeViewParentKeyColumnIdx];if(f!=d)break;f=this.P2.doc.getElementById(this.name+"_"+c+"__"+g+"PlusMinus");f.tr.style.display="none";this.treeViewHideChildRows(f,c)}};
ListPanel.prototype.treeViewSelectDeselectRow=function(b,c){if(b.checked)"selectedlistrow"!=b.tr.className&&(b.tr.savedClassName=b.tr.className),b.tr.className="selectedlistrow",b.tr.rowState==ListPanel.LEAF_NODE&&(this.selectedRows[b.rowIdx]=!0);else{var d=this.P2.doc.getElementById(this.name+"BulkCheck");d&&(d.checked=!1);b.tr.className=b.tr.savedClassName;b.tr.rowState==ListPanel.LEAF_NODE&&this.selectedRows[b.rowIdx]&&delete this.selectedRows[b.rowIdx]}!b.checked&&b.parentRowIdx&&(d=this.P2.doc.getElementById(this.name+
"_"+c+"__"+b.parentRowIdx+"Select"),this.treeViewDeselectParentRow(d,c));this.treeViewSelectDeselectChildRows(b,c)};ListPanel.prototype.treeViewDeselectParentRow=function(b,c){b.tr.className=b.tr.savedClassName;b.checked=!1;if(b.parentRowIdx){var d=this.P2.doc.getElementById(this.name+"_"+c+"__"+b.parentRowIdx+"Select");this.treeViewDeselectParentRow(d,c)}};
ListPanel.prototype.treeViewSelectDeselectChildRows=function(b,c){var d=this.grid[b.rowIdx][this.treeViewKeyColumnIdx];if(b.tr.rowState!=ListPanel.LEAF_NODE)for(var f,g=b.rowIdx+1;g<this.grid.length;g++){f=this.grid[g][this.treeViewParentKeyColumnIdx];if(f!=d)break;f=this.P2.doc.getElementById(this.name+"_"+c+"__"+g+"Select");f.checked=b.checked;f.checked?("selectedlistrow"!=f.tr.className&&(f.tr.savedClassName=f.tr.className),f.tr.className="selectedlistrow",f.tr.rowState==ListPanel.LEAF_NODE&&(this.selectedRows[g]=
!0)):(f.tr.className=f.tr.savedClassName,f.tr.rowState==ListPanel.LEAF_NODE&&this.selectedRows[g]&&delete this.selectedRows[g]);this.treeViewSelectDeselectChildRows(f,c)}};ListPanel.prototype.treeViewBulkSelectDeselectRow=function(b,c){for(var d=this.name+"_"+c+"__",f=1;f<this.grid.length;f++){var g=this.P2.doc.getElementById(d+f+"Select");b.checked!=g.checked&&g.click()}};var ChartPanel=function(){AbstractTable.call(this)};ChartPanel.prototype=new AbstractTable;
ChartPanel.XY_COLUMNS=["xAxisColumn","yAxisColumn"];ChartPanel.chartTypes={bar:ChartPanel.XY_COLUMNS,pie:ChartPanel.XY_COLUMNS};ChartPanel.prototype.setLegend=function(b){this.legend=b};ChartPanel.prototype.getLegend=function(){return this.legend};
ChartPanel.prototype.setData=function(b){if(!this.container){var c=this.P2.win;this.container=c.document.getElementById(this.name);this.legendContainer=c.document.getElementById(this.name+"Legend");if(!this.container){debug("Design Error: No dom element found with name "+this.name+" for chart Panel,"+this.panelaName);return}}c=b.getGrid(this.name);!c&&b.grids&&(c=b.grids[this.name]);this.value=c;if(!c||2>c.length)return this.container.innerHTML="",this.legendContainer&&(this.legendContainer.innerHTML=
""),this.container.parentNode.setAttribute("exil-noData","exil-noData"),debug("No data for chart "+this.name),!1;this.container.parentNode.removeAttribute("exil-noData");b=ChartPanel.chartTypes[this.chartType];if(!b)return this.container.innerHTML=this.chartType+" is not implemented as a chart",this.legendContainer&&(this.legendContainer.innerHTML=""),!1;b=this.getColumnData(c,b);ChartPanelDriver.draw(this,b)};
ChartPanel.prototype.getColumnData=function(b,c){for(var d={},f=b[0],g=f.length,h=0;h<g;h++)d[f[h]]=h;for(var f=[],g=c.length,k=[],h=0;h<g;h++){k[h]=h;var l=this[c[h]];if(l){var m=d[l];m||0===m?k[h]=m:debug(l+" is specified as the column name for "+c[h]+" but this column is not found in the data grid. A default index of "+h+" is assumed")}else debug(c[h]+" not specified for chart "+this.name+" default column index "+h+" is assumed.")}var n=l=null;this.helpTexts=null;if(this.helpTextColumn)if((m=d[this.helpTextColumn])||
0===m){if(l=m,this.helpTexts=[],this.groupHelpTextColumn&&((m=d[this.groupHelpTextColumn])||0===m))n=m}else debug(this.helpTextColumn+" is not found as a column in data grid for chart "+this.name);for(m=1;m<b.length;m++){for(var d=b[m],r=[],h=0;h<g;h++)r.push(d[k[h]]);f.push(r);this.helpTexts&&(n?this.helpTexts.push([d[l],d[n]]):this.helpTexts.push(d[l]))}return f};
var ChartPanelDriver={draw:function(b,c){var d=b.container,f=[];f.push("\x3cdiv\x3e\x3ch1\x3e");f.push(b.chartType);f.push(" CHART \x3c/h1\x3e(You are seeing this data table because no charting driver is available to render charts)\x3c/div\x3e");this.getDataHtml(b,c,f);d.innerHTML=f.join("")},getDataHtml:function(b,c,d){var f=c.length,g=c[0]&&c[0].length;if(g){d.push("\x3ctable\x3e\x3cthead\x3e\x3ctr\x3e");b.helpTexts&&d.push("\x3cth\x3ehelp text\x3c/th\x3e");for(var h=0;h<g;h++)d.push("\x3cth\x3ecol - "),
d.push(h),d.push("\x3c/th\x3e");d.push("\x3c/tr\x3e\x3c/thead\x3e\x3ctbody\x3e");for(g=0;g<f;g++){d.push("\x3ctr\x3e");var k=c[g];b.helpTexts&&(d.push("\x3ctd\x3e"),d.push(b.helpTexts[g]),d.push("\x3c/td\x3e"));for(h=0;h<k.length;h++)d.push("\x3ctd\x3e"),d.push(k[h]),d.push("\x3c/td\x3e");d.push("\x3c/tr\x3e")}d.push("\x3c/tbody\x3e\x3c/table\x3e\x3cbr /\x3e\x3cbr /\x3e")}else d.push("\x3cbr /\x3e\x3cdiv\x3e NO DATA \x3c/div\x3e\x3cbr /\x3e")}},ExilityPage=function(b,c){this.win=b;this.doc=b.document;
this.name=c;this.pageParameters={};this.fields={};this.fieldNames=[];this.tables={};this.actions={};this.idSplitter="___"},PageParameter=function(){},a=ExilityPage.prototype;a.addParameter=function(b){b.P2=this;this.pageParameters[b.name]=b};a.getParameter=function(b){return this.pageParameters[b]};
a.addField=function(b){b.P2=this;this.fields[b.name]=b;b.seqNo=this.fieldNames.length;this.fieldNames.push(b.name);this.firstField||(this.firstFieldName?this.firstFieldName===b.name&&(this.firstField=b):b.isEditable&&(this.firstField=b));b.tableName&&this.tables[b.tableName].addColumn(b);b.initialize&&b.initialize();b.listServiceId&&this.addFiledToListeners(b,!1);b.reportServiceId&&this.addFiledToListeners(b,!0)};a.getField=function(b){return this.fields[b]};
a.getFieldObject=function(b,c){var d=this.fields[b];if(!d)return null;d=d.table?d.table.getObjectId(b,c):b;return this.doc.getElementById(d)};a.addAction=function(b){b.P2=this;this.actions[b.name]=b};a.getAction=function(b){return this.actions[b]};
a.addTable=function(b){b.P2=this;this.tables[b.name]=b;b.pageSize&&!b.localPagination&&(this.pageSizes||(this.pageSizes=[]),this.pageSizes.push([b.name+"PageSize",b.pageSize]));if(b.linkedTableName||b.mergeWithTableName||b.nestedTableName)this.hasLinkedTables=!0};a.getTable=function(b){return this.tables[b]};
a.addFiledToListeners=function(b,c){var d=null,f=null;c?(d=this.reportServices?this.reportServices:this.reportServices={},f=b.reportServiceId):(d=this.listServices?this.listServices:this.listServices={},f=b.listServiceId);var g=f;b.keyValue&&(g+="_"+b.keyValue);var h=d[g];h||(h=[],h.serviceId=f,h.keyValue=b.keyValue,d[g]=h);h.push(b);debug(b.name+" pushed as a listener for "+g)};
a.init=function(){window.setPageTitle&&window.setPageTitle(this.title);if(this.buttonsToEnable)for(var b=0;b<this.buttonsToEnable.length;b++)this.buttonsToEnable[b]=this.doc.getElementById(this.buttonsToEnable[b]);if(this.buttonsToDisable)for(b=0;b<this.buttonsToDisable.length;b++)this.buttonsToDisable[b]=this.doc.getElementById(this.buttonsToDisable[b]);if(this.buttonsToHideForPicker&&"pickerWindow"==this.win.name)for(b=0;b<this.buttonsToHideForPicker.length;b++)this.doc.getElementById(this.buttonsToHideForPicker[b]).style.display=
"none";var b=this.getGridForListeners(this.listServices),c=this.getGridForListeners(this.reportServices),d;for(d in this.tables){var f=this.tables[d];f.init&&f.init()}if(this.hasLinkedTables)for(d in this.tables)f=this.tables[d],(f.linkedTableName||f.mergeWithTableName||f.nestedTableName)&&f.createLinks();d=this.processPageParameters();PM.getInbox(this.win);b&&this.callListService(b,null,null,null,null,null,!0);c&&this.callReportService(c,null);window.passedDc&&(this.refreshPage(window.passedDc),
window.passedDc=null);if(d)for(c=d.length,this.actions[d[c-1]].showPage=!0,b=0;b<c;b++)this.act(this.doc.body,"body",d[b],null,!0);else this.showPage();window.resetInactiveTimer&&window.resetInactiveTimer()};
a.processPageParameters=function(){var b=this.pageParameters;if(!b)return this.onLoadActionNames;var c=null!=this.pageMode,d=queryFieldsToCollection(this.win.location.search),f=0;for(p in b){var g=b[p],h=d[p];h||(h=g.defaultValue);if(h){if(g.dataType)try{var k=dataTypes[g.dataType];k&&(h=k.validate(h))}catch(l){message("Internal error: This page is called with "+p+" \x3d "+h+". This is not a valid value."+l.messageText,"Error","Ok",null,null,null);continue}if("pageheader"==g.name){var m=this.doc.getElementById("pageheader");
m&&(m.innerHTML=g.value)}else this.setFieldValue(g.setTo?g.setTo:p,h,null,null,null,null,null,!0);g.value=h;f++}else c&&g.isPrimaryKey?(this.pageMode="add",c=!1):g.isRequired&&message("Internal error: "+p+" is a required parameter for this page. It is not passed by the caller.","Error","Ok",null,null,null)}return this.minParameters&&f<this.minParameters?(message("This page is to be invoked with "+this.minParameters+" parameters. Only "+f+"parameters are passed. This is a set-up problem. This page may not work properly",
"Error","Ok",null,null,null),null):"modify"==this.pageMode?(this.fieldsToDisableOnModifyMode&&this.ableFields(this.fieldsToDisableOnModifyMode,!1),this.onModifyModeActionNames):this.minParametersToFireOnLoad&&f<this.minParametersToFireOnLoad?null:this.onLoadActionNames};
a.getGridForListeners=function(b){if(!b)return null;var c=[["serviceId","keyValue"]],d;for(d in b){for(var f=b[d],g=[f.serviceId,f.keyValue?f.keyValue:""],h=!1,k=0;k<f.length;k++){var l=f[k];l.obj=this.doc.getElementById(l.name);l.obj?l.noAutoLoad||(h=!0):debug("DESIGN ERROR: "+l.name+" could not get its dom element at the time of regestering for list service")}h&&(debug("pushing a listService request for "+g),c.push(g))}return c};
a.showPage=function(){var b=this.pageHeight,c=this.pageWidth,d=0,f=0,g=null;if("pickerWindow"==this.win.name||this.win.isAPopup){if(g=document.getElementById("loading"))g.style.display="none";this.popupHeight&&(b=this.popupHeight);this.popupWidth&&(c=this.popupWidth);this.popupLeft&&(f=this.popupLeft);this.popupTop&&(d=this.popupTop);if("pickerWindow"==this.win.name)PM.codePickerLeft&&-1!=PM.codePickerLeft&&(f=PM.codePickerLeft),PM.codePickerTop&&-1!=PM.codePickerTop&&(d=PM.codePickerTop),pickerEleStyle.left=
f+"px",pickerEleStyle.top=d+"px",pickerEleStyle.display="";else{var h=this.win.parent&&this.win.parent.document.getElementById(this.win.name+"Div");if(h){h.style.display="";h.style.position="absolute";h.style.zIndex="2";if(exilParms.alignPopupWindow){if(g=document.getElementById(this.win.name),f=this.popupWidth,f||(f=this.pageWidth),f=(parseInt(document.body.offsetWidth)-parseInt(f))/2,f=parseInt(f))h.style.left="0px",g.style.left=f+"px"}else h.style.left=0<f?f+"px":"100px";h.style.top=0<d?d+"px":
"100px"}}}"pickerWindow"==this.win.name?resetWindowSize(this.win,c,b,d,f,!0):resetWindowSize(this.win,c,b,d,f);this.doc.body.style.display="";if(this.firstField&&(b=this.doc.getElementById(this.firstField.name))&&b.focus)try{b.focus(),field.isAssisted&&b.select()}catch(k){}this.fieldsToHideOnLoad&&0!=this.fieldsToHideOnLoad.length&&this.hideOrShowPanels(this.fieldsToHideOnLoad,"none");this.win.checkIframeSize()};
a.act=function(b,c,d,f,g){debug(d+" invoked as an action with obj\x3d"+b+" fieldName\x3d"+c);var h=document.getElementById("warningMsg");h&&(h.style.display="none");b&&b.type&&"true"==b.getAttribute(this.DISABLED_ATTRIBUTE_NAME)||((h=this.actions[d])?h.warnIfFormIsModified&&(!0==exilParms.trackFieldChanges||!1==exilParms.trackFieldChanges&&!0==this.trackFieldChanges)&&this.lastModifiedNode?(PM.actionBeingConfirmed={P2:this,obj:b,fieldName:c,actionName:d,param:f,actionOnLoad:g},PM.message("Do you want to abandon change(s)?",
"Warning","Yes",pageActionActAfterMessageOk,"No",pageActionActAfterMessageNotOk,null,null)):(null!=h.showPanels&&this.hideOrShowPanels(h.showPanels,""),null!=h.hidePanels&&this.hideOrShowPanels(h.hidePanels,"none"),null!=h.disableFields&&this.ableFields(h.disableFields,!1),null!=h.enableFields&&this.ableFields(h.enableFields,!0),h.popupPanel?this.popupAPanel(h.popupPanel):h.popdownPanel&&this.popDown(),b=h.act(b,c,f,g),h.showPage&&!h.serviceId&&this.showPage(),b&&h.resetFormModifiedState&&this.resetLastModifiedNode(),
exilParms.serverActivityCallBackFunctionName&&h.toBeReported&&((b=PM[exilParms.serverActivityCallBackFunctionName])?b():debug("Design error : Project has specified exilParms.serverActivityCallBackFunctionName \x3d "+exilParms.serverActivityCallBackFunctionName+" but no function is defined with that name."))):debug("action "+d+" is not a valid action"))};
var pageActionActAfterMessageOk=function(){var b=PM.actionBeingConfirmed;PM.actionBeingConfirmed=null;if(b){var c=b.P2;c.resetLastModifiedNode();c.act(b.obj,b.fieldName,b.actionName,b.param,b.actionOnLoad)}else debug("Design error : PM.actionBeingConfirmed is not available after message()")},pageActionActAfterMessageNotOk=function(){var b=PM.actionBeingConfirmed&&PM.actionBeingConfirmed.P2;PM.actionBeingConfirmed=null;if(b)try{var c=b.lastModifiedNode;c.disabled||c.focus();b.makePanelVisible(c)}catch(d){}else debug("Design error : PM.actionBeingConfirmed is not available after message()")};
a.hideOrShowPanels=function(b,c){"none"!=c&&(c="");for(var d=0;d<b.length;d++){var f=b[d];if(this.fields[f])this.hideOrShowField(f,c);else{var g=this.doc.getElementById(f);if(g){var h="none"==c?"hide":"show",k=this.doc.getElementById(f+"Tabs");k&&(exilParms.animateHideAndShow?PM.animateHideAndShow(k,h,this):k.style.display=c);var k=this.doc.getElementById(f+"Tab"),l=this.doc.getElementById(f+"TabLeft"),m=this.doc.getElementById(f+"TabRight");if(k)k.style.display=c,l&&(l.style.display=c),m&&(m.style.display=
c),c?(k.clickDisabled||k.getAttribute("clickdisabled"))&&this.getTabToEnable(l,m)&&newtab.onclick.call(newtab):k.onclick.call(k);else if(g.style.display!=c)if(k=this.doc.getElementById(f+"Twister"))this.twist(k,f);else{if(f=this.doc.getElementById(f+"Top"))f.style.display=c;"DIV"==g.tagName&&exilParms.animateHideAndShow?animateHideAndShow(g,h,this):g.style.display=c}}else debug("design error: panelName "+f+" is to be hidden/shown, but it is not a dom element")}}this.win.checkIframeSize()};
a.getTabToEnable=function(b,c){var d=b.previousSibling;d&&(d=d.previousSibling);for(;d;){if(d.id&&"none"!=d.style.display)return newTab;d=d.previousSibling}if(d=c.nextSibling)d=d.nextSibling;for(;d&&"none"==d.style.display;){if(d.id&&"none"!=d.style.display)return newTab;d=d.nextSibling}return null};a.DISABLED_CLASS="disabledinput";a.DISABLED_ATTRIBUTE_NAME="eleDisabled";a.DISABLED_DOM_ATTRIBUTE="disabled";
a.ableFields=function(b,c,d){for(var f=b.length-1;0<=f;f--){var g=b[f],h=this.fields[g],k=this.tables[g];if(!h&&k)c?k.enableAction&&k.enableAction():k.disableAction&&k.disableAction();else{var k=!1,l="",m=this.doc.getElementById(g);m||(h&&h.table?(k=!0,l="__"+(d||h.table.currentRow),m=this.doc.getElementById(g+l)):d&&(m=this.doc.getElementById(g+"__"+d)));if(m){var n=m.tagName&&"FONT"==m.tagName.toUpperCase()||m.type&&"BUTTON"==m.type.toUpperCase(),r=0,q="",t="poniter",s="",v="flase";c?(m.savedClassName&&
m.savedClassName!=this.DISABLED_CLASS&&(q=m.savedClassName),delete m.savedClassName,m.removeAttribute(this.DISABLED_DOM_ATTRIBUTE)):(m.className&&(m.savedClassName=m.className),r=-1,q=this.DISABLED_CLASS,t="",s="none",v="true",m.setAttribute(this.DISABLED_DOM_ATTRIBUTE,this.DISABLED_DOM_ATTRIBUTE));m.tabIndex=r;m.className=q;n&&(m.style.cursor=t,m.setAttribute(this.DISABLED_ATTRIBUTE_NAME,v));if(l=this.doc.getElementById(g+l+"Picker"))l.style.display=s;if(s=this.doc.getElementById(g+"Hr"))for(a in l=
h.getTimeObjects(s),l)if(s=l[a])c?(s.className=s.savedClassName||"",s.removeAttribute(this.DISABLED_DOM_ATTRIBUTE)):(s.savedClassName=s.className,s.className=this.DISABLED_CLASS,s.setAttribute(this.DISABLED_DOM_ATTRIBUTE,this.DISABLED_DOM_ATTRIBUTE));if(s=this.doc.getElementById(g+"To"))s.className=q,c?s.removeAttribute(this.DISABLED_DOM_ATTRIBUTE):s.setAttribute(this.DISABLED_DOM_ATTRIBUTE,this.DISABLED_DOM_ATTRIBUTE);if(s=this.doc.getElementById(g+"Operator"))s.className=q,c?s.removeAttribute(this.DISABLED_DOM_ATTRIBUTE):
s.setAttribute(this.DISABLED_DOM_ATTRIBUTE,this.DISABLED_DOM_ATTRIBUTE);q=m.childNodes;if(q.length)for(s=q.length-1;0<=s;s--)l=q[s],n=l.name,1==l.nodeType&&n&&(0<m.name.search(/Radio/)||0<n.search(/Checkbox/))&&(c?l.removeAttribute(this.DISABLED_DOM_ATTRIBUTE):l.setAttribute(this.DISABLED_DOM_ATTRIBUTE,this.DISABLED_DOM_ATTRIBUTE));if(k&&(h=h.table.rowToClone.getElementsByTagName(m.nodeName),0!=h.length))for(k=h.length-1;0<=k;k--)if(m=h[k],m.id==g){c?m.removeAttribute(this.DISABLED_DOM_ATTRIBUTE):
m.setAttribute(this.DISABLED_DOM_ATTRIBUTE,this.DISABLED_DOM_ATTRIBUTE);break}}else debug(g+" is marked for enable/disable. But it is not defined.")}}};
a.popupAPanel=function(b){var c=this.doc.getElementById(b+"Top")||this.doc.getElementById(b);c?(this.poppedUpPanel?this.poppedUpPanel.style.position="":(this.myCoverStyle||(b=this.doc.createElement("div"),b.style.position="absolute",b.style.zIndex=2,b.style.top="0px",b.style.left="0px",b.style.backgroundColor=exilParms.popupCoverColor,b.style.opacity=exilParms.popupCoverOpacity,this.doc.body.appendChild(b),this.myCoverStyle=b.style),this.myCoverStyle.height=this.doc.body.clientHeight+"px",this.myCoverStyle.width=
this.doc.body.clientWidth+"px",this.myCoverStyle.display="block"),c.style.position="relative",c.style.zIndex=10,this.poppedUpPanel=c):debug("Error: "+b+" is not found as a DOM element. popup option failed ")};a.popDown=function(){this.poppedUpPanel?(this.myCoverStyle&&(this.myCoverStyle.display="none"),this.poppedUpPanel.style.position="",this.poppedUpPanel=null):debug("Nothing to popdown")};
a.addPageSizes=function(b){if(this.pageSizes)for(var c=this.pageSizes.length-1;0<=c;c--){var d=this.pageSizes[c];b.values[d[0]]=d[1]}};
a.fillDcFromQueryFields=function(b,c,d,f,g,h,k){if(!c)return!0;if(!d)return message("Design error: Source not supplied for name \x3d "+c,"Error","Ok",null,null,null),!1;for(h=c.length-1;0<=h;h--){var l=d[h],m=this.fields[l],n=null;if(m){if(g&&m.name!=k){n=m.getValue(f);try{m.validateValue(n)}catch(r){return r.field=m,this.catchError(r),!1}}n=m.getValue(f,!0)}else n=this.win[l];n||(n="");var q=c[h];b.addValue(q,n);m&&(m.isFilterField&&(n=this.fields[l+"Operator"],n=n.getValue(f,!0),b.addValue(q+"Operator",
n),6==n&&(n=this.fields[l+"To"],n=n.getValue(f,!0),b.addValue(q+"To",n))),(l=m.table)&&l.repeatingColumnName&&l.name+"_"+l.repeatingColumnName==m.name&&b.addValue(q,fieldVal))}return!0};
a.fillDcFromForm=function(b,c,d,f){c||(c=this.fields,d=this.tables);for(var g in c)if(c=this.fields[g])(f||c.toBeSentToServer&&!c.tableName)&&c.fillDc(b);else{if(c=this.win[g])b.addGrid(g,c),contine;debug(g+" is neither a field, nor a grid in the window. It will not be submitted.")}for(var h in d)(d=this.tables[h])?d.fillDC&&d.toBeSentToServer&&d.fillDC(b):debug(h+" is not a table. It will not be submitted.")};
a.getFieldValue=function(b,c,d,f){var g=this.fields[b];if(g)return g.getValue(c,d,f);if(this.win.name_value_&&(g=this.win.name_value_[b],"undefined"!=typeof g&&null!=g))return g;g=this.win[b];if("undefined"!=typeof g&&null!=g)return g;debug(b+" is not found any where ");return null};a.hideField=function(b){this.hideOrShowField(b,"none")};a.FIELD_RELATED_SIFFIXES=" Label Picker Operator FieldsTable ToDiv Left Middle Right".split(" ");
a.hideOrShowField=function(b,c){var d=this.fields[b];if(d&&d.table)d.table.hideOrShowField(b,c);else{for(var f=this.FIELD_RELATED_SIFFIXES.length-1;0<=f;f--){var g=this.doc.getElementById(b+this.FIELD_RELATED_SIFFIXES[f]);g&&(g.style.display=c)}d&&(c?d.requiresValidation&&(d.validationStatusOnHide=!0,d.requiresValidation=!1):d.validationStatusOnHide&&(d.requiresValidation=!0))}};
a.setDefaultValue=function(b,c){var d=this.fields[b];d?d.defaultValue=value:debug("field "+b+" is not a feild and hence a default value of "+value+" is not set")};a.setFieldValue=function(b,c,d,f,g,h,k,l){if(b){var m=this.fields[b];if(!m)return debug(b+" is not a field. value is not set"),this.win.name_value_||(this.win.name_value_={}),this.win.name_value_[b]=c,!1;l?m.setValue(c,d,f,m.supressDescOnLoad,h,!1,k):m.setValue(c,d,f,g,h,!1,k)}else debug("Internal error: callto P2.setFieldValue with no name")};
a.setFieldLabel=function(b,c){var d=this.doc.getElementById(b+"Label");d&&(d.innerHTML=c.replace(/&/g,"\x26amp;"),d=this.fields[b])&&(d.label=c)};a.callListService=function(b,c,d,f,g,h,k){var l=new DataCollection;l.addGrid("listServiceIds",b);if(f&&!this.fillDcFromQueryFields(l,f,g,h))return!1;b=new ServiceEntry("listService",l,!1,listServiceReturned,c,d,ServerAction.NONE,null,null,null,k);this.win.serverStub.callService(b)};
a.callReportService=function(b,c,d,f,g,h){var k=new DataCollection;k.addGrid("reportServiceIds",b);if(f&&!this.fillDcFromQueryFields(k,f,g,h))return!1;b=new ServiceEntry("reportService",k,!1,reportServiceReturned,c,d,ServerAction.NONE);this.win.serverStub.callService(b)};
a.setLastModifiedNode=function(b){b||(b={id:"unknown"});if(this.lastModifiedNode)this.lastModifiedNode=b;else{this.lastModifiedNode=b;this.onFormChangeActionName&&this.act(b,b.id,this.onFormChangeActionName);if(this.buttonsToEnable)for(b=0;b<this.buttonsToEnable.length;b++)this.buttonsToEnable[b].disabled=!1;if(this.buttonsToDisable)for(b=0;b<this.buttonsToDisable.length;b++)this.buttonsToDisable[b].disabled=!0;window.tabbedWindows&&tabbedWindows.setModifiedStatus(this.win.name,!0)}};
a.resetLastModifiedNode=function(){this.lastModifiedNode=null;if(this.buttonsToEnable)for(var b=0;b<this.buttonsToEnable.length;b++)this.buttonsToEnable[b].disabled=!0;this.onFormResetActionName&&this.act(null,null,this.onFormResetActionName);if(this.buttonsToDisable)for(b=0;b<this.buttonsToDisable.length;b++)this.buttonsToDisable[b].disabled=!1;window.tabbedWindows&&tabbedWindows.setModifiedStatus(this.win.name,!1)};
a.applyFieldAliases=function(b){for(var c,d=1;d<b.length;d++){var f=b[d],g=this.fields[f[0]];if(g){if(f[1])g.aliasName=f[1];else{g.toBeSentToServer=!1;g.requiresValidation=!1;if(c=this.doc.getElementById(g.name+"Label"))c.style.display="none";if(c=this.doc.getElementById(g.name))c.style.display="none"}f[2]&&(g.label=f[1],c=this.doc.getElementById(g.name+"Label"))&&(c.innerHTML=f[1].replace(/&/g,"\x26amp;"));f[3]&&(g.dataType=f[3])}}};
a.resetFields=function(b){for(var c=b.length,d=0;d<c;d++){var f=this.fields[b[d]];f&&f.toBeSentToServer&&f.value!=f.defaultValue&&f.setValue(f.defaultValue);f.isFilterField&&(f=this.fields[f.name+"Operator"])&&f.value!=f.defaultValue&&f.setValue(f.defaultValue)}};a.resetAllFields=function(){for(var b in this.fields){var c=this.fields[b];c&&c.toBeSentToServer&&c.value!=c.defaultValue&&c.setValue(c.defaultValue)}};
a.resetFieldsToSubmit=function(b,c){var d=this.actions[b];d?c&&c.length?d.resetFieldsToSubmit(c):debug("Fields to be reset shoudl be an array of field names"):debug("action "+b+" is not a valid action")};a.countEnteredFields=function(){var b=this.fields,c=0,d;for(d in b){var f=b[d];f.toBeSentToServer&&f.hasValue()&&c++}return c};
a.fieldFocussed=function(b,c){var d=this.fields[c];if(d&&(!d.focussed||d.focussed(b))){var f=d.table;f&&f.focussed&&f.focussed(b);d.onFocusActionName&&this.act(b,c,d.onFocusActionName,null)}};
a.fieldChanged=function(b,c,d,f,g){if(!d&&!g){var h=document.getElementById("warningMsg");h&&(h.style.display="none")}var k=!1;c.match(/Delete$/)&&(debug("field "+c+" is Delete. Hence ignoring the field change"),k=!0);if(h=this.fields[c]){if(k=b.tagName.toUpperCase(),"SPAN"!=k){"SELECT"==k&&0<=b.selectedIndex&&"inactiveoption"==b.options[b.selectedIndex].className&&(debug("field "+c+" cannot be set with inactiveoption"),c=h.getValue(),h.setValueToObject(b,c));var k=0,l=h.table;if(l&&(k=l.getRowNumber(b),
l.isRowDeleted&&l.isRowDeleted(k)))return c=l.getFieldValue(k,h),h.setValueToObject(b,c),message("You cannot modify a deleted row. Please un-delete the row before modifying it.","Warning","Ok",null,null,null),!1;d||h.donotTrackChanges||(this.setLastModifiedNode(b),this.pageChangedByUser=h.changedByUser=!0);c=h.getValueFromObject(b);if("undefined"==typeof c)debug(h.name+" has undefined value");else{var m=trim(c),n=this.pendingPicker;if(!(0==c.length&&h.descServiceId&&n&&n.obj==b||d))try{if(m=h.validateValue(c),
h.validationFunction){var r=this.win[h.validationFunction];if("function"==typeof r){var q=r(m);if(q&&q.length)throw new ExilityError(q);}}}catch(t){b.isValid=!1;t.field=h;t.obj=b;this.catchError(t);h.saveValue(c,b,k);l&&l.rowChanged&&l.rowChanged(b,h.unqualifiedName,k,d);h.triggerFieldChangedEvents&&h.triggerFieldChangedEvents("",b,k,f,d);return}h.saveValue(m,b,k,d);l&&l.rowChanged&&l.rowChanged(b,h.unqualifiedName,k,d);n&&n.obj==b?(b.isValid=!1,n.validated=!0):(b.isValid=!0,h instanceof TextInputField&&
h.formatter?h.setValueToObject(b,h.format(m)):m!=c&&h.setValueToObject(b,m),h.table&&h.table.hasAggregates&&h.table.aggregateAField(h,b,k),h.triggerFieldChangedEvents&&h.triggerFieldChangedEvents(m,b,k,f,d,g))}}}else k||debug("designError: field "+c+" not found in fields collection")};a.MORE_OPTION_VALUE="_more_";
a.moreOptionClicked=function(b,c){var d=c.target||c.srcElement;if(d.value&&d.value==this.MORE_OPTION_VALUE){var f=(d=this.fields[b])&&this.win[d.showMoreFunctionName];f?f(b):alert("Function "+(d&&d.showMoreFunctoinName)+" is not defined. Show More option on "+d.name+" will not work.")}};
a.keyPressedOnField=function(b,c,d){exilParms.doNotAddRowsOnTabOut||9!=(d.keyCode||d.which)||(b=this.fields[c],(c=b.table)&&c.rowsCanBeAdded&&(c=this.doc.getElementById(c.name+c.currentRow),c&&c.nextSibling||(b="P2.addTableRow(null,'"+b.tableName+"');",this.addRowTimer=this.win.setTimeout(b,0),debug("timer set for "+b))))};
a.filterTable=function(b,c,d){var f=getDocumentXy(b.parentNode),g=document.getElementById(currentActiveWindow.name),h=f.x+g.offsetLeft,f=f.y+g.offsetTop+30;window.filterDiv||(window.filterDiv=document.getElementById("filterArea"));filterDiv.style.display="";filterDiv.style.left=h+"px";filterDiv.style.top=f+"px";c=this.tables[c];document.getElementById("removeFilterButton").disabled=c.filterByColumn?!1:!0;coverPage(coverCalendarStyle,imgCalendarStyle);this.tableBeingFiltered=c;this.filterObj=b;this.filterColumnName=
d};a.goFilter=function(){var b=document.getElementById("filterField").value;this.tableBeingFiltered.filter(this.filterObj,this.filterColumnName,b);this.cancelFilter()};a.cancelFilter=function(){filterDiv.style.display="none";uncoverPage(coverCalendarStyle);this.filterColumnName=this.filterObj=this.tableBeingFiltered=null};a.removeFilter=function(){this.tableBeingFiltered.removeFilter();this.cancelFilter()};
var ENTER=13,BACKSPACE=8,DELETE=46,ZERO=48,ONE=49,TWO=50,THREE=51,FOUR=52,FIVE=53,SIX=54,SEVEN=55,EIGHT=56,NINE=57,LEFT=37,RIGHT=39,TAB=9,ZERONUMPAD=96,ONENUMPAD=97,TWONUMPAD=98,THREENUMPAD=99,FOURNUMPAD=100,FIVENUMPAD=101,SIXNUMPAD=102,SEVENNUMPAD=103,EIGHTNUMPAD=104,NINENUMPAD=105;
a.checkPageValue=function(b,c){switch(c.keyCode){case BACKSPACE:case DELETE:case ZERO:case ONE:case TWO:case THREE:case FOUR:case FIVE:case SIX:case SEVEN:case EIGHT:case NINE:case LEFT:case RIGHT:case ZERONUMPAD:case ONENUMPAD:case TWONUMPAD:case THREENUMPAD:case FOURNUMPAD:case FIVENUMPAD:case SIXNUMPAD:case SEVENNUMPAD:case EIGHTNUMPAD:case NINENUMPAD:return!0;case TAB:case ENTER:var d=parseInt(b.value,10),f=b.id.replace(/CurrentPage$/g,""),g=this.tables[f],f=this.doc.getElementById(f+"TotalPages").innerHTML,
f=parseInt(f,10);if(1>d||d>f)message(d+" is not a valid page number","Error","Ok",null,null,null),b.value="1";g.paginate("random");return!1;default:return c.preventDefault?c.preventDefault():c.returnValue=!1,!1}};a.checkBoxGroupChanged=function(b,c){var d=document.getElementById("warningMsg");d&&(d.style.display="none");(d=this.fields[c])?(this.setLastModifiedNode(b),this.pageChangedByUser=!0,d.changedByUser=!0,d.changed(b)):debug("Design Error: CheckbBoxGroupField : "+c+" is not rendered properly.")};
a.createCodePicker=function(b,c,d){var f,g=null;d=this.fields[d];f=d.name;if(d.table){var h=d.table;h.focussed(b);g=h.getRowNumber(b);(b=b.key)&&(f+=b);f=h.getObjectId(f,g);debug("field id on which code picker is to be triggered is "+f)}b=this.doc.getElementById(f);f=c.clientX;this.left&&(f+=this.left);c=c.clientY;this.top&&(c+=this.top);this.pendingPicker=new PendingPicker(d,b,f,c,g)};
a.startCodePicker=function(){var b=this.pendingPicker;if(b){var c=b.field,d=c.table?c.table.getRowNumber(b.obj):0;if(!b.validated){var f=b.obj,g=trim(c.getValueFromObject(f));if(0<g.length)try{c.validateValue(g)}catch(h){b.obj.isValid=!1;h.obj=f;h.field=c;this.catchError(h);return}f.isValid=!0}b=c.codePickerSrc;c.codePickerLeft&&(PM.codePickerLeft=c.codePickerLeft);c.codePickerTop&&(PM.codePickerTop=c.codePickerTop);if(c.descQueryFields){c=this.makeQueryString(c.descQueryFields,c.descQueryFieldSources,
d,c.validateQueryFields,c.name);if(!1==c)return!1;b+="?"+c}debug("going to open pop-up with src \x3d "+b);coverPage(coverPickerStyle,imgPickerStyle);pickerWin.location.replace(htmlRootPath+b);addToInbox("pickerWindow","currentP2",this)}};
a.codePickerReturned=function(b){debug("Code picker returned with data \x3d "+b);uncoverPage(coverPickerStyle);pickerWin.location.replace("about:blank");pickerEleStyle.display="none";var c=this.pendingPicker;this.pendingPicker=null;PM.codePickerLeft=-1;PM.codePickerTop=-1;if(c.modifiedByUser||b)b?(this.setLastModifiedNode(c.obj),c.field.setDescFields(c.obj,b)):this.fieldChanged(c.obj,c.field.name,!1,!1),c.obj.focus()};
a.createDatePicker=function(b,c,d){var f;c=null;d=this.fields[d];f=d.name;d.table&&(c=d.table.getRowNumber(b),f=d.table.getObjectId(f,c));b=this.doc.getElementById(f);f=getPageXy(b);this.pendingPicker=new PendingPicker(d,b,f.x+Math.floor((b.offsetWidth-190)/2),f.y+b.offsetHeight,c)};
a.startDatePicker=function(){var b=this.pendingPicker;if(b){var c=b.obj,d=b.field;d.table&&(d.table.currentRow=d.table.getRowNumber(c));var c=d.getValueFromObject(c),f=dataTypes[d.dataType];c&&(c=f&&f.includesTime?parseDateTime(c):parseDate(c));var g=null,h=null;exilParms.restrictDatesInCalendar&&(g=d.minDate,h=d.maxDate,f&&(d=f.getMinMax(),g||(g=d.min),h||(h=d.max)));calElement.style.display="";d=b.y;d+185>window.innerHeight&&(d-=200,0>d&&(d=10));f=getPageXy(calElement.offsetParent);calElement.style.top=
d-f.y+"px";calElement.style.left=b.x-f.x+"px";coverPage(coverCalendarStyle,imgCalendarStyle);calWin.interact(this,c,g,h)}};
a.datePickerReturned=function(b){debug("Date picker returned with date\x3d"+b);uncoverPage(coverCalendarStyle);calElement.style.display="none";var c=this.pendingPicker;this.pendingPicker=null;if(c.modifiedByUser||b){if(b){var d=dataTypes[c.field.dataType];d&&d.includesTime?(c.field.setValueToObject(c.obj,formatDateTime(b)),c.field.setValue(formatDateTime(b))):c.obj.value=formatDate(b)}this.fieldChanged(c.obj,c.field.name,!1,!1);c.obj.focus()}};
var PendingPicker=function(b,c,d,f,g){this.obj=c;this.field=b;this.timer=null;this.x=d;this.y=f;this.idx=g};a.tableClicked=function(b,c){var d=this.tables[b];d&&d.clicked&&d.clicked(c)};a.tableHeaderClicked=function(b,c,d){b=b.target;var f=b.getAttribute("data-exilImageType");"filter"==f?this.filterTable(b,c,d):"sort"==f?this.sortTable(b,c,d):this.sortTable(null,c,d)};a.sortTable=function(b,c,d){this.tables[c].sort(b,d)};a.rowSelected=function(b,c){var d=this.tables[b];d&&d.rowSelected(c)};
a.listMouseOver=function(b,c,d){d||(d=window.event);this.tables[c].mouseOver(b,d)};a.listMouseOut=function(b,c,d){d||(d=window.event);this.tables[c].mouseOut(b,d)};a.listClicked=function(b,c,d){this.tables[c].clicked(b,d)};a.listDblClicked=function(b,c,d){this.tables[c].dblClicked(b,d)};
a.addTableRow=function(b,c){this.addRowTimer=null;var d=this.tables[c],f=d.functionBeforeAddRow,g=!0;if(f){try{0<=f.indexOf("(")?eval("result \x3d this.win."+f):g=this.win[f]()}catch(h){}if(!g)return}f=b?b.key:d.getKey();d.cloneFlag=d.dataForNewRowToBeClonedFromRow&&"none"!=d.dataForNewRowToBeClonedFromRow||d.dataForNewRowToBeClonedFromFirstRow||d.rowsCanBeCloned?1:0;d.addRows(1,f,!0);if(f=d.functionAfterAddRow)try{if(0<=f.indexOf("("))eval("this.win."+f);else this.win[f]()}catch(k){debug(f+" could not be run as a function. An exception occurred: "+
k)}};a.cloneTableRow=function(b,c){var d=this.tables[c],f=d.functionBeforeAddRow,g=!0;if(f){try{0<=f.indexOf("(")?eval("result \x3d this.win."+f):g=this.wan[f]()}catch(h){}if(!g)return}this.tables[c].cloneFlag=this.tables[c].dataForNewRowToBeClonedFromFirstRow||this.tables[c].rowsCanBeCloned?1:0;this.tables[c].cloneRow();if(f=d.functionAfterAddRow)try{if(0<=f.indexOf("("))eval("this.win."+f);else this.win[f]()}catch(k){}};a.removeTableRows=function(b,c){this.tables[c].removeTableRows(c)};
a.removeTableRow=function(b,c,d){d=this.tables[d];var f=getRowInTable(c).rowIdx;if(d.grid[f].isDeleted){this.setLastModifiedNode(c);var f=!0,g=d.functionBeforeDeleteRow;if(g){try{0<=g.indexOf("(")?eval("result \x3d this.win."+g):f=this.win[g]()}catch(h){}if(!f)return!1}f=d.deleteRow(c);if(!f)return b&&b.preventDefault&&b.preventDefault(),!1;if(g=d.functionAfterDeleteRow)try{0<=g.indexOf("(")?eval("result \x3d this.win."+g):f=this.win[g]()}catch(k){}return f}return!0};
a.deleteAllTableRows=function(b,c){this.tables[c].deleteAllTableRows(!b.checked)};
a.deleteTableRow=function(b,c,d){this.setLastModifiedNode(c);var f=!0;d=this.tables[d];var g=d.functionBeforeDeleteRow;if(g){try{0<=g.indexOf("(")?eval("result \x3d this.win."+g):f=this.win[g]()}catch(h){}if(!f)return}f=d.deleteRow(c);if(!f)return b&&b.preventDefault&&b.preventDefault(),f;if(g=d.functionAfterDeleteRow){a.appendRow=function(b,c){this.tables[tblName].appendRow(c)};a.insertRow=function(b,c){this.tables[b].insertRow(c)};try{0<=g.indexOf("(")?eval("result \x3d this.win."+g):f=this.win[g]()}catch(k){}}return f};
a.paginate=function(b,c){this.tables[b].paginate(c)};
a.handleGridNav=function(b,c,d){var f=this.fields[c],g=d.keyCode||d.which;if(40==g&&d.altKey){if(f&&f.table){var f=f.table,g=f.nbrRows,h=b.rowIdx;b.name&&b.name.match(/.*Radio$/)&&(h=this.doc.getElementById(b.name.replace(/Radio$/,"")).rowIdx);h<g&&(h++,c=f.getObjectId(c,h),(c=this.doc.getElementById(c))&&(b.name&&b.name.match(/.*Radio$/)?c.getElementsByTagName("input")&&c.getElementsByTagName("input")[0]&&c.getElementsByTagName("input")[0].focus():b.className&&"checkboxgroup"==b.className?c.getElementsByTagName("input")&&
c.getElementsByTagName("input")[0]&&c.getElementsByTagName("input")[0].focus():c.focus()))}else b=b.id,b.match(/Delete__(\d)+$/)&&(b=b.split("__"),c=b.length,f=parseInt(b[c-1]),b[c-1]=++f+"",(c=this.doc.getElementById(b.join("__")))&&c.focus());d&&d.stopPropagation?(d.stopPropagation(),d.preventDefault()):d.returnValue=!1;return!1}if(38==g&&d.altKey)return f&&f.tableName?(f=this.getTable(f.tableName),h=b.rowIdx,b.name&&b.name.match(/.*Radio$/)&&(h=this.doc.getElementById(b.name.replace(/Radio$/,"")).rowIdx),
1<h&&(h--,c=f.getObjectId(c,h),(c=this.doc.getElementById(c))&&(b.name&&b.name.match(/.*Radio$/)?c.getElementsByTagName("input")&&c.getElementsByTagName("input")[0]&&c.getElementsByTagName("input")[0].focus():b.className&&"checkboxgroup"==b.className?c.getElementsByTagName("input")&&c.getElementsByTagName("input")[0]&&c.getElementsByTagName("input")[0].focus():c.focus()))):(b=b.id,b.match(/Delete__(\d)+$/)&&(b=b.split("__"),c=b.length,f=parseInt(b[c-1]),b[c-1]=--f+"",(c=this.doc.getElementById(b.join("__")))&&
c.focus())),d&&d.stopPropagation?(d.stopPropagation(),d.preventDefault()):d.returnValue=!1,!1};a.bulkCheckAction=function(b,c,d){d=this.tables[d];d.bulkCheckAction&&d.bulkCheckAction(b,c)};a.doneWith=function(){try{for(var b in this.tables){var c=this.tables[b];c.doneWith&&c.doneWith()}}catch(d){}};
a.makeQueryString=function(b,c,d,f,g){var h="";if(!b)return"";c||(c=b);for(var k,l="",m=0;m<c.length;m++){var n=this.fields[c[m]];if(n){if(k=n.getValue(d),"true"==f&&(!g||n.name!=g))try{k=n.validateValue(k)}catch(r){return r.field=n,this.catchError(r),!1}}else(k=this.win[c[m]])||(k="");h+=l+b[m]+"\x3d"+escape(k);l="\x26";n&&n.isFilterField&&(n=this.fields[c[m]+"Operator"])&&(k=n.getValue(d),h+=l+b[m]+"Operator\x3d"+escape(k),(n=this.fields[c[m]+"To"])&&6==k&&(k=n.getValue(d),h+=l+b[m]+"To\x3d"+escape(k)))}return h};
a.animationStarted=function(){this.nbrBeingAnimated++};a.animationEnded=function(){this.nbrBeingAnimated--;this.nbrBeingAnimated||this.win.checkIframeSize()};a.appendRows=function(b,c){var d=this.tables[b];if(d){var f=new PM.DataCollection;f.addGrid[b]=c;d.setData(f,!0,!0)}else debug("Table "+b+" not found for this page. Rows will not be appended")};
a.refreshPage=function(b,c){var d;this.fillList(b.grids,!0);this.fillReport(b.grids);for(var f in b.values)d=this.fields[f],this.setFieldValue(f,b.values[f],null,0,d&&d.supressDescOnLoad?!0:!1,!0,c);for(f in b.grids){var g=b.grids[f];g&&g.length&&("fieldAliases"==f?this.applyFieldAliases(g):(d=this.tables[f])?d.doNotSetDataToMe||d.setData(b,null,null,c):(d=this.fields[f])&&d.setGrid&&d.setGrid(g))}for(f in b.lists)(d=this.fields[f])&&d.setList&&(g=b.lists[f])&&d.setList(g);this.win.checkIframeSize()};
a.validate=function(b,c){var d=null;b||c||(d=this.formValidationFunction,b=this.fields,c=this.tables);var f,g=!0;PM.pageValidation=!0;for(var h in b)if((f=this.fields[h])&&f.toBeSentToServer){var k=this.validateOnlyOnUserChange||f.validateOnlyOnUserChange;if(!k||f.changedByUser)try{f.table?f.table.validateColumn(f,k):f.validate(!0)}catch(l){this.error=l;this.handleError();if(exilParms.stopAtFirstError)return PM.pageValidation=!1;g=!1}}if(!c)return g;for(var m in c)try{var n=this.tables[m];n.validate&&
n.toBeSentToServer&&n.validate()}catch(r){if(!r.messageId)return d="unknown",r.href&&(d=r.href.split("/"),d=d[d.length-1]),debug(" script error in "+d+" line no "+r.lineNo+" "+r.source+"\n"+r.message),!1;if(exilParms.stopAtFirstError)return PM.pageValidation=!1;g=!1}if(g&&d)try{g=this.win[d]()}catch(q){debug("user function "+d+" has aborted with an error."+q),g=!1}PM.pageValidation=!1;return g};
a.catchError=function(b){this.pendingPicker&&(this.pendingPicker=null,debug("ticker for a picker silenced"));this.addRowTimer&&(this.win.clearTimeout(this.addRowTimer),this.addRowTimer=null,debug("ticker for a add row silenced"));this.error=b;this.errorOccurred=!0;this.win.setTimeout("P2.errorOccurred \x3d false;",500);this.win.setTimeout("P2.handleError()",0)};a.handleError=function(){this.error?(this.error.render?this.error.render(this.error.obj):alert(this.error),this.error=null):debug("Design Error: reached handleError but P2.error has no erroe message.")};
a.tabClicked=function(b,c,d){var f=b.id,f=f.replace(/Right$/,""),f=f.replace(/Left$/,"");b=this.doc.getElementById(f);if(!b.clickDisabled){d||(d=b.getAttribute("tabcontainername"));debug("Tab action started for panel name "+c+" when user clicked on "+f);var g=d+"ActiveTabName";d+="ActivePanelName";var h=this.doc.getElementById(this.win[g]),k=this.doc.getElementById(this.win[d]);if(k&&h){var l=this.doc.getElementById(c);if(l){h.className="passivetablabel";h.clickDisabled=null;if(h=this.doc.getElementById(this.win[g]+
"Left"))h.className="passivetablabelLeft",h.clickDisabled=null;if(h=this.doc.getElementById(this.win[g]+"Right"))h.className="passivetablabelRight",h.clickDisabled=null;k.style.display="none";b.className="activetablabel";b.clickDisabled=!0;if(b=this.doc.getElementById(f+"Left"))b.className="activetablabelLeft",b.clickDisabled=null;if(b=this.doc.getElementById(f+"Right"))b.className="activetablabelRight",b.clickDisabled=null;l.style.display="";this.win[g]=f;this.win[d]=c;if(this.tabClickFunctionName)this.win[this.tabClickFunctionName](f,
c)}else debug("tab element for tabPanelName "+c+" not found.")}else debug("Current active tab panel for table "+c+" could not be found in variables "+g+" and "+d)}};a.TWISTED="collapsedTwister";a.NOT_TWISTED="expandedTwister";a.TOP_TWISTED="collapsedfieldset";a.TOP_NOT_TWISTED="expandedfieldset";
a.twist=function(b,c){var d=this.doc.getElementById(c+"Top"),f=b&&b.className;if(f==this.TWISTED)b.className=this.NOT_TWISTED,d&&(d.className=this.TOP_NOT_TWISTED);else if(f==this.NOT_TWISTED)b.className=this.TWISTED,d&&(d.className=this.TOP_TWISTED);else{f=this.doc.getElementById(c);if(2==f.childNodes.length&&"DIV"==f.childNodes[1].tagName&&(d=f.childNodes[1],2==d.childNodes.length&&"TABLE"==d.childNodes[0].tagName)){var d=d.childNodes[0],g=this.getTable(d.id);null!=g&&g.grid&&1==g.grid.length&&
null!=this.doc.getElementById(d.id+"NoData")&&(f=this.doc.getElementById(d.id+"NoData"))}var g=this.doc.getElementById(c+"Container"),h=this.doc.getElementById(c+"Tabs"),k=null;b&&(k=b.firstChild)&&!k.src&&(k=k.nextSibling);d=this.doc.getElementById(c+"Top");"none"==f.style.display?(f.style.display="",g&&(g.style.display=""),h&&(h.style.display=""),k&&(k.src=htmlRootPath+"../exilityImages/expanded.gif",k.title="Collapse"),d&&(d.className="expandedfieldset")):(f.style.display="none",g&&(g.style.display=
"none"),h&&(h.style.display="none"),k&&(k.src=htmlRootPath+"../exilityImages/collapsed.gif",k.title="Expand"),d&&(d.className="collapsedfieldset"))}};a.fillList=function(b,c){for(var d in this.listServices){var f=b[d];if(f)for(var g=this.listServices[d],h=0;h<g.length;h++)g[h].fillList(f,null,g.keyValue,c)}};a.fillReport=function(b){for(var c in this.reportServices){var d=b[c];if(d)for(var f=this.reportServices[c],g=0;g<f.length;g++)f[g].fillReport(d,null,f.keyValue)}};
a.goButtonClicked=function(b){var c=this.doc.getElementById(b);if(c){var d=c.selectedIndex;0>=d?(message("Please select an action before clicking on GO button","","Ok",null,null,null),c.focus()):this.act(c,b,c.options[d].value)}else debug("ERROR : Dom element for buttonDropDown with name \x3d "+b+" not found")};
a.getUnqualifiedNames=function(b){for(var c=[],d=0;d<b.length;d++){var f=b[d],g=this.fields[f];g?g.unqualifiedName&&(f=g.unqualifiedName):debug(f+" is not a valid field. getUnqualifiedNames will not work properly");c.push(f)}return c};
var listServiceReturned=function(b,c,d,f){var g=d.win.P2;d=d.dc.grids;if(c)if(g=g.getField(c)){var h=g.listServiceId,k=c=null,l;for(l in d)if(0==l.indexOf(h)){c=d[l];l.length>h.length&&(k=l.substring(h.length+1));break}c?b&&b.listServiceKey&&k!=b.listServiceKey?debug("Info: list service "+h+" returned successfully. But the object is waiting for key value "+b.listServiceKey+" whiel this service was for keyValue "+k):g.fillList(c,b,k,f):debug("Error: list service "+h+"did not come back with a grid name starting with "+
h)}else debug("Design error: list service "+h+" returned successfully for field "+c+" but there is no field with this name.");else g.fillList(d,!0)},reportServiceReturned=function(b,c,d){debug("reportServiceReturned() for object\x3d"+b+" with field name "+c);var f=d.win.P2;d=d.dc.grids;if(c){c=f.getField(c);for(var g in d)if(0<=g.indexOf(c.reportServiceId)){c.fillReport(d[g],b);return}debug("design error: "+c.name+" asked for a list service \x3d "+c.listServiceId+" but the dc did not have a grid starting with that name")}else f.fillReport(d)};
a.getWindow=function(b){b=PM.exilityPageStack.activeWindows[b];return!b||b.closed?null:b};a.makePanelVisible=function(b){for(var c=b.parentNode;;){b=c.tagName.toUpperCase();if("BODY"==b)break;"DIV"==b&&"none"==c.style.display&&((b=this.doc.getElementById(c.id+"Tab"))?this.tabClicked(b,c.id+"TabsDiv"):(b=this.doc.getElementById(c.id+"Twister"))?this.twist(b,c.id):c.style.visible="");c=c.parentNode}return!0};
a.reload=function(b,c){this.reloadActionName?(window.scrollTo(0,0),this.actions[this.reloadActionName].act()):window.scrollTo(b,c)};a.setLocalDateFormat=function(b,c){if(PM.setDateFormat(b,c))return!0;message(b+" is not a valid date format. Specify one of ddmmyy ddmmmyy ddmmyyyy or mmddyy","Warning","Ok",null,null,null);return!1};
var queryFieldsToCollection=function(b){debug("going to make a collection out of qry string \x3d "+b);var c={};if(!b)return c;"?"==b.substr(0,1)&&(b=b.substr(1));b=b.split("\x26");var d,f;for(d=0;d<b.length;d++)f=b[d].split("\x3d"),2!=f.length?debug("invalid pair found in query string : "+b[d]):c[f[0]]=unescape(f[1]);return c},coverPage=function(b,c,d){var f=document.getElementById("loading");f&&(f.style.display="");c&&(c.width=mainBody.scrollWidth+"px",c.height=mainBody.scrollHeight+"px");b&&(b.display=
"");d&&(d.display="")},uncoverPage=function(b,c,d){d&&(d.display="none");if(d=document.getElementById("loading"))d.style.display="none";b&&(b.display="none");c&&(c.display="none")},ObjectToValidate=function(b,c){this.obj=c;this.field=b;this.timer=null};
a.getComboUrl=function(b,c,d){c=this.fields[d];b=exilParms.useLocalData||!this.win.location.host||localServices[c.descServiceId]?exilParms.localData+c.descServiceId.replace(/\./g,"/")+".js":exilParms.comboServiceName;b+="?serviceId\x3d"+c.descServiceId;c=this.makeQueryString(c.descQueryFields,c.descQueryFieldSources,null,c.validateQueryFields,c.name);if(!1==c)return null;c&&(b+="\x26"+c);return b};
a.inputFocusOut=function(b,c){debug(c+" lost focus");exilComboWin&&exilComboWin.inputFocusOut();var d=this.fields[c];d.blurred&&!1==d.blurred(b)||(d.isChanged(b)&&this.fieldChanged(b,c),d.onBlurActionName&&this.act(b,c,d.onBlurActionName,null))};
a.inputKeyUp=function(b,c,d){if(122==d.keyCode){if(b&&((b=b.nextSibling)&&"3"==b.nodeType&&(b=b.nextSibling),b.onmousedown))b.onmousedown()}else{var f=this.fields[c];if(!f)debug("invalid field name supplied to inputKeyUp "+c);else if(f.descServiceId&&exilComboWin){if(f.minCharsToTriggerService){var g=0;b&&b.value&&(g=b.value.trim().length);if(g<f.minCharsToTriggerService)return}exilComboWin.inputKeyUp(b,d,this.win,c)}}};
a.comboCall=function(b,c,d){var f=this.fields[c],g=new DataCollection;if(this.fillDcFromQueryFields(g,f.descQueryFields,f.descQueryFieldSources,null,f.validateQueryFields,d,c)){g.values[f.unqualifiedName]=d;c=f.descQueryFields.length;for(var h=0;h<c;h++)f.descQueryFieldSources[h]==f.name&&(""!=g.values[f.descQueryFields[h]]&&g.values[f.descQueryFields[h]]==d||g.addValue(f.descQueryFields[h],d));b=new ServiceEntry(f.descServiceId,g,!1,comboReturned,b,f.name,ServerAction.NONE,!1,!1,f.fieldToFocusAfterExecution);
b.keyValue=d;this.win.serverStub.callService(b)}};var comboReturned=function(b,c,d){exilComboWin.comboProcess(d.dc.grids[d.serviceId],b,d.keyValue)};a.treeViewExpandCollapseRow=function(b,c,d){this.tables[c].treeViewExpandCollapseRow(b,d)};a.treeViewSelectDeselectRow=function(b,c,d){this.tables[c].treeViewSelectDeselectRow(b,d)};a.bulkDeleteClicked=function(b,c){this.tables[c].bulkDeleteClicked(b)};a.bulkCheckClicked=function(b,c,d){this.tables[c].bulkCheckClicked(b,d)};
a.treeViewBulkSelectDeselectRow=function(b,c,d){this.tables[c].treeViewBulkSelectDeselectRow(b,d)};a.xmlNodeClicked=function(b,c){this.fields[c].changeVisibility(b,null,!1)};a.xmlTreeExpandAll=function(b){this.fields[b].changeVisibility(null,!0,!0)};a.xmlTreeCollapseAll=function(b){this.fields[b].changeVisibility(null,!1,!0)};a.columnClicked=function(b,c,d){};
a.hideOrShowColumns=function(b,c,d){(b=this.tables[b])&&columnName&&d?(b.columnName=c.split(";"),b.displayList=d.split(";"),b.hideOrShowColumns()):debug("hideOrShowColumns called with imporper parameters.")};
a.focusNext=function(b,c){c&&c.blur&&c.blur();var d;if(b.table&&b.table.focusNext){d=b.table.focusNext(b,c);if(null==d)return null;if(d.gotFocussed)return d.ele;d=d.ele.seqNo}else d=b.seqNo;if(!d&&0!==d)return null;for(var f=null,g=null,h=this.fieldNames.length,k=d+1;k!==d;k++)if(k==h){if(this.defaultButtonName){f=this.doc.getElementById(this.defaultButtonName);break}k=-1}else if((b=this.fields[this.fieldNames[k]])&&b.isEditable)if(g=b.name,b.table&&(g=b.table.getObjectId(g)),f=this.doc.getElementById(b.name),
!f)debug("Error:"+g+" has no HTML element. Field is sjipped.");else if(!f.disabled&&!f.readonly)break;if(f){try{f.focus&&f.focus(),f.select&&f.select()}catch(l){debug("focus COULD NOT BE shifted to "+f.id+". Error: "+l+". Will blur from this field at least.")}return f}debug("Unable to find another field after "+b.name+" to shit its focus from "+(c?c.id:"it"))};
a.addListener=function(b,c,d,f){var g=this.nextListenerId;g?this.nextListenerId++:(g=0,this.nextListenerId=1,this.eventListeners={});f=this.win.getEventFunction(g,f);this.eventListeners[g]={idx:g,obj:d,ele:b,name:c,fn:f};b.addEventListener?b.addEventListener(c,f,!1):b.attachEvent("on"+c,f);return g};
a.removeListener=function(b){var c=this.eventListeners&&this.eventListeners[b];c?(c.ele.removeEventListener?c.ele.removeEventListener(c.name,c.fn,!1):c.ele.detachEvent("on"+c.name,c.fn),delete this.eventListeners[b]):debug("design Error: "+b+" is supplied for removing an event listener, but no event listener is available with that idx")};
var Node={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12},hideSourceTree=function(b,c){var d=document.getElementById(b),f=document.getElementById(c);"none"!=d.style.display?(d.style.display="none",d.style.width="0%",f.style.width="99%"):(f.style.width="69%",d.style.display="block",d.style.width="30%")},hideAttributeGrid=
function(b,c){var d=document.getElementById(b),f=document.getElementById(c);"none"!=d.style.display?(d.style.display="none",d.style.width="0%",f.style.width="99%"):(f.style.width="30%",d.style.display="block",d.style.width="69%")},toggleDocStructure=function(b){var c=document.getElementById(b+"Label");b=document.getElementById(b);"none"!=c.style.display?(c.style.display="none",b.style.display="none"):(c.style.display="block",b.style.display="block")},toggleGrid=function(b,c,d){b=document.getElementById(b);
d=b.rows.length;var f=b.rows[0].cells.length,g="";if(!(c>=f)){for(var g="none"!=b.tHead.rows[0].cells[c].style.display?"none":"block",h=c;h<f;h++){var k=b.tHead.rows[0].cells[h];k.style.display=g}for(var l=0;l<d;l++)for(h=c;h<f;h++)k=b.rows[l].cells[h],k.style.display=g}},toggleAttributeGrid=function(b){var c=document.getElementById(b),d=null;""==c.style.marginLeft||0==parseInt(c.style.marginLeft)?(d=c.offsetWidth,c.style.marginLeft="0px"):d=parseInt(c.style.marginLeft);0>d?setTimeout("slideOutGrid('"+
b+"', '0')",0):setTimeout("slideInGrid('"+b+"', '"+d+"')",0)},slideInGrid=function(b,c){var d=document.getElementById(b),f=parseInt(d.style.marginLeft),g=-1*parseInt(c);f>g&&(f-=6,f<g&&(f=g),d.style.marginLeft=f+"px",setTimeout("slideInGrid('"+b+"', '"+c+"')",0))},slideOutGrid=function(b,c){var d=document.getElementById(b),f=parseInt(d.style.marginLeft),g=parseInt(c);f<g&&(f+=6,f>g&&(f=g),d.style.marginLeft=f+"px",setTimeout("slideOutGrid('"+b+"', '"+c+"')",0))},slideInTree=function(b,c){var d=document.getElementById(b),
f=parseInt(d.style.width),g=parseInt(c);f>g&&(f-=6,f<g&&(f=g),d.style.width=f+"px",setTimeout("slideInTree('"+b+"', '"+c+"')",0))},slideOutTree=function(b,c){var d=document.getElementById(b),f=parseInt(d.style.width),g=parseInt(c);f<g&&(f+=6,f>g&&(f=g),d.style.width=f+"px",setTimeout("slideOutTree('"+b+"', '"+c+"')",0))},toggleXMLTree=function(b){var c=document.getElementById(b),d=document.getElementById(b+"DivWrapper"),f=null;""==d.style.width?(f=parseInt(c.style.width),d.style.width=f+2+"px"):f=
parseInt(d.style.width);0<f?setTimeout("slideInTree('"+b+"DivWrapper', '0')",0):setTimeout("slideOutTree('"+b+"DivWrapper', '"+(parseInt(c.style.width)+2)+"')",0)};ExilityPage.prototype.slidePanel=function(b,c,d){this.doc.getElementById(c+"Slider"+b.getAttribute("key"))&&(c+=b.getAttribute("key"));"right"==d?this.toggleSlideLeft(c):"left"==d&&this.toggleSlideRight(c)};
ExilityPage.prototype.toggleSlideLeft=function(b){var c=this.doc.getElementById(b+"Container");c||(c=this.doc.getElementById(b));var d=null;""==c.style.marginLeft||0==parseInt(c.style.marginLeft)?(d=c.offsetWidth,c.style.marginLeft="0px"):d=parseInt(c.style.marginLeft);0>d?this.win.setTimeout("P2.slideOutLeft('"+b+"', '0')",0):this.win.setTimeout("P2.slideInLeft('"+b+"', '"+d+"')",0)};
ExilityPage.prototype.slideInLeft=function(b,c){var d=this.doc.getElementById(b+"Container");d||(d=this.doc.getElementById(b));var f=parseInt(d.style.marginLeft),g=-1*parseInt(c);f>g&&(f-=6,f<=g&&(f=g,d.style.display="none"),d.style.marginLeft=f+"px",this.win.setTimeout("P2.slideInLeft('"+b+"', '"+c+"')",0))};
ExilityPage.prototype.slideOutLeft=function(b,c){var d=this.doc.getElementById(b+"Container");d||(d=this.doc.getElementById(b));var f=parseInt(d.style.marginLeft),g=parseInt(c);f<g&&(f+=6,f>=g&&(f=g),d.style.marginLeft=f+"px",this.win.setTimeout("P2.slideOutLeft('"+b+"', '"+c+"')",0),d.style.display="block")};
ExilityPage.prototype.toggleSlideRight=function(b){var c=this.doc.getElementById(b+"Container"),d=this.doc.getElementById(b+"Wrapper");d?b+="Wrapper":d=this.doc.getElementById(b);var f=null;""==d.style.width?(d.storeWidth=d.offsetWidth+2,f=c?parseInt(c.style.width):parseInt(d.style.width),d.style.width=d.offsetWidth+2+"px"):(f=parseInt(d.style.width),0<f&&(d.storeWidth=f));0<f?this.win.setTimeout("P2.slideInRight('"+b+"', '0')",0):this.win.setTimeout("P2.slideOutRight('"+b+"', '"+parseInt(d.storeWidth)+
"')",0)};ExilityPage.prototype.slideInRight=function(b,c){var d=this.doc.getElementById(b),f=parseInt(d.style.width),g=parseInt(c);f>g&&(f-=6,f<=g&&(f=g,d.style.display="none"),d.style.width=f+"px",this.win.setTimeout("P2.slideInRight('"+b+"', '"+c+"')",0))};
ExilityPage.prototype.slideOutRight=function(b,c){var d=this.doc.getElementById(b),f=parseInt(d.style.width),g=parseInt(c);f<g&&(f+=6,f>=g&&(f=g),d.style.width=f+"px",this.win.setTimeout("P2.slideOutRight('"+b+"', '"+c+"')",0),d.style.display="block")};var AbstractDataType=function(){};AbstractDataType.TEXT="TEXT";AbstractDataType.INTEGRAL="INTEGRAL";AbstractDataType.DECIMAL="DECIMAL";AbstractDataType.BOOLEAN="BOOLEAN";AbstractDataType.DATE="DATE";AbstractDataType.TIMESTAMP="TIMESTAMP";a=AbstractDataType.prototype;
a.validateFromTo=function(b,c,d,f,g){if(b&&c&&b>c){if(d)throw new ExilityError("exilityInvalidToFrom",b,c,f,g);throw new ExilityError("exilityInvalidFromTo",b,c,f,g);}};a.validateSpecifics=function(b,c){return b};a.evaluateShortCuts=function(b){return b};
a.validate=function(b,c){b=String(b);if(this.regex)for(var d=b.split("\n"),f=0;f<d.length;f++){var g=d[f],h=g.match(this.regex);if(!h||h[0]!=g){c||(c=this.messageName);if(exilParms.showSeparateErrorIfRegexFails){c||(c=this.messageName+"Regex");d=""+this.regex+"";d=d.replace(/^\//,"");d=d.replace(/^\^/,"");d=d.replace(/\/$/,"");d=d.replace(/\$$/,"");eval("v \x3d val.replace(/"+d+"/ig,'');");for(g=g.split("").sort().join(",");/\s*([^,]+),\s*\1(?=,|$)/.test(g);)g=g.replace(/\s*([^,]+),\s*\1(?=,|$)/g,
"$1");g="'"+g.replace(/,/g,"','")+"'"}throw new ExilityError(c,g);}}return this.validateSpecifics(b,c)};a.formatIn=function(b){return b};a.formatOut=function(b){return b};a.clientObject=function(b){return b};var TextDataType=function(b,c,d,f,g){AbstractDataType.call(this);this.basicType=AbstractDataType.TEXT;this.name=b;this.messageName=c;this.regex=d;this.minLength=f;this.maxLength=g};TextDataType.prototype=new AbstractDataType;
TextDataType.prototype.validateSpecifics=function(b,c){if(b.length<this.minLength||this.maxLength&&b.length>this.maxLength)throw new ExilityError(c||this.messageName,b,b.length);return b};var negativeIntegerRegex=/^[+-]?\d*$/,positiveIntegerRegex=/^\d*$/,IntegralDataType=function(b,c,d,f,g){AbstractDataType.call(this);this.basicType=AbstractDataType.INTEGRAL;this.name=b;this.messageName=c;this.minValue=d;this.maxValue=f;this.regex=(this.allowNegativeValue=g)?negativeIntegerRegex:positiveIntegerRegex};
IntegralDataType.prototype=new AbstractDataType;IntegralDataType.prototype.validateSpecifics=function(b,c){var d=parseFloat(b);if(null!=this.maxValue&&this.maxValue<d||null!=this.minValue&&this.minValue>d)throw new ExilityError(c||this.messageName,b);return b};
IntegralDataType.prototype.validateFromTo=function(b,c,d,f,g){var h=parseInt(b.replace(/,/g,""),10),k=parseInt(c.replace(/,/g,""),10);if(!isNaN(h)&&!isNaN(k)&&h>k){if(d)throw new ExilityError("exilityInvalidToFrom",b,c,f,g);throw new ExilityError("exilityInvalidFromTo",b,c,f,g);}};IntegralDataType.prototype.clientObject=function(b){b.replace&&(b=b.replace(/,/g,""));return parseInt(b,10)};
var negativeDecimalRegex=/^[+-]?\d*\.?\d{1,}$/,positiveDecimalRegex=/^\d*\.?\d{1,}$/,DecimalDataType=function(b,c,d,f,g,h){AbstractDataType.call(this);this.basicType=AbstractDataType.DECIMAL;this.name=b;this.messageName=c;this.numberOfDecimals=h;this.minValue=d;this.maxValue=f;this.regex=(this.allowNegativeValue=g)?negativeDecimalRegex:positiveDecimalRegex};DecimalDataType.prototype=new AbstractDataType;
DecimalDataType.prototype.validateSpecifics=function(b,c){if(""==b)return b;var d=parseFloat(b);if(null!=this.maxValue&&this.maxValue<d||null!=this.minValue&&this.minValue>d)throw new ExilityError(c||this.messageName,b);return this.formatIn(d)};DecimalDataType.prototype.validateFromTo=function(b,c,d,f,g){var h=parseFloat(b),k=parseFloat(c);if(!isNaN(h)&&!isNaN(k)&&h>k){if(d)throw new ExilityError("exilityInvalidToFrom",b,c,f,g);throw new ExilityError("exilityInvalidFromTo",b,c,f,g);}};
DecimalDataType.prototype.formatIn=function(b){if(0==this.numberOfDecimals)return new String(Math.round(b));var c=Math.pow(10,this.numberOfDecimals);b=Math.round(b*c)/c;var c=0,d;if(0==b)d=new String("0.");else{d=new String(b);b=d.length;var f=d.indexOf(".");0<=f?c=b-f-1:d=d.concat(".")}for(b=this.numberOfDecimals-c;0<b--;)d=d.concat("0");return d};DecimalDataType.prototype.clientObject=function(b){return parseFloat(b.replace(/,/g,""))};
var BooleanDataType=function(b,c,d,f){AbstractDataType.call(this);this.basicType=AbstractDataType.BOOLEAN;this.name=b;this.messageName=c;this.trueValue=d;this.falseValue=f};BooleanDataType.prototype=new AbstractDataType;BooleanDataType.prototype.allTrueValues=["1",1,"y","Y","true","TRUE","True","yes","YES","Yes"];BooleanDataType.prototype.nbrTrues=BooleanDataType.prototype.allTrueValues.length;BooleanDataType.prototype.allFalseValues=["0",0,"n","N","false","FALSE","false","no","No","No"];
BooleanDataType.prototype.nbrFalses=BooleanDataType.prototype.allFalseValues.length;BooleanDataType.prototype.basicType=AbstractDataType.BOOLEAN;BooleanDataType.prototype.validateSpecifics=function(b,c){if(this.trueValue==b||this.falseValue==b)return b;for(var d=0;d<this.nbrTrues;d++)if(this.allTrueValues[d]==b)return b;for(d=0;d<this.nbrFalses;d++)if(this.allFalseValues[d]==b)return b;throw new ExilityError(c||this.messageName,b);};
var DateDataType=function(b,c,d,f,g){AbstractDataType.call(this);this.basicType=AbstractDataType.DATE;this.name=b;this.messageName=c;this.maxDaysBeforeToday=d;this.maxDaysAfterToday=f;this.includesTime=g};DateDataType.prototype=new AbstractDataType;
DateDataType.prototype.validateFromTo=function(b,c,d,f,g){if(this.includesTime)this.validateDateTimeFromTo(b,c,d);else{f=parseDate(b);var h=parseDate(c);if(f&&h&&f>h){if(d)throw new ExilityError("exilityInvalidToFrom",b,c,formLabel,g);throw new ExilityError("exilityInvalidFromTo",b,c,formLabel,g);}}};
DateDataType.prototype.validateDateTimeFromTo=function(b,c,d,f,g){var h,k,l=0,m=0,n=0,r=0,q=0,t=0;h=this.seperateTimeFromDate(b);b=h[0];1<h.length&&(h=h[1].split(":"),l=h[0],n=h[1],q=h[2]);h=this.seperateTimeFromDate(c);c=h[0];1<h.length&&(h=h[1].split(":"),m=h[0],r=h[1],t=h[2]);h=parseDate(b);k=parseDate(c);if(h&&k&&l&&m&&n&&r&&q&&t&&(h>k||h>=k&&l>m||h>=k&&l>=m&&n>r||h>=k&&l>=m&&n>=r&&q>t)){if(d)throw new ExilityError("exilityInvalidToFrom",b,c,f,g);throw new ExilityError("exilityInvalidFromTo",
b,c,f,g);}};DateDataType.prototype.seperateTimeFromDate=function(b){return b.split(" ")};
DateDataType.prototype.validateSpecifics=function(b,c){c||(c=this.messageName);var d=this.includesTime?parseDateTime(b):parseDate(b);if(null==d)throw new ExilityError(c,b);if(null!=this.maxDaysBeforeToday||null!=this.maxDaysAfterToday){var f;if(null!=this.maxDaysBeforeToday&&(f=getToday(-this.maxDaysBeforeToday),d<f))throw new ExilityError(c,b);if(null!=this.maxDaysAfterToday&&(f=getToday(this.maxDaysAfterToday),d>f))throw new ExilityError(c,b);}return this.includesTime?formatDateTime(d):formatDate(d)};
DateDataType.prototype.formatIn=function(b){if(!b)return"";if(dat=evaluateDateShortCuts(b))return formatDate(dat);b=b.split(" ");var c=b[1];c&&(c=c.split(".")[0]);b=b[0];var d=b.split("-");b=[];var f=d[0];exilParms.useShortYear&&(f=f.substr(2,2));b[exilParms.yearAt]=f;(f=d[1])&&(exilParms.useMonthName?f=exilParms.monthNames[parseInt(f,10)-1]:1==f.length&&(f="0"+f));b[exilParms.monthAt]=f;(d=d[2])&&1==d.length&&(d="0"+d);b[exilParms.dateAt]=d;b=b[0]+exilParms.dateSeparator+b[1]+exilParms.dateSeparator+
b[2];this.includesTime&&c&&(b+=" "+c);return b};DateDataType.prototype.textileFormatIn=function(b){b=b.split(" ")[0];b=b.split("/");var c=[],d=b[2];exilParms.useShortYear&&(d=d.substr(2,2));c[exilParms.yearAt]=d;d=b[0];exilParms.useMonthName&&(d=exilParms.monthNames[parseInt(d,10)-1]);c[exilParms.monthAt]=d;c[exilParms.dateAt]=b[1];return c[0]+exilParms.dateSeparator+c[1]+exilParms.dateSeparator+c[2]};
DateDataType.prototype.formatOut=function(b){if(!b)return"";var c=[];b=b.split(" ");var d=b[1];b=b[0].split(exilParms.dateSeparator);var f=b[exilParms.yearAt];2>f.length&&(f="0"+f);exilParms.useShortYear&&(f=f<exilParms.cutOffForShortYear?"20"+f:"19"+f);c[0]=f;f=b[exilParms.monthAt];exilParms.useMonthName&&(f=new String(exilParms.monthIndex[f.toLowerCase()]+1));2>f.length&&(f="0"+f);c[1]=f;b=b[exilParms.dateAt];2>b.length&&(b="0"+b);c[2]=b;b=c[0]+"-"+c[1]+"-"+c[2];this.includesTime&&d&&(b+=" "+d);
return b};DateDataType.prototype.clientObject=function(b){return parseDate(b)};DateDataType.prototype.getMinMax=function(){if(null==this.maxDaysBeforeToday&&null==this.maxDaysAfterToday)return null;var b=null==this.maxDaysBeforeToday?null:getToday(-this.maxDaysBeforeToday),c=null==this.maxDaysAfterToday?null:getToday(this.maxDaysAfterToday);return{min:b,max:c}};
var TimeStampDataType=function(b,c){AbstractDataType.call(this);this.basicType=AbstractDataType.TIMESTAMP;this.name=b;this.messageName=c;this.AbstractDataType()};TimeStampDataType.prototype=new AbstractDataType;TimeStampDataType.prototype.validateSpecifics=function(b,c){return b};
ExilityError=function(b,c,d){this.messageId=b;this.val1=c;this.val2=d;var f=PM.dataTypeMessages[this.messageId];!f&&exilParms.showSeparateErrorIfRegexFails&&(f=PM.dataTypeMessages[this.messageId.replace(/Regex$/,"")]);if(f)for(var g,h,k=arguments.length-1;0<k;k--)this["val"+k]=g=arguments[k],h="@"+k,f="'$'"==g?f.replace(h,"'"+h+"'").replace(h,"$"):f.replace(h,g);else f=b;this.messageText=f};ExilityError.prototype.toString=function(){return this.messageText};
ExilityError.prototype.render=function(b){b||(b=this.obj);this.field&&(null!=b&&this.messageText&&0<this.messageText.length&&"\n"!=this.messageText.charAt(0)&&(this.messageText="\n"+this.messageText),this.messageText="undefined"!=exilParms.donotAddColonToErrorMessage&&exilParms.donotAddColonToErrorMessage?this.field.label+this.messageText:this.field.label+" : "+this.messageText);message(this.messageText,"Warning","Ok",setFocus,null,null,b,null,this.field)};
var setFocus=function(b){if(b){try{showPanelForSure(b)}catch(c){}b.focus&&b.focus();b.select&&b.select()}},additionalHelpWindow=null,showAdditionalHelp=function(b){if(!additionalHelpWindow||additionalHelpWindow.closed())if(additionalHelpWindow=window.open("additionalHelp"),!additionalHelpWindow){alert("Popup Blocker is preventing us from showing you additional help.");return}var c=currentActiveWindow.location.href,d=c.lastIndexOf(".htm");-1==d?alert("We are sorry. We are unable to locate the resource required for providing additional help."):
(c=c.substring(0,d)+".help.htm",b&&(c+="#"+b),additionalHelpWindow.location.href=c)},elementsBeingAnimated={},animateHideAndShow=function(b,c,d){var f=elementsBeingAnimated[b.id];f?f.showOrHide!=c&&f.reverse(c):(f=new Animator(b,c,d),f.showOrHide&&(elementsBeingAnimated[b.id]=f,f.animate()))},Animator=function(b,c,d){if(window.getComputedStyle){var f=b.ownerDocument&&b.ownerDocument.win||window,g=f.getComputedStyle(b,null);this.height=parseInt(g.height);if("none"==g.display){if(c==this.HIDE||!this.height&&
(b.style.display="block",g=f.getComputedStyle(b,null),this.height=parseInt(g.height),this.width=parseInt(g.width),!this.height))return}else if(c==this.SHOW)return;this.showOrHide=c;this.target=this.height;this.ele=b;g=b.style;this.styleHeight=g.height||"";this.styleWidth=g.width||"";this.ox=g.overflow;g.overflow="hidden";this.stepSize=Math.ceil(this.height/this.NBR_STEPS);this.callBackObject=d}else b.style.display=c==this.HIDE?"none":"block"},a=Animator.prototype;a.SHOW="show";a.HIDE="hide";
a.NBR_STEPS=20;a.DELAY=20;a.animate=function(){this.showOrHide==this.SHOW?(this.ele.style.height="1px",this.ele.style.display="block",this.height=0,this.increase()):this.reduce();this.callBackObject&&this.callBackObject.animationStarted&&this.callBackObject.animationStarted()};
a.reduce=function(){var b=this.ele.style;this.height-=this.stepSize;0>=this.height?(b.display="none",this.done()):(b.height=this.height+"px",this.timer=window.setTimeout("elementsBeingAnimated['"+this.ele.id+"'].reduce();",this.DELAY))};a.increase=function(){var b=this.ele.style;this.height+=this.stepSize;this.height>=this.target?this.done():(b.height=this.height+"px",b.display="block",this.timer=window.setTimeout("elementsBeingAnimated['"+this.ele.id+"'].increase();",this.DELAY))};
a.reverse=function(){window.clearTimeout(this.timer);this.showOrHide==this.SHOW?(this.showOrHide=this.HIDE,this.reduce()):(this.showOrHide=this.SHOW,this.increase())};a.done=function(){var b=this.ele.style;b.height=this.styleHeight;b.width=this.styleWidth;b.overflow=this.ox;delete elementsBeingAnimated[this.ele.id];this.callBackObject&&this.callBackObject.animationEnded&&this.callBackObject.animationEnded()};
window.htmlEscape||(window.htmlEscape=window.PM?PM.htmlEscape:function(b){return b.replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;")});var TreeNode=function(){},a=TreeNode.prototype;a.setFromRow=function(b,c){this.id=c[0];this.eleId=b+"."+this.id;this.parentId=c[1]||null;this.name=c[2];this.value=c[3]||null;this.type=c[4]||null;this.treeName=b;this.data=c};
a.setFromObject=function(b,c){this.id=c.id;this.eleId=b+"."+this.id;this.parentId=c.parentId||null;this.name=c.name;this.value=c.value||null;this.type=c.type||null;this.treeName=b;this.data=c};a.disable=function(){this.disabled=!0;var b=document.getElementById(this.eleId);b&&(b.disabled=!0);this.quickEle&&(this.quickEle.style.display="none")};a.enable=function(){this.disabled=!1;var b=document.getElementById(this.eleId);b&&(b.disabled=!1);this.quickEle&&(this.quickEle.style.display="")};
a.render=function(b){this.childNodes&&b.push('\x3cdiv class\x3d"nodeBranch"\x3e');b.push('\x3cdiv id\x3d"');b.push(this.eleId);b.push('" class\x3d"');this.childNodes?this.parentNode?b.push("branch"):b.push("trunk"):b.push("leaf");b.push('NodeText" ');this.disabled&&b.push('disabled\x3d"disabled" ');this.type&&(b.push('treeNodeType\x3d"'),b.push(this.type),b.push('" '));b.push("\x3e");b.push(htmlEscape(this.name));b.push("\x3c/div\x3e");if(this.childNodes){b.push('\x3cdiv style\x3d"display:none; z-index:10" class\x3d"nodeGroup" id\x3d"');
b.push(this.eleId);b.push('Group"\x3e');for(var c=0;c<this.childNodes.length;c++)this.childNodes[c].render(b);b.push("\x3c/div\x3e\x3c/div\x3e")}};a.getUlLi=function(b){b.push('\x3cli\x3e\x3ca href\x3d"#"\x3e');b.push(htmlEscape(this.name));b.push("\x3c/a\x3e");if(this.childNodes){b.push("\n\x3cul\x3e\n");for(var c=0;c<this.childNodes.length;c++)this.childNodes[c].getUlLi(b);b.push("\n\x3c/ul\x3e\n")}b.push("\x3c/li\x3e\n")};
a.addQuickMenu=function(b,c){var d=this.name;c&&(d=c+" \x3e "+d);var f=htmlEscape(d);if(this.childNodes)for(f=0;f<this.childNodes.length;f++)this.childNodes[f].addQuickMenu(b,d);else this.tree.quickNodes.push(this),b.push('\x3cdiv title\x3d"'),b.push(f),b.push('" class\x3d"quickMenuNode" id\x3d"'),b.push(this.eleId),b.push('QuickEle" class\x3d"quickMenuNode" data-nodeId\x3d"'),b.push(this.id),b.push('" '),this.disabled&&b.push('style\x3d"display:none" '),b.push("\x3e"),b.push(f),b.push("\x3c/div\x3e"),
this.quickText=d.toUpperCase()};a.cacheQuickEle=function(){if(this.quickText)this.quickEle=document.getElementById(this.eleId+"QuickEle");else for(var b=0;b<this.childNodes.length;b++)this.childNodes[b].cacheQuickEle()};a.expand=function(b){if(this.childNodes){if(!this.expanded){this.expanded=!0;var c=document.getElementById(this.eleId);c.setAttribute("expanded","expanded");c=document.getElementById(this.eleId+"Group");animateHideAndShow(c,"show")}if(b)for(c=0;c<this.childNodes.length;c++)this.childNodes[c].expand(b)}};
a.collapse=function(b){if(this.childNodes){if(this.expanded){this.expanded=!1;var c=document.getElementById(this.eleId);c.removeAttribute("expanded");c=document.getElementById(this.eleId+"Group");animateHideAndShow(c,"hide")}if(b)for(c=0;c<this.childNodes.length;c++)this.childNodes[c].collapse(b)}};a.alternate=function(){this.expanded?this.collapse(!1):this.expand(!1)};
var Tree=function(b){this.name=b;document.getElementById(b)?alert(b+" is already used as an html element. A menu with this name can not be built"):window[b]?alert(b+" is already used as a variable in your javascript. A menu with this name can not be built"):window[b]=this},a=Tree.prototype;
a.buildFromArray=function(b,c,d){this.roots=[];this.nodes={};for(var f={},g,h,k,l=d?0:1,m=l;m<b.length;m++)g=b[m],k=d?g.id:g[0],this.nodes[k]?(alert("Menu item id :"+k+" is a duplicate. This item will be ignored."),f[m]=!0):(h=new TreeNode,d?h.setFromObject(this.name,g):h.setFromRow(this.name,g),c&&!h.value&&0!=h.value&&h.disable(),this.nodes[k]=h,this.nodes[h.eleId]=h,h.parentId||this.roots.push(h),h.tree=this);for(m=l;m<b.length;m++)f[m]||(g=b[m],k=d?g.id:g[0],h=this.nodes[k],h.parentId&&((c=this.nodes[h.parentId])?
(c.childNodes||(c.childNodes=[]),c.childNodes.push(h),h.parentNode=c):alert(h.name+" has its parent id set to "+h.parentId+". There is no item with this id. Node is ignored.")))};
a.createMenu=function(b,c,d,f){if(this.rootEle=document.getElementById(b))if(d&&(this.onClickFn=d),b=this.roots.length){d=[];"top"==c?(d.push('\x3cdiv class\x3d"topMenu" id\x3d"'),d.push(this.name),d.push('RootEle" onmouseover\x3d"'),d.push(this.name),d.push('.inOut(event, false);" onmouseout\x3d"'),d.push(this.name),d.push('.inOut(event, true);" onclick\x3d"'),d.push(this.name),d.push('.selected(event);"\x3e ')):(d.push('\x3cdiv class\x3d"leftMenu" id\x3d"'),d.push(this.name),d.push('RootEle" onclick\x3d"'),
d.push(this.name),d.push('.clicked(event);"\x3e '));for(c=0;c<b;c++)this.roots[c].render(d);d.push("\x3c/div\x3e");this.rootEle.innerHTML=d.join("");this.visibleGroups={};if(f)for(this.addQuickMenu(f),c=0;c<b;c++)this.roots[c].cacheQuickEle()}else alert(this.name+" does not have any nodes in that. Menu will not be rendered");else alert(b+" is not a dom element. Menu can not be built for "+this.name)};
a.addQuickMenu=function(b){this.quickNodes=[];var c=document.getElementById(b);if(c&&"input"==c.nodeName.toLowerCase()){c.setAttribute("data-menuName",this.name);c.addEventListener?(c.addEventListener("keypress",keyPressedOnQuickMenu,!0),c.addEventListener("blur",quickMenuBlurred,!0)):(c.attachEvent("onkeypress",keyPressedOnQuickMenu),c.attachEvent("blur",quickMenuBlurred));this.quickMenuEle=c;var d=c.nextSibling,f=c.parentNode;f.removeChild(c);var g=document.createElement("div");g.style.display=
"inline-block";g.style.position="relative";g.id=b+"QuickMenuContainer";g.appendChild(c);d?f.insertBefore(g,d):f.appendChild(g);d=document.createElement("div");d.style.position="absolute";d.style.display="none";d.className="quickMenuSuggestions";d.id=b+"QuickMenu";d.setAttribute("data-menuName",this.name);g.appendChild(d);this.quickEle=d;c=document.createElement("div");c.innerHTML="No matching items";c.id=b+"NoMatch";this.noMatchEle=c;d.appendChild(c);this.quickTexts=[];c=document.createElement("div");
c.className="quickMenuNodes";c.addEventListener?c.addEventListener("mousedown",menuItemSelected,!0):c.attachEvent("onmousedown",menuItemSelected);b=[];for(g=0;g<this.roots.length;g++)this.roots[g].addQuickMenu(b);c.innerHTML=b.join("");d.appendChild(c)}else alert(b+" is not an inpiut field on your page. Quick search will not work for menu "+this.name)};a.quickEleBlurred=function(){this.quickMenuEle.value="";this.quickEle.style.display="none"};
var quickMenuBlurred=function(b){b=(b.target||b.srcElement).getAttribute("data-menuName");window[b].quickEleBlurred()},keyPressedOnQuickMenu=function(b){var c=(b.target||b.srcElement).getAttribute("data-menuName");window.setTimeout('window["'+c+'"].quickSearch('+b.keyCode+")",0)},menuItemSelected=function(b){b=b.target||b.srcElement;var c=b.parentNode.parentNode.getAttribute("data-menuName");window[c].quickSelect(b.getAttribute("data-nodeId"))};
a.quickSearch=function(b){if(9==b)this.quickMenuEle.value="";else if(b=trim(this.quickMenuEle.value),b.length){b=b.replace(/[\.]/g,"\\.").replace(/[>]/g,".*");b=b.toUpperCase();for(var c=0,d=0;d<this.quickNodes.length;d++){var f=this.quickNodes[d];f.quickText.match(b)?(c++,f.quickEle.style.display=""):f.quickEle.style.display="none"}this.quickEle.style.display="";this.noMatchEle.style.display=c?"none":""}else this.quickEle.style.display="none"};
a.inOut=function(b,c){var d=b.target||b.srcElement;d.id||3!=d.nodeType||(d=d.parentNode);if(d=this.nodes[d.id])if(c)this.fromNode=d,this.timer=window.setTimeout(this.name+".hideAll()",100);else{this.timer&&(window.clearTimeout(this.timer),this.timer=null);var d=this.getAncestors(d),f=d.length;if(this.fromNode){var g=this.getAncestors(this.fromNode);this.fromNode=null;endHide=g.length;var h=this.getMatch(d,g);h&&(f=h.m1,endHide=h.m2);for(h=0;h<endHide;h++)this.hideGroup(g[h])}for(h=0;h<f;h++)this.showGroup(d[h])}};
a.getMatch=function(b,c){for(var d=0;d<b.length;d++)for(var f=0;f<c.length;f++)if(b[d]===c[f]){var g={};g.m1=d;g.m2=f;return g}};a.getAncestors=function(b){for(var c=[];b;)c.push(b),b=b.parentNode;return c};a.hideAll=function(){this.fromNode=null;for(var b in this.visibleGroups){var c=document.getElementById(b+"Group");c&&animateHideAndShow(c,"hide")}this.visibleGroups={}};
a.showGroup=function(b){var c=document.getElementById(b.eleId+"Group");c&&(animateHideAndShow(c,"show"),this.visibleGroups[b.eleId]=!0)};a.hideGroup=function(b){var c=document.getElementById(b.eleId+"Group");c&&(animateHideAndShow(c,"hide"),delete this.visibleGroups[b.eleId])};a.clicked=function(b){if((b=this.nodes[(b.target||b.srcElement).id])&&!b.disabled)if(b.childNodes)b.alternate();else this.onClickFn(b.value,b.data)};
a.selected=function(b){!(b=this.nodes[(b.target||b.srcElement).id])||b.disabled||b.childNodes||(this.hideAll(),this.onClickFn(b.value,b.data))};a.expandAll=function(){for(var b=0;b<this.roots.length;b++)this.roots[b].expand(!0)};a.collapseAll=function(){for(var b=0;b<this.roots.length;b++)this.roots[b].collapse(!0)};a.showNode=function(b){if(b=this.nodes[b])for(b=b.parentNode;b;)b.expand(!1),b=b.parentNode};
a.quickSelect=function(b){(b=this.nodes[b])&&!b.childNodes&&(this.onClickFn(b.value,b.data),this.quickEle.style.display="none")};a.onClickFn=function(b,c){if(b||0==b)if(0<b.toString().indexOf("("))try{eval(b)}catch(d){alert("invalid script assigned as value to menu item\n"+b)}else{var f=window.currentActiveWindow;f&&(exilityPageStack.resetStack(),exilityPageStack.goTo(f,NavigationAction.REPLACE,b))}};
a.getUlLi=function(){var b=this.roots.length;if(b){var c=[];c.push("\x3cul\x3e");for(var d=0;d<b;d++)this.roots[d].getUlLi(c);c.push("\x3c/ul\x3e");return c.join("")}alert(this.name+" does not have any nodes in that. Menu will not be rendered")};